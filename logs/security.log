2025-06-04 04:44:33,237 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:44:33,237 - INFO - app.core.security - Redis connection parameters: host=127.0.0.1, port=6379, db=0, password=<not set>
2025-06-04 04:44:33,251 - INFO - app.core.security - Connected to Redis successfully.
2025-06-04 04:44:33,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:44:33,303 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:44:33,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:44:33,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 14, 33, 303381), 'iat': datetime.datetime(2025, 6, 4, 11, 44, 33, 303383)}
2025-06-04 04:44:33,304 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTI3MywiaWF0IjoxNzQ5MDM3NDczfQ.N-6WGUFplST2lHTHTSGwtjOljpHEH9-Y_up6YW5PYQo

2025-06-04 04:44:33,436 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:44:33,436 - INFO - app.core.security - Redis connection parameters: host=127.0.0.1, port=6379, db=0, password=<not set>
2025-06-04 04:44:33,439 - INFO - app.core.security - Connected to Redis successfully.
2025-06-04 04:44:33,492 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:44:33,492 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:44:33,492 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:44:33,492 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 14, 33, 492393), 'iat': datetime.datetime(2025, 6, 4, 11, 44, 33, 492398)}
2025-06-04 04:44:33,492 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTI3MywiaWF0IjoxNzQ5MDM3NDczfQ.N-6WGUFplST2lHTHTSGwtjOljpHEH9-Y_up6YW5PYQo

2025-06-04 04:45:31,225 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:45:31,226 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:46:09,923 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:46:09,923 - INFO - app.core.security - Redis connection parameters: host=127.0.0.1, port=6379, db=0, password=<not set>
2025-06-04 04:46:09,925 - INFO - app.core.security - Connected to Redis successfully.
2025-06-04 04:46:09,992 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:46:09,992 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:46:09,992 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:46:09,992 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 16, 9, 992250), 'iat': datetime.datetime(2025, 6, 4, 11, 46, 9, 992254)}
2025-06-04 04:46:09,992 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTM2OSwiaWF0IjoxNzQ5MDM3NTY5fQ.woiH7bjCqBVhImwuXKA9eRKoO1esVD4AmDwBpLBZzWI

2025-06-04 04:46:42,703 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:46:42,704 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:46:42,705 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:46:42,705 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:46:45,215 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:46:45,215 - INFO - app.core.security - Redis connection parameters: host=127.0.0.1, port=6379, db=0, password=<not set>
2025-06-04 04:46:45,218 - INFO - app.core.security - Connected to Redis successfully.
2025-06-04 04:46:45,247 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:46:45,247 - INFO - app.core.security - Redis connection parameters: host=127.0.0.1, port=6379, db=0, password=<not set>
2025-06-04 04:46:45,250 - INFO - app.core.security - Connected to Redis successfully.
2025-06-04 04:46:45,319 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:46:45,319 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:46:45,319 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:46:45,319 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 16, 45, 319537), 'iat': datetime.datetime(2025, 6, 4, 11, 46, 45, 319542)}
2025-06-04 04:46:45,320 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTQwNSwiaWF0IjoxNzQ5MDM3NjA1fQ.7UMW82ZXSgQtarvDruSTfWGFb6jJojhMBJq-h76DZFU

2025-06-04 04:46:45,330 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:46:45,330 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:46:45,330 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:46:45,330 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 16, 45, 330627), 'iat': datetime.datetime(2025, 6, 4, 11, 46, 45, 330629)}
2025-06-04 04:46:45,331 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTQwNSwiaWF0IjoxNzQ5MDM3NjA1fQ.7UMW82ZXSgQtarvDruSTfWGFb6jJojhMBJq-h76DZFU

2025-06-04 04:49:53,058 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:49:53,059 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:49:53,059 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:49:53,059 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:49:55,522 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:49:55,522 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 04:49:55,526 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:49:55,526 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 04:49:55,618 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:49:55,618 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:49:55,618 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:49:55,618 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 19, 55, 618684), 'iat': datetime.datetime(2025, 6, 4, 11, 49, 55, 618688)}
2025-06-04 04:49:55,618 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:49:55,619 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:49:55,619 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:49:55,619 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 19, 55, 618928), 'iat': datetime.datetime(2025, 6, 4, 11, 49, 55, 618932)}
2025-06-04 04:49:55,619 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTU5NSwiaWF0IjoxNzQ5MDM3Nzk1fQ.y1MFoMBs_x9ysaEOw54cMKRc5qLXZ7cZOggFXRsgJqE

2025-06-04 04:49:55,619 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTU5NSwiaWF0IjoxNzQ5MDM3Nzk1fQ.y1MFoMBs_x9ysaEOw54cMKRc5qLXZ7cZOggFXRsgJqE

2025-06-04 04:50:04,541 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:50:04,542 - INFO - app.core.security - Redis connection closed.
2025-06-04 04:50:19,486 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 04:50:19,486 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 04:50:19,567 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 04:50:19,567 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 04:50:19,567 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 04:50:19,567 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 20, 19, 567059), 'iat': datetime.datetime(2025, 6, 4, 11, 50, 19, 567064)}
2025-06-04 04:50:19,568 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTAzOTYxOSwiaWF0IjoxNzQ5MDM3ODE5fQ.gySy4hfkT_Ew0tMct_fO1F0PEIzZgLr0OszOtJ5izQM

2025-06-04 04:52:38,754 - INFO - app.core.security - Closing Redis connection...
2025-06-04 04:52:38,755 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:00:00,018 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:00:00,018 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:00:00,018 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:00:00,018 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 30, 0, 18076), 'iat': datetime.datetime(2025, 6, 4, 12, 0, 0, 18085)}
2025-06-04 05:00:00,019 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MDIwMCwiaWF0IjoxNzQ5MDM4NDAwfQ.DfWmCmr7xDBW3OKFzF_yyZKpECp7knVmtp10a1W2Khs

2025-06-04 05:06:13,243 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:06:13,244 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:06:13,244 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:06:13,244 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 4, 12, 36, 13, 243875), 'iat': datetime.datetime(2025, 6, 4, 12, 6, 13, 243879)}
2025-06-04 05:06:13,244 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkwNDA1NzMsImlhdCI6MTc0OTAzODc3M30.sgKLX90sVDpZ_GxHZP0lPTj_XuiV-Am0n79CfDvOSr8

2025-06-04 05:06:13,244 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2NDM1NzMsImlhdCI6MTc0OTAzODc3M30.Iiq1swaYJ_rHUOOEwQ0lPyLAsOu9KGZy1jsICFD_Ixs, Expiry (seconds): 604800
2025-06-04 05:06:13,279 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 05:06:26,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:06:26,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:06:26,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:12:33,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:12:33,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:12:33,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:12:33,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:12:33,989 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:12:34,012 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:12:34,013 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:14:22,082 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:14:22,084 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:14:25,302 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:14:25,302 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:14:25,403 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:14:25,403 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:14:25,403 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:14:25,403 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 44, 25, 403160), 'iat': datetime.datetime(2025, 6, 4, 12, 14, 25, 403163)}
2025-06-04 05:14:25,403 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTA2NSwiaWF0IjoxNzQ5MDM5MjY1fQ.Yq1P3UVaqqFk0kvxduxACZbzF9vhO8XLLxtC1AMjWg8

2025-06-04 05:14:48,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:14:48,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:14:48,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:14:48,924 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:14:48,924 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:14:48,959 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:14:48,960 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:18:15,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:18:15,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:18:15,958 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:18:15,958 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:18:15,958 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:18:15,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:18:15,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:18:15,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:18:15,959 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:18:15,959 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:18:15,966 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:18:15,966 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:18:15,967 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:19:09,969 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:19:09,970 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:19:12,860 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:19:12,861 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:19:12,954 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:19:12,954 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:19:12,954 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:19:12,954 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 49, 12, 954736), 'iat': datetime.datetime(2025, 6, 4, 12, 19, 12, 954740)}
2025-06-04 05:19:12,955 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTM1MiwiaWF0IjoxNzQ5MDM5NTUyfQ.MYdNE1JmbMiuIvezjXi83KoiM4ueO9HMqNdrFBv5UM8

2025-06-04 05:20:26,107 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:20:26,108 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:20:27,991 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:20:27,991 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:20:28,104 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:20:28,104 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:20:28,104 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:20:28,104 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 50, 28, 104231), 'iat': datetime.datetime(2025, 6, 4, 12, 20, 28, 104234)}
2025-06-04 05:20:28,104 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTQyOCwiaWF0IjoxNzQ5MDM5NjI4fQ.TJNUhThZv2Gko8gDU7XewFwzZ-QAqU7QfxkI7gWFgM4

2025-06-04 05:20:33,067 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:20:33,068 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:20:35,043 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:20:35,043 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:20:35,131 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:20:35,131 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:20:35,131 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:20:35,131 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 50, 35, 131167), 'iat': datetime.datetime(2025, 6, 4, 12, 20, 35, 131169)}
2025-06-04 05:20:35,131 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTQzNSwiaWF0IjoxNzQ5MDM5NjM1fQ.Gct4uGp-ZOezuHTKBQAcHOFPaoGpYjq8Gt22D5OPkt8

2025-06-04 05:21:27,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:21:27,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:21:27,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:21:27,922 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:21:27,922 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:21:27,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:21:27,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:21:27,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:21:27,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:21:27,923 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:21:27,965 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:21:27,965 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:21:27,965 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:21:51,394 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:21:51,395 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:21:53,579 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:21:53,579 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:21:53,690 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:21:53,690 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:21:53,690 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:21:53,690 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 51, 53, 690569), 'iat': datetime.datetime(2025, 6, 4, 12, 21, 53, 690571)}
2025-06-04 05:21:53,691 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTUxMywiaWF0IjoxNzQ5MDM5NzEzfQ.pSKe6y_biPOM88sxIZiYhXSxHaoN0QrmNruayfwXVuQ

2025-06-04 05:22:36,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:22:36,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:22:36,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:22:36,438 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:22:36,438 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:22:36,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:22:36,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:22:36,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:22:36,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:22:36,438 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:22:36,512 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:22:36,513 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:22:36,513 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:27:18,314 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:27:18,315 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:27:20,849 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:27:20,849 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:27:20,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:27:20,995 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:27:20,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:27:20,995 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 57, 20, 995267), 'iat': datetime.datetime(2025, 6, 4, 12, 27, 20, 995270)}
2025-06-04 05:27:20,995 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTg0MCwiaWF0IjoxNzQ5MDQwMDQwfQ.9vgr-B_oqHHgAAKnoLuweiicHrixHYCeHrXT0mEm0H4

2025-06-04 05:27:22,960 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:27:22,962 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:27:24,929 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:27:24,930 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:27:25,027 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:27:25,027 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:27:25,027 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:27:25,027 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 57, 25, 27821), 'iat': datetime.datetime(2025, 6, 4, 12, 27, 25, 27824)}
2025-06-04 05:27:25,028 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTg0NSwiaWF0IjoxNzQ5MDQwMDQ1fQ.a0JBJZnkzvxXmqyhrXSvmTOZDvYLzTgHOxE5pRjyNoo

2025-06-04 05:28:05,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:28:05,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:28:05,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:28:05,816 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:28:05,817 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:28:05,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:28:05,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:28:05,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:28:05,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:28:05,817 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:28:05,854 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:28:05,854 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:28:05,854 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:28:38,631 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:28:38,632 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:28:40,705 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:28:40,705 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:28:40,835 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:28:40,835 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:28:40,835 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:28:40,835 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 12, 58, 40, 835671), 'iat': datetime.datetime(2025, 6, 4, 12, 28, 40, 835673)}
2025-06-04 05:28:40,836 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MTkyMCwiaWF0IjoxNzQ5MDQwMTIwfQ.HTNMTpn52vGCtxYDJVc0GDZYju_jO8gvQERjkgBfs-I

2025-06-04 05:29:28,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:29:28,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:29:28,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:29:28,579 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:29:28,579 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:29:28,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:29:28,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:29:28,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:29:28,580 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:29:28,580 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:29:28,618 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:29:28,619 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:29:28,619 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:30:00,004 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:30:00,004 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:30:00,004 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:30:00,004 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 0, 0, 4481), 'iat': datetime.datetime(2025, 6, 4, 12, 30, 0, 4487)}
2025-06-04 05:30:00,005 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjAwMCwiaWF0IjoxNzQ5MDQwMjAwfQ.hEQZw1bJpaSsmEWostERLjdcPnzmzFTVRrfgxQSat04

2025-06-04 05:32:01,502 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:32:01,503 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:32:03,717 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:32:03,717 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:32:03,797 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:32:03,797 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:32:03,797 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:32:03,797 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 2, 3, 797015), 'iat': datetime.datetime(2025, 6, 4, 12, 32, 3, 797021)}
2025-06-04 05:32:03,797 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjEyMywiaWF0IjoxNzQ5MDQwMzIzfQ.Xf-Ew5IZ5VfiF-zmqgvX4Y2GR3_MEYrZst8VquWUnBw

2025-06-04 05:32:42,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:32:42,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:32:42,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:32:42,020 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:32:42,021 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:32:42,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:32:42,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:32:42,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:32:42,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749040573, 'iat': 1749038773}
2025-06-04 05:32:42,021 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:32:42,066 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:32:42,066 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:32:42,066 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:35:54,331 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:35:54,332 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:35:56,464 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:35:56,464 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:35:56,584 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:35:56,584 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:35:56,584 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:35:56,584 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 5, 56, 584163), 'iat': datetime.datetime(2025, 6, 4, 12, 35, 56, 584165)}
2025-06-04 05:35:56,584 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjM1NiwiaWF0IjoxNzQ5MDQwNTU2fQ._B1hcLHDi-fP6AzLD0c5DO_qpnCLXnWvFe_Eda3XWqU

2025-06-04 05:36:39,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:36:39,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:36:39,489 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-04 05:36:39,495 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-04 05:36:53,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:36:53,537 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:36:53,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:36:53,537 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 4, 13, 6, 53, 537142), 'iat': datetime.datetime(2025, 6, 4, 12, 36, 53, 537150)}
2025-06-04 05:36:53,537 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkwNDI0MTMsImlhdCI6MTc0OTA0MDYxM30.d0eoPTauip4ooAn5wCcNfyaBhknveRFQyJj8eQSdEsM

2025-06-04 05:36:53,538 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2NDU0MTMsImlhdCI6MTc0OTA0MDYxM30.sWPy0aTkOqdj3mNh7P_hD9OS3jIXm8mQ2piIZROLRLE, Expiry (seconds): 604800
2025-06-04 05:36:53,543 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 05:37:07,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:37:07,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:37:07,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:37:07,576 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:37:07,576 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:37:07,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:37:07,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:37:07,577 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:37:07,577 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:37:07,577 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:37:07,586 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:37:07,586 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:37:07,586 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:40:03,245 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:40:03,246 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:40:05,288 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:40:05,288 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:40:05,386 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:40:05,386 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:40:05,386 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:40:05,386 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 10, 5, 386724), 'iat': datetime.datetime(2025, 6, 4, 12, 40, 5, 386727)}
2025-06-04 05:40:05,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjYwNSwiaWF0IjoxNzQ5MDQwODA1fQ.x_GTKw9nr5TZf1xUTZfWHV-Qx8btdmTfpi1YaxUGfyY

2025-06-04 05:41:07,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:41:07,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:41:07,926 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:41:07,926 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:41:07,926 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:41:07,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:41:07,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:41:07,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:41:07,927 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:41:07,927 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:41:07,972 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:41:07,972 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:41:07,972 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:42:10,059 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:42:10,059 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:42:12,156 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:42:12,157 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:42:12,263 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:42:12,263 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:42:12,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:42:12,263 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 12, 12, 263260), 'iat': datetime.datetime(2025, 6, 4, 12, 42, 12, 263267)}
2025-06-04 05:42:12,264 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjczMiwiaWF0IjoxNzQ5MDQwOTMyfQ.klKADCh8VYx8GFuDhApGjksY-yWk5gPO1sj5CwQ4pC4

2025-06-04 05:42:43,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:42:43,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:42:43,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:42:43,395 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:42:43,395 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:42:43,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:42:43,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:42:43,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:42:43,395 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:42:43,395 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:42:43,436 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:42:43,436 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:42:43,436 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:43:58,065 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:43:58,066 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:44:10,062 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:44:10,062 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:44:10,193 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:44:10,193 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:44:10,193 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:44:10,193 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 14, 10, 193029), 'iat': datetime.datetime(2025, 6, 4, 12, 44, 10, 193031)}
2025-06-04 05:44:10,193 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0Mjg1MCwiaWF0IjoxNzQ5MDQxMDUwfQ.i_N6SKHsk0UVAW-iyyKAtAIz_mScvAGieT0nEzW4XLI

2025-06-04 05:45:25,614 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:45:25,615 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:45:27,653 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:45:27,653 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:45:27,742 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:45:27,742 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:45:27,742 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:45:27,743 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 15, 27, 742851), 'iat': datetime.datetime(2025, 6, 4, 12, 45, 27, 742856)}
2025-06-04 05:45:27,743 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MjkyNywiaWF0IjoxNzQ5MDQxMTI3fQ.PLGom6E7qeNoKzX-zL6_4D_iQuWreWtPUnIJbepfvDc

2025-06-04 05:45:50,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:45:50,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:45:50,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:45:50,480 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:45:50,480 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:45:50,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:45:50,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:45:50,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:45:50,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:45:50,481 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:45:50,547 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:45:50,547 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:45:50,547 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:47:27,145 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:47:27,147 - INFO - app.core.security - Redis connection closed.
2025-06-04 05:49:29,282 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 05:49:29,283 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 05:49:29,413 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 05:49:29,413 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 05:49:29,414 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 05:49:29,414 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 19, 29, 413866), 'iat': datetime.datetime(2025, 6, 4, 12, 49, 29, 413870)}
2025-06-04 05:49:29,414 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MzE2OSwiaWF0IjoxNzQ5MDQxMzY5fQ.2Jl3dNWuhFH4AlTk_9htE5BM0Ei_n1Tbf5WKbQBBma0

2025-06-04 05:49:31,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:49:31,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:49:31,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:31,188 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:31,188 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:49:31,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:49:31,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:49:31,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:31,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:31,188 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:49:31,252 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:49:31,252 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:49:31,252 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:49:44,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:49:44,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:49:44,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:44,159 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:44,159 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 05:49:44,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 05:49:44,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 05:49:44,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:44,159 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 05:49:44,160 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 05:49:44,168 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 05:49:44,169 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:49:44,169 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 05:52:03,240 - INFO - app.core.security - Closing Redis connection...
2025-06-04 05:52:03,240 - INFO - app.core.security - Redis connection closed.
2025-06-04 06:02:00,645 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 06:02:00,646 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 06:02:00,731 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 06:02:00,731 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 06:02:00,731 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 06:02:00,731 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 32, 0, 731760), 'iat': datetime.datetime(2025, 6, 4, 13, 2, 0, 731763)}
2025-06-04 06:02:00,732 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0MzkyMCwiaWF0IjoxNzQ5MDQyMTIwfQ.o-W374S8QsfEsjfXbRbN8kWAGmdnxmtX-gDC3CMqX_E

2025-06-04 06:04:32,579 - INFO - app.core.security - Closing Redis connection...
2025-06-04 06:04:32,580 - INFO - app.core.security - Redis connection closed.
2025-06-04 06:05:03,802 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 06:05:03,803 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 06:05:03,928 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 06:05:03,928 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 06:05:03,928 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 06:05:03,928 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 35, 3, 928822), 'iat': datetime.datetime(2025, 6, 4, 13, 5, 3, 928826)}
2025-06-04 06:05:03,929 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0NDEwMywiaWF0IjoxNzQ5MDQyMzAzfQ.99BpNHb9BIWR0T_ngM7mfnWHU0abZMlhYZM6B2gLtqw

2025-06-04 06:05:16,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:05:16,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:05:16,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 06:05:16,606 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 06:05:16,606 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 06:05:16,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:05:16,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:05:16,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 06:05:16,606 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749042413, 'iat': 1749040613}
2025-06-04 06:05:16,606 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 06:05:16,637 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 06:05:16,638 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:05:16,638 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:06:35,869 - INFO - app.core.security - Closing Redis connection...
2025-06-04 06:06:35,870 - INFO - app.core.security - Redis connection closed.
2025-06-04 06:06:38,411 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 06:06:38,411 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 06:06:38,489 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 06:06:38,489 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 06:06:38,489 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 06:06:38,489 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 36, 38, 489720), 'iat': datetime.datetime(2025, 6, 4, 13, 6, 38, 489727)}
2025-06-04 06:06:38,490 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0NDE5OCwiaWF0IjoxNzQ5MDQyMzk4fQ.1e8f2DddHNe7wRlr2G1cogFiwEEA7UC3beVjjjZmAgs

2025-06-04 06:07:26,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:07:26,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:07:26,716 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-04 06:07:26,719 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-04 06:07:31,632 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 06:07:31,632 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 06:07:31,632 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 06:07:31,632 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 4, 13, 37, 31, 631950), 'iat': datetime.datetime(2025, 6, 4, 13, 7, 31, 631962)}
2025-06-04 06:07:31,632 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkwNDQyNTEsImlhdCI6MTc0OTA0MjQ1MX0.xJAn2UdelN7aIhAj8BYczrAF7ss0RtaJaF_CM6aCRQs

2025-06-04 06:07:31,633 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2NDcyNTEsImlhdCI6MTc0OTA0MjQ1MX0.PUKG76ZdK76RRD7UIC1tiZ5XE5BMMu_Ew99-c3fDGLg, Expiry (seconds): 604800
2025-06-04 06:07:31,666 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 06:08:27,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:08:27,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:08:27,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:08:27,914 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:08:27,914 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 06:08:27,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:08:27,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:08:27,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:08:27,915 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:08:27,915 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 06:08:27,921 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 06:08:27,922 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:08:27,922 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:10:09,636 - INFO - app.core.security - Closing Redis connection...
2025-06-04 06:10:09,637 - INFO - app.core.security - Redis connection closed.
2025-06-04 06:10:12,789 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 06:10:12,789 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 06:10:12,877 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 06:10:12,878 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 06:10:12,878 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 06:10:12,878 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 4, 13, 40, 12, 877912), 'iat': datetime.datetime(2025, 6, 4, 13, 10, 12, 877916)}
2025-06-04 06:10:12,878 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTA0NDQxMiwiaWF0IjoxNzQ5MDQyNjEyfQ.3tsQJwpjTCYPBNLlhOFD-npkAyARzenKQ3_Fu6b-TPQ

2025-06-04 06:10:22,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:10:22,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:10:22,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:10:22,592 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:10:22,592 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 06:10:22,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:10:22,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:10:22,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:10:22,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:10:22,592 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 06:10:22,634 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 06:10:22,635 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:10:22,635 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:21:25,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:21:25,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:21:25,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:21:25,416 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:21:25,416 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 06:21:25,417 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 06:21:25,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 06:21:25,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:21:25,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749044251, 'iat': 1749042451}
2025-06-04 06:21:25,417 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 06:21:25,432 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 06:21:25,432 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 06:21:25,433 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:39:46,880 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 21:39:46,880 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 21:39:46,984 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 21:39:46,984 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 21:39:46,984 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 21:39:46,984 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 9, 46, 984219), 'iat': datetime.datetime(2025, 6, 5, 4, 39, 46, 984222)}
2025-06-04 21:39:46,986 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMDE4NiwiaWF0IjoxNzQ5MDk4Mzg2fQ.lcnk3vVm4ymtKw-KyhjRPqE62PpWdfBLX7uHUlbPpNE

2025-06-04 21:42:06,393 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 21:42:06,394 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 21:42:06,394 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 21:42:06,394 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 5, 12, 6, 393872), 'iat': datetime.datetime(2025, 6, 5, 4, 42, 6, 393876)}
2025-06-04 21:42:06,394 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDAzMjYsImlhdCI6MTc0OTA5ODUyNn0.W1HDiZG0w2LcoBy7eq74OCz11uq6q54VMz_oQ8r--T0

2025-06-04 21:42:06,394 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MDMzMjYsImlhdCI6MTc0OTA5ODUyNn0.fHDlL5h0N1R7JuwmFGhtwB3bPleqHcjoEt8EXOBHq6E, Expiry (seconds): 604800
2025-06-04 21:42:06,395 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 21:44:56,542 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:44:56,542 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:44:56,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:44:56,543 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:44:56,543 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 21:44:56,548 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 21:44:56,548 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:45:35,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:45:35,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:45:35,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:45:35,356 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:45:35,356 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 21:45:35,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:45:35,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:45:35,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:45:35,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:45:35,357 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 21:45:35,361 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 21:45:35,361 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:45:35,361 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:50:31,937 - INFO - app.core.security - Closing Redis connection...
2025-06-04 21:50:31,938 - INFO - app.core.security - Redis connection closed.
2025-06-04 21:50:35,488 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 21:50:35,488 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 21:50:35,598 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 21:50:35,599 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 21:50:35,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 21:50:35,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 20, 35, 598907), 'iat': datetime.datetime(2025, 6, 5, 4, 50, 35, 598913)}
2025-06-04 21:50:35,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMDgzNSwiaWF0IjoxNzQ5MDk5MDM1fQ.qLKs3eOXoCSSBzgoEzovzXIN-tpuxqLwWceCCK2cyI8

2025-06-04 21:52:54,501 - INFO - app.core.security - Closing Redis connection...
2025-06-04 21:52:54,502 - INFO - app.core.security - Redis connection closed.
2025-06-04 21:52:56,542 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 21:52:56,542 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 21:52:56,622 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 21:52:56,622 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 21:52:56,622 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 21:52:56,622 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 22, 56, 622673), 'iat': datetime.datetime(2025, 6, 5, 4, 52, 56, 622676)}
2025-06-04 21:52:56,623 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMDk3NiwiaWF0IjoxNzQ5MDk5MTc2fQ.g7Nj-v7iqeQAHhVmKcnM94WejqvSfwU6hOe0kpRVdzQ

2025-06-04 21:53:00,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:53:00,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:53:00,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:53:00,588 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:53:00,588 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 21:53:00,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:53:00,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:53:00,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:53:00,589 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:53:00,589 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 21:53:00,644 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 21:53:00,645 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:53:00,645 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:55:10,294 - INFO - app.core.security - Closing Redis connection...
2025-06-04 21:55:10,295 - INFO - app.core.security - Redis connection closed.
2025-06-04 21:55:12,089 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 21:55:12,089 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 21:55:12,174 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 21:55:12,174 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 21:55:12,174 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 21:55:12,174 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 25, 12, 174570), 'iat': datetime.datetime(2025, 6, 5, 4, 55, 12, 174572)}
2025-06-04 21:55:12,174 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMTExMiwiaWF0IjoxNzQ5MDk5MzEyfQ.JWEXbw9hTiarJ2MPnE-mK28EdUg5F_MDGkfVTAneSsA

2025-06-04 21:55:36,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:55:36,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:55:36,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:55:36,007 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:55:36,007 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 21:55:36,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 21:55:36,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 21:55:36,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:55:36,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749100326, 'iat': 1749098526}
2025-06-04 21:55:36,007 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 21:55:36,032 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 21:55:36,032 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 21:55:36,032 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 22:00:00,010 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:00:00,010 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:00:00,010 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:00:00,011 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 30, 0, 10734), 'iat': datetime.datetime(2025, 6, 5, 5, 0, 0, 10739)}
2025-06-04 22:00:00,011 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMTQwMCwiaWF0IjoxNzQ5MDk5NjAwfQ.bWYn-rk7DKDgnI0noR7z28Y_6rUOa-s3EWxDEMHaYEo

2025-06-04 22:00:44,940 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:00:44,941 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:00:46,758 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:00:46,758 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:00:46,847 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:00:46,847 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:00:46,847 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:00:46,847 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 5, 30, 46, 847003), 'iat': datetime.datetime(2025, 6, 5, 5, 0, 46, 847005)}
2025-06-04 22:00:46,847 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMTQ0NiwiaWF0IjoxNzQ5MDk5NjQ2fQ.ptJK5a9aBYT4VGoPoSeUFbFkigjRR5AC8P9W4C3Fnqs

2025-06-04 22:30:00,016 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:30:00,017 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:30:00,017 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:30:00,018 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 0, 0, 16749), 'iat': datetime.datetime(2025, 6, 5, 5, 30, 0, 16764)}
2025-06-04 22:30:00,018 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMzIwMCwiaWF0IjoxNzQ5MTAxNDAwfQ.lIVmHHJE3sYQYemt85WpIS4V1IbmnjUn5Endz8K4cIs

2025-06-04 22:32:33,414 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:32:33,415 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:32:36,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:32:36,213 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:32:36,312 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:32:36,312 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:32:36,312 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:32:36,312 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 2, 36, 312317), 'iat': datetime.datetime(2025, 6, 5, 5, 32, 36, 312320)}
2025-06-04 22:32:36,312 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMzM1NiwiaWF0IjoxNzQ5MTAxNTU2fQ.5QZXdmIYzJ8sY7JE7lhR_FwaB_NrjDvQXvecwYFvkLY

2025-06-04 22:33:07,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 22:33:07,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 22:33:07,765 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-04 22:33:07,768 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-04 22:34:01,320 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:34:01,320 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:34:01,320 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:34:01,320 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 6, 4, 1, 319947), 'iat': datetime.datetime(2025, 6, 5, 5, 34, 1, 319953)}
2025-06-04 22:34:01,320 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDM0NDEsImlhdCI6MTc0OTEwMTY0MX0.7PuEuC4PFrjrQpjCdtPp_sga2qUbkxk8ED6z6XIvP6k

2025-06-04 22:34:01,321 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MDY0NDEsImlhdCI6MTc0OTEwMTY0MX0.7F1gNHnnb7ZomPHINBx1ikjNJaE7AHHEAyjuMm8V3_M, Expiry (seconds): 604800
2025-06-04 22:34:01,323 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 22:35:04,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 22:35:04,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 22:35:04,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:35:04,904 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:35:04,904 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 22:35:04,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 22:35:04,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 22:35:04,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:35:04,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:35:04,905 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 22:35:04,917 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 22:35:04,917 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 22:35:04,918 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 22:37:12,145 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:37:12,146 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:37:14,149 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:37:14,149 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:37:14,246 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:37:14,246 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:37:14,246 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:37:14,246 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 7, 14, 246026), 'iat': datetime.datetime(2025, 6, 5, 5, 37, 14, 246029)}
2025-06-04 22:37:14,246 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwMzYzNCwiaWF0IjoxNzQ5MTAxODM0fQ.ZnjSe9m3t1jR7lkQAL9WNSbG8BZDJHECFJ0W4hjnpe0

2025-06-04 22:37:42,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 22:37:42,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 22:37:42,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:37:42,158 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:37:42,158 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 22:37:42,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 22:37:42,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 22:37:42,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:37:42,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 22:37:42,158 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 22:37:42,185 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 22:37:42,185 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 22:37:42,185 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 22:39:44,205 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:39:44,205 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:46:53,736 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:46:53,736 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:46:53,855 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:46:53,855 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:46:53,855 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:46:53,855 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 16, 53, 855108), 'iat': datetime.datetime(2025, 6, 5, 5, 46, 53, 855112)}
2025-06-04 22:46:53,855 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNDIxMywiaWF0IjoxNzQ5MTAyNDEzfQ.WWCYkY3Q2J4T1HFOkHba8gIevDUYE3ajWMpJdm6kGik

2025-06-04 22:47:29,815 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:47:29,816 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:47:31,633 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:47:31,634 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:47:31,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:47:31,713 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:47:31,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:47:31,713 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 17, 31, 713811), 'iat': datetime.datetime(2025, 6, 5, 5, 47, 31, 713815)}
2025-06-04 22:47:31,714 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNDI1MSwiaWF0IjoxNzQ5MTAyNDUxfQ.Dc8mxMOCZX_GrUuE3r-MBBKz0OTDvIcGcehEY-QvMqE

2025-06-04 22:59:04,068 - INFO - app.core.security - Closing Redis connection...
2025-06-04 22:59:04,069 - INFO - app.core.security - Redis connection closed.
2025-06-04 22:59:06,180 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 22:59:06,181 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 22:59:06,272 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 22:59:06,273 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 22:59:06,273 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 22:59:06,273 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 29, 6, 272943), 'iat': datetime.datetime(2025, 6, 5, 5, 59, 6, 272946)}
2025-06-04 22:59:06,273 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNDk0NiwiaWF0IjoxNzQ5MTAzMTQ2fQ.bIb-RhWLMv-xBqXjp9isDdlmtDCMVzP4bNJ__bX-JI4

2025-06-04 23:00:00,012 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:00:00,013 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:00:00,013 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:00:00,013 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 30, 0, 12684), 'iat': datetime.datetime(2025, 6, 5, 6, 0, 0, 12693)}
2025-06-04 23:00:00,013 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTAwMCwiaWF0IjoxNzQ5MTAzMjAwfQ.P3zzaCxH0If-YyoCHRi9Jp8h-eqf5NdBzwWdDBCnnmw

2025-06-04 23:00:34,085 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:00:34,086 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:00:35,966 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:00:35,967 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:00:36,079 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:00:36,079 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:00:36,079 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:00:36,080 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 30, 36, 79808), 'iat': datetime.datetime(2025, 6, 5, 6, 0, 36, 79811)}
2025-06-04 23:00:36,080 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTAzNiwiaWF0IjoxNzQ5MTAzMjM2fQ.MX4EVIDsf5aQ0Vn8AiBpWQMSQlVX0pyEP9OHiJiZ8zk

2025-06-04 23:00:39,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:00:39,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:00:39,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 23:00:39,890 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 23:00:39,891 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:00:39,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:00:39,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:00:39,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 23:00:39,891 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749103441, 'iat': 1749101641}
2025-06-04 23:00:39,892 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:00:39,999 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:00:40,000 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:00:40,000 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:06:21,929 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:06:21,930 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:06:24,200 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:06:24,200 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:06:24,286 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:06:24,286 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:06:24,286 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:06:24,286 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 36, 24, 286119), 'iat': datetime.datetime(2025, 6, 5, 6, 6, 24, 286122)}
2025-06-04 23:06:24,286 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTM4NCwiaWF0IjoxNzQ5MTAzNTg0fQ.nHI1RkFf5uVLYo2R3Xd0-H5z9rq2AKJUFF0enDI7MzE

2025-06-04 23:07:40,103 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:07:40,103 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:07:41,944 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:07:41,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:07:42,053 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:07:42,053 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:07:42,053 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:07:42,053 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 37, 42, 53361), 'iat': datetime.datetime(2025, 6, 5, 6, 7, 42, 53364)}
2025-06-04 23:07:42,053 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTQ2MiwiaWF0IjoxNzQ5MTAzNjYyfQ.jFVIxtlLm4RUOD6Y2hhFfpRxoJo1Ucf0tG06vCYd5f4

2025-06-04 23:08:42,365 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:08:42,366 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:08:44,243 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:08:44,243 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:08:44,311 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:08:44,311 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:08:44,311 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:08:44,311 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 38, 44, 311177), 'iat': datetime.datetime(2025, 6, 5, 6, 8, 44, 311180)}
2025-06-04 23:08:44,311 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTUyNCwiaWF0IjoxNzQ5MTAzNzI0fQ.ZcfiNVKKjUkHdZBjRpm3gC2L5hDvPL4yKls6i2pSBuY

2025-06-04 23:10:07,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:10:07,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:10:07,279 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-04 23:10:07,280 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-04 23:10:11,293 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:10:11,293 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:10:11,294 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:10:11,294 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 6, 40, 11, 293508), 'iat': datetime.datetime(2025, 6, 5, 6, 10, 11, 293520)}
2025-06-04 23:10:11,294 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDU2MTEsImlhdCI6MTc0OTEwMzgxMX0.lp-G2KcV8t2WmK-ztKwviyxfu3OJlzR63RvH1cgTs4A

2025-06-04 23:10:11,294 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MDg2MTEsImlhdCI6MTc0OTEwMzgxMX0.0m8xd5Mh70hIj5fkKsInsagw7Xzyb78JhxLWRJRNYQk, Expiry (seconds): 604800
2025-06-04 23:10:11,296 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 23:10:35,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:10:35,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:10:35,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:10:35,767 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:10:35,767 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:10:35,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:10:35,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:10:35,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:10:35,767 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:10:35,767 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:10:35,774 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:10:35,775 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:10:35,775 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:11:16,736 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:11:16,737 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:11:19,083 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:11:19,084 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:11:19,204 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:11:19,204 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:11:19,204 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:11:19,204 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 41, 19, 204671), 'iat': datetime.datetime(2025, 6, 5, 6, 11, 19, 204675)}
2025-06-04 23:11:19,205 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTY3OSwiaWF0IjoxNzQ5MTAzODc5fQ.A35ylha0J-Y9eJ9nyEY_RZs7YXyDXtCyhdQr5NM37tM

2025-06-04 23:11:25,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:11:25,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:11:25,476 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:11:25,476 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:11:25,476 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:11:25,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:11:25,477 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:11:25,477 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:11:25,477 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:11:25,477 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:11:25,546 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:11:25,546 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:11:25,546 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:14:37,750 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:14:37,751 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:14:39,849 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:14:39,850 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:14:39,943 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:14:39,943 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:14:39,943 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:14:39,943 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 44, 39, 943696), 'iat': datetime.datetime(2025, 6, 5, 6, 14, 39, 943699)}
2025-06-04 23:14:39,944 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTg3OSwiaWF0IjoxNzQ5MTA0MDc5fQ.yAgg1iTD0NP0E7mp88kv2yDzOyivL8wVGSDg3-WVaZg

2025-06-04 23:14:42,251 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:14:42,252 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:14:44,185 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:14:44,185 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:14:44,290 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:14:44,290 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:14:44,290 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:14:44,290 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 44, 44, 290344), 'iat': datetime.datetime(2025, 6, 5, 6, 14, 44, 290346)}
2025-06-04 23:14:44,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNTg4NCwiaWF0IjoxNzQ5MTA0MDg0fQ.yyv971jCpcjqbQFkWT61dlnX2ANyW0ew6c5hH1zQOsI

2025-06-04 23:15:10,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:15:10,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:15:10,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:15:10,574 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:15:10,574 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:15:10,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:15:10,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:15:10,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:15:10,574 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:15:10,574 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:15:10,656 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:15:10,657 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:15:10,657 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:16:37,863 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:16:37,863 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:16:39,938 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:16:39,938 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:16:40,033 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:16:40,033 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:16:40,033 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:16:40,033 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 46, 40, 33449), 'iat': datetime.datetime(2025, 6, 5, 6, 16, 40, 33451)}
2025-06-04 23:16:40,033 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjAwMCwiaWF0IjoxNzQ5MTA0MjAwfQ.dh3Wig7h65iBJErCLWbBdrvJ2fsdHtXkeJVGyI6SdCw

2025-06-04 23:16:45,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:16:45,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:16:45,183 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:16:45,183 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:16:45,183 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:16:45,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:16:45,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:16:45,184 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:16:45,185 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:16:45,185 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:16:45,305 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:16:45,305 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:16:45,306 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:20:36,344 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:20:36,345 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:25:01,429 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:25:01,429 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:25:01,525 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:25:01,525 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:25:01,525 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:25:01,525 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 55, 1, 525125), 'iat': datetime.datetime(2025, 6, 5, 6, 25, 1, 525127)}
2025-06-04 23:25:01,525 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjUwMSwiaWF0IjoxNzQ5MTA0NzAxfQ.R_Sch3PfywrMmPt6_u1ZLagSsuzzPoFUmDLBm8mS864

2025-06-04 23:25:13,946 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:25:13,947 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:25:15,768 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:25:15,768 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:25:15,835 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:25:15,835 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:25:15,835 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:25:15,835 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 55, 15, 835157), 'iat': datetime.datetime(2025, 6, 5, 6, 25, 15, 835162)}
2025-06-04 23:25:15,835 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjUxNSwiaWF0IjoxNzQ5MTA0NzE1fQ.OTeZhqNRMuYY2BcULy2V0GxebIb1wXqektm4-_-cnsc

2025-06-04 23:25:20,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:25:20,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:25:20,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:25:20,862 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:25:20,863 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:25:20,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:25:20,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:25:20,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:25:20,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:25:20,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:25:20,942 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:25:20,942 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:25:20,942 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:26:04,516 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:26:04,517 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:26:06,691 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:26:06,691 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:26:06,803 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:26:06,803 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:26:06,803 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:26:06,803 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 56, 6, 803587), 'iat': datetime.datetime(2025, 6, 5, 6, 26, 6, 803592)}
2025-06-04 23:26:06,804 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjU2NiwiaWF0IjoxNzQ5MTA0NzY2fQ.jYlsZMZn0R5QWqgAQk03A_VmNENzZpPYRphyttf5M_0

2025-06-04 23:27:20,733 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:27:20,733 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:27:22,757 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:27:22,757 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:27:22,839 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:27:22,839 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:27:22,839 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:27:22,839 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 57, 22, 839119), 'iat': datetime.datetime(2025, 6, 5, 6, 27, 22, 839124)}
2025-06-04 23:27:22,839 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjY0MiwiaWF0IjoxNzQ5MTA0ODQyfQ.zcA6_Fw7pvaOk-lZsvuWSmRRuzk8VPSIzBnoh2OySXQ

2025-06-04 23:28:08,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:28:08,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:28:08,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:28:08,818 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:28:08,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:28:08,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:28:08,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:28:08,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:28:08,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:28:08,819 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:28:08,858 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:28:08,858 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:28:08,859 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:28:25,126 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:28:25,127 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:28:27,249 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:28:27,249 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:28:27,312 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:28:27,312 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:28:27,312 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:28:27,313 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 6, 58, 27, 312833), 'iat': datetime.datetime(2025, 6, 5, 6, 28, 27, 312836)}
2025-06-04 23:28:27,313 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjcwNywiaWF0IjoxNzQ5MTA0OTA3fQ.cnxIZPjX3CsFa6A9t43aMwxPGVSVWFU0LHO7vlO6-xo

2025-06-04 23:30:00,007 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:30:00,008 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:30:00,008 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:30:00,008 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 0, 0, 7857), 'iat': datetime.datetime(2025, 6, 5, 6, 30, 0, 7864)}
2025-06-04 23:30:00,009 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjgwMCwiaWF0IjoxNzQ5MTA1MDAwfQ.1-9F-yvYtsUgihSuPperEhPoKkV7NIRxqUR9QMdXF3o

2025-06-04 23:32:34,034 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:32:34,035 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:32:35,851 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:32:35,851 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:32:35,952 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:32:35,953 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:32:35,953 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:32:35,953 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 2, 35, 952946), 'iat': datetime.datetime(2025, 6, 5, 6, 32, 35, 952948)}
2025-06-04 23:32:35,953 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjk1NSwiaWF0IjoxNzQ5MTA1MTU1fQ.w7iL3eR9wXbDqPN6wIbh28mIt5AUgy-WHJxtS2hMtfY

2025-06-04 23:32:47,881 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:32:47,881 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:32:49,789 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:32:49,790 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:32:49,879 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:32:49,879 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:32:49,879 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:32:49,879 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 2, 49, 879173), 'iat': datetime.datetime(2025, 6, 5, 6, 32, 49, 879176)}
2025-06-04 23:32:49,879 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjk2OSwiaWF0IjoxNzQ5MTA1MTY5fQ.iPsz2LnOXAVrnP4m63OQFYbclUvoZInXkmMj-RUlg_o

2025-06-04 23:33:01,703 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:33:01,704 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:33:03,565 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:33:03,565 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:33:03,673 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:33:03,673 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:33:03,673 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:33:03,673 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 3, 3, 673331), 'iat': datetime.datetime(2025, 6, 5, 6, 33, 3, 673334)}
2025-06-04 23:33:03,673 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNjk4MywiaWF0IjoxNzQ5MTA1MTgzfQ.KW7VLHMgy34VYBAYPhsrFet17gp4XFG43YZDmtSTqd4

2025-06-04 23:33:15,485 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:33:15,486 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:34:15,498 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:34:15,498 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:34:15,625 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:34:15,625 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:34:15,625 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:34:15,625 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 4, 15, 625618), 'iat': datetime.datetime(2025, 6, 5, 6, 34, 15, 625620)}
2025-06-04 23:34:15,626 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzA1NSwiaWF0IjoxNzQ5MTA1MjU1fQ.hJkIKLUqP2ziBt6Az5P3cr9oBzWn4ei1uhj8EmZpMJE

2025-06-04 23:34:26,692 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:34:26,693 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:34:28,935 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:34:28,935 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:34:29,055 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:34:29,055 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:34:29,055 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:34:29,055 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 4, 29, 55731), 'iat': datetime.datetime(2025, 6, 5, 6, 34, 29, 55734)}
2025-06-04 23:34:29,056 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzA2OSwiaWF0IjoxNzQ5MTA1MjY5fQ.pzWacwEBe0vbDgdh6l6cKGArrmjGxuL2A-_t5EC9vMs

2025-06-04 23:35:49,589 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:35:49,589 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:35:51,673 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:35:51,673 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:35:51,741 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:35:51,741 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:35:51,741 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:35:51,741 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 5, 51, 741285), 'iat': datetime.datetime(2025, 6, 5, 6, 35, 51, 741289)}
2025-06-04 23:35:51,741 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzE1MSwiaWF0IjoxNzQ5MTA1MzUxfQ.wnkoeY67Nth1s_REiNahxR5LOBaGLJUyI8h_XdWQff8

2025-06-04 23:36:41,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:36:41,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:36:41,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:36:41,226 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:36:41,226 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:36:41,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:36:41,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:36:41,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:36:41,227 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749105611, 'iat': 1749103811}
2025-06-04 23:36:41,227 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:36:41,277 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:36:41,278 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:36:41,278 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:43:11,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:43:11,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:43:11,114 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-04 23:43:11,119 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-04 23:43:15,067 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:43:15,067 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:43:15,073 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:43:15,074 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 7, 13, 15, 67105), 'iat': datetime.datetime(2025, 6, 5, 6, 43, 15, 67115)}
2025-06-04 23:43:15,075 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDc1OTUsImlhdCI6MTc0OTEwNTc5NX0.SBn2gPw2GPScpVpbhMCtmszac93Vq-DiOBliWE_G79s

2025-06-04 23:43:15,076 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MTA1OTUsImlhdCI6MTc0OTEwNTc5NX0.4Ji0i1BVrBpIKmIVUPs2XbTZFTOZhEyr7Og7OBd19dE, Expiry (seconds): 604800
2025-06-04 23:43:15,079 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-04 23:43:29,883 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:43:29,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:43:29,884 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:43:29,884 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:43:29,884 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:43:29,884 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:43:29,884 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:43:29,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:43:29,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:43:29,885 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:43:29,891 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:43:29,891 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:43:29,891 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:44:09,758 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:44:09,762 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:44:12,500 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:44:12,500 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:44:12,592 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:44:12,592 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:44:12,592 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:44:12,592 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 14, 12, 592236), 'iat': datetime.datetime(2025, 6, 5, 6, 44, 12, 592241)}
2025-06-04 23:44:12,592 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzY1MiwiaWF0IjoxNzQ5MTA1ODUyfQ.OnAOk30eyUfuFw8UX_Tc7RBbcYG4rWn0Py892w9QyIY

2025-06-04 23:44:21,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:44:21,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:44:21,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:44:21,700 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:44:21,700 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:44:21,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:44:21,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:44:21,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:44:21,700 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:44:21,700 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:44:21,733 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:44:21,733 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:44:21,733 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:46:32,592 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:46:32,593 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:46:34,731 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:46:34,731 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:46:34,845 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:46:34,845 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:46:34,845 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:46:34,845 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 16, 34, 845011), 'iat': datetime.datetime(2025, 6, 5, 6, 46, 34, 845015)}
2025-06-04 23:46:34,845 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzc5NCwiaWF0IjoxNzQ5MTA1OTk0fQ.l34D4yoEkXz8DJHpW6jv3MWa8072iFssEHP2-Ct1TpA

2025-06-04 23:46:39,554 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:46:39,554 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:46:41,693 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:46:41,693 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:46:41,759 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:46:41,759 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:46:41,759 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:46:41,759 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 16, 41, 759421), 'iat': datetime.datetime(2025, 6, 5, 6, 46, 41, 759426)}
2025-06-04 23:46:41,760 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwNzgwMSwiaWF0IjoxNzQ5MTA2MDAxfQ.Nl36xAL0VdZGtCCRtaCG3nfSiqhbPO62_XNtmMF2NsY

2025-06-04 23:47:09,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:47:09,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:47:09,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:47:09,530 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:47:09,531 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:47:09,531 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:47:09,531 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:47:09,531 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:47:09,531 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:47:09,531 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:47:09,566 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:47:09,566 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:47:09,566 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:51:54,526 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:51:54,527 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:51:56,641 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:51:56,641 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:51:56,749 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:51:56,749 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:51:56,749 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:51:56,749 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 21, 56, 749392), 'iat': datetime.datetime(2025, 6, 5, 6, 51, 56, 749394)}
2025-06-04 23:51:56,749 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwODExNiwiaWF0IjoxNzQ5MTA2MzE2fQ.vkFuQlKhTITX7VV0NmOpKtj-zm1ekZsrGDJTEWzdqRw

2025-06-04 23:52:32,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:52:32,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:52:32,991 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:52:32,992 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:52:32,992 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:52:32,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:52:32,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:52:32,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:52:32,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:52:32,992 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:52:33,024 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:52:33,024 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:52:33,024 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:54:07,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:54:07,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:54:07,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:54:07,878 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:54:07,878 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:54:07,878 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:54:07,878 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:54:07,879 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:54:07,879 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:54:07,879 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:54:07,886 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:54:07,886 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:54:07,887 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:54:54,376 - INFO - app.core.security - Closing Redis connection...
2025-06-04 23:54:54,377 - INFO - app.core.security - Redis connection closed.
2025-06-04 23:54:56,480 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-04 23:54:56,481 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-04 23:54:56,559 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-04 23:54:56,559 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-04 23:54:56,559 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-04 23:54:56,559 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 24, 56, 559361), 'iat': datetime.datetime(2025, 6, 5, 6, 54, 56, 559365)}
2025-06-04 23:54:56,559 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwODI5NiwiaWF0IjoxNzQ5MTA2NDk2fQ.4bmTTexsQuTbTnqgUXaAjwatBFKAML69PfIPC_9IK6M

2025-06-04 23:56:05,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:56:05,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:56:05,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:56:05,196 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:56:05,197 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-04 23:56:05,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-04 23:56:05,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-04 23:56:05,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:56:05,197 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749107595, 'iat': 1749105795}
2025-06-04 23:56:05,197 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-04 23:56:05,274 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-04 23:56:05,274 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-04 23:56:05,275 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:00:00,015 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:00:00,015 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:00:00,015 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:00:00,015 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 30, 0, 15192), 'iat': datetime.datetime(2025, 6, 5, 7, 0, 0, 15199)}
2025-06-05 00:00:00,015 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwODYwMCwiaWF0IjoxNzQ5MTA2ODAwfQ.UGgEb1YhMZfQ2WiyEDIH1a6_RE5ev7RDPdeVumBHkxo

2025-06-05 00:01:13,043 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:01:13,043 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:01:13,043 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:01:13,043 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 7, 31, 13, 43141), 'iat': datetime.datetime(2025, 6, 5, 7, 1, 13, 43149)}
2025-06-05 00:01:13,044 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDg2NzMsImlhdCI6MTc0OTEwNjg3M30.PvHgXFbSSMiFwx69rrPkYfQBtvtYJ_m1rMU4j1ytQsw

2025-06-05 00:01:13,044 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MTE2NzMsImlhdCI6MTc0OTEwNjg3M30.QhiC5Tnu8ncOxVMTzZAcPk49K2hgLpluiDEQw4PVDjo, Expiry (seconds): 604800
2025-06-05 00:01:13,045 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 00:01:30,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:01:30,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:01:30,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:01:30,902 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:01:30,902 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:01:30,912 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:01:30,912 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:01:50,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:01:50,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:01:50,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:01:50,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:01:50,084 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:01:50,093 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:01:50,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:02:02,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:02:02,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:02:02,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:02:02,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:02:02,837 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:02:02,845 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:02:02,846 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:02:51,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:02:51,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:02:51,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:02:51,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749108673, 'iat': 1749106873}
2025-06-05 00:02:51,065 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:02:51,071 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:02:51,072 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:08:28,155 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:08:28,156 - INFO - app.core.security - Redis connection closed.
2025-06-05 00:08:33,675 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:08:33,675 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:08:34,341 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:08:34,342 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:08:34,342 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:08:34,342 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 38, 34, 341840), 'iat': datetime.datetime(2025, 6, 5, 7, 8, 34, 341848)}
2025-06-05 00:08:34,343 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwOTExNCwiaWF0IjoxNzQ5MTA3MzE0fQ.dtvR6M6FJho8o55xQAi1w4RXmz0Cvt49Rrtbm30YIs8

2025-06-05 00:08:37,312 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:08:37,325 - INFO - app.core.security - Redis connection closed.
2025-06-05 00:08:41,883 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:08:41,883 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:08:42,170 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:08:42,170 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:08:42,170 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:08:42,170 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 38, 42, 170419), 'iat': datetime.datetime(2025, 6, 5, 7, 8, 42, 170422)}
2025-06-05 00:08:42,170 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwOTEyMiwiaWF0IjoxNzQ5MTA3MzIyfQ.sBlkXuu3j1ERMrnQgT0VJogU9JXzHmGr7e4RoF0pcYo

2025-06-05 00:20:59,233 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:20:59,233 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:20:59,518 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:20:59,518 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:20:59,518 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:20:59,518 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 50, 59, 518041), 'iat': datetime.datetime(2025, 6, 5, 7, 20, 59, 518048)}
2025-06-05 00:20:59,519 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEwOTg1OSwiaWF0IjoxNzQ5MTA4MDU5fQ.uBZQiWVCinZb7F8B1xvqjGTqKL8N7wCYta4mmWPMRfw

2025-06-05 00:22:40,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:22:40,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:22:40,103 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-05 00:22:40,109 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-05 00:22:44,905 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:22:44,906 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:22:44,906 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:22:44,906 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 7, 52, 44, 905661), 'iat': datetime.datetime(2025, 6, 5, 7, 22, 44, 905680)}
2025-06-05 00:22:44,907 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMDk5NjQsImlhdCI6MTc0OTEwODE2NH0.ptg_CTg2qvr8ZREmgYuHRNTYyAz-eH6StlCzwnW--1Q

2025-06-05 00:22:44,908 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MTI5NjQsImlhdCI6MTc0OTEwODE2NH0.Y_D_eJkB8WPZqHDt1GWQaA5R8B-RKgZBnuzGSKBj0CM, Expiry (seconds): 604800
2025-06-05 00:22:44,911 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 00:22:57,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:22:57,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:22:57,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:22:57,967 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:22:57,967 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-05 00:22:57,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:22:57,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:22:57,968 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:22:57,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:22:57,969 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:22:57,986 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:22:57,987 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:22:57,987 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:24:36,646 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:24:36,647 - INFO - app.core.security - Redis connection closed.
2025-06-05 00:24:40,385 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:24:40,386 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:24:40,534 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:24:40,534 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:24:40,534 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:24:40,534 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 54, 40, 534070), 'iat': datetime.datetime(2025, 6, 5, 7, 24, 40, 534075)}
2025-06-05 00:24:40,534 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExMDA4MCwiaWF0IjoxNzQ5MTA4MjgwfQ.kJfCAmI-zdHnekt0aSZ3Jn8Z18__2i4utVGtUDOjN-g

2025-06-05 00:28:41,221 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:28:41,222 - INFO - app.core.security - Redis connection closed.
2025-06-05 00:28:45,117 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:28:45,117 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:28:45,300 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:28:45,300 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:28:45,300 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:28:45,300 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 7, 58, 45, 300500), 'iat': datetime.datetime(2025, 6, 5, 7, 28, 45, 300509)}
2025-06-05 00:28:45,301 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExMDMyNSwiaWF0IjoxNzQ5MTA4NTI1fQ.UoLoA3xsG5dtL1HXZvCW7CCN7F3MbsnhlM0C_2otzKw

2025-06-05 00:30:00,004 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:30:00,004 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:30:00,004 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:30:00,005 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 8, 0, 0, 4597), 'iat': datetime.datetime(2025, 6, 5, 7, 30, 0, 4603)}
2025-06-05 00:30:00,005 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExMDQwMCwiaWF0IjoxNzQ5MTA4NjAwfQ.CMEYvzAMwRp29HwWWNh6-Ebhe-uVV6WJXHpc5GPTFAY

2025-06-05 00:30:20,343 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:30:20,343 - INFO - app.core.security - Redis connection closed.
2025-06-05 00:30:23,629 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 00:30:23,630 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 00:30:23,824 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:30:23,824 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:30:23,824 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:30:23,824 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 8, 0, 23, 824259), 'iat': datetime.datetime(2025, 6, 5, 7, 30, 23, 824271)}
2025-06-05 00:30:23,825 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExMDQyMywiaWF0IjoxNzQ5MTA4NjIzfQ.ex6XaXCWQ1gsI-LjtIzsZ1lPv2s-jdm1_u4dYM-T3pM

2025-06-05 00:30:39,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:30:39,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:30:39,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:30:39,365 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:30:39,365 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-05 00:30:39,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:30:39,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:30:39,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:30:39,366 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749109964, 'iat': 1749108164}
2025-06-05 00:30:39,366 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:30:39,445 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:30:39,446 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:30:39,446 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:30:59,003 - DEBUG - app.core.security - Attempting to decode token:  the update should accept ever...
2025-06-05 00:30:59,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:30:59,003 - WARNING - app.core.security - JWTError in decode_token: JWTError - Not enough segments
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments
2025-06-05 00:30:59,011 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 180, in _load
    signing_input, crypto_segment = jwt.rsplit(b".", 1)
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: not enough values to unpack (expected 2, got 1)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 74, in verify
    header, payload, signing_input, signature = _load(token)
                                                ~~~~~^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 184, in _load
    raise JWSError("Not enough segments")
jose.exceptions.JWSError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Not enough segments

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-05 00:31:08,703 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 00:31:08,704 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 00:31:08,704 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 00:31:08,704 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 8, 1, 8, 703629), 'iat': datetime.datetime(2025, 6, 5, 7, 31, 8, 703640)}
2025-06-05 00:31:08,704 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMTA0NjgsImlhdCI6MTc0OTEwODY2OH0.xDstzFX3viqt6rgifs0I1wxtYJPLfQqWH-tCJeRjzlI

2025-06-05 00:31:08,705 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MTM0NjgsImlhdCI6MTc0OTEwODY2OH0.0A5RKusEH9dEIOsawZP5YCGCeUwg7pWbFu793-FXJJs, Expiry (seconds): 604800
2025-06-05 00:31:08,706 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 00:31:25,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:31:25,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:31:25,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:25,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:25,887 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:31:25,893 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:31:25,894 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:31:55,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:31:55,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:31:55,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:55,256 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:55,256 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-05 00:31:55,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 00:31:55,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 00:31:55,256 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:55,256 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749110468, 'iat': 1749108668}
2025-06-05 00:31:55,256 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 00:31:55,264 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 00:31:55,264 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:31:55,264 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 00:41:05,860 - INFO - app.core.security - Closing Redis connection...
2025-06-05 00:41:05,861 - INFO - app.core.security - Redis connection closed.
2025-06-05 02:30:56,467 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 02:30:56,467 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 02:30:56,674 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:30:56,674 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:30:56,675 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:30:56,675 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 0, 56, 674924), 'iat': datetime.datetime(2025, 6, 5, 9, 30, 56, 674927)}
2025-06-05 02:30:56,676 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExNzY1NiwiaWF0IjoxNzQ5MTE1ODU2fQ.4qbNNRh36by6LaiYWFU3XTUSyTGX2ZfEcr8tS8j-2UU

2025-06-05 02:35:15,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:35:15,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:35:15,641 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-05 02:35:15,645 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-05 02:35:46,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:35:46,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:35:46,655 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-05 02:35:46,657 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-05 02:35:53,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:35:53,713 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:35:53,714 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:35:53,714 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 10, 5, 53, 713583), 'iat': datetime.datetime(2025, 6, 5, 9, 35, 53, 713595)}
2025-06-05 02:35:53,714 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMTc5NTMsImlhdCI6MTc0OTExNjE1M30.M_uq7x5FUkQMlyLaosG-aK9Q5jsPWGMyHA-rFdIYkTE

2025-06-05 02:35:53,715 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjA5NTMsImlhdCI6MTc0OTExNjE1M30.geUSLSPS_zW7ZDelgbRjaq_vLw2HdKUSA3mK68dFwew, Expiry (seconds): 604800
2025-06-05 02:35:53,719 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 02:36:07,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:36:07,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:36:07,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:36:07,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:36:07,654 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 02:36:07,661 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 02:36:07,661 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 02:39:05,672 - INFO - app.core.security - Closing Redis connection...
2025-06-05 02:39:05,673 - INFO - app.core.security - Redis connection closed.
2025-06-05 02:39:08,079 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 02:39:08,079 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 02:39:08,194 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:39:08,194 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:39:08,194 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:39:08,194 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 9, 8, 194605), 'iat': datetime.datetime(2025, 6, 5, 9, 39, 8, 194608)}
2025-06-05 02:39:08,195 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExODE0OCwiaWF0IjoxNzQ5MTE2MzQ4fQ.cWhAZb4vyez1DGM1yqYz0HSgSRpNEQZjzmIhoLVMLpg

2025-06-05 02:39:25,442 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 02:39:25,442 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 02:39:25,520 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:39:25,520 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:39:25,520 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:39:25,520 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 9, 25, 520210), 'iat': datetime.datetime(2025, 6, 5, 9, 39, 25, 520213)}
2025-06-05 02:39:25,523 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExODE2NSwiaWF0IjoxNzQ5MTE2MzY1fQ.ReXvxaIqDNQMsTwJKqJmo2NUHLSRjZSgDY1bwsn64gw

2025-06-05 02:42:55,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:42:55,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:42:55,317 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:42:55,317 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:42:55,317 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 02:42:55,505 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 02:42:55,505 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 02:47:34,909 - INFO - app.core.security - Closing Redis connection...
2025-06-05 02:47:34,910 - INFO - app.core.security - Redis connection closed.
2025-06-05 02:47:37,964 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 02:47:37,965 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 02:47:38,139 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:47:38,139 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:47:38,139 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:47:38,139 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 17, 38, 139172), 'iat': datetime.datetime(2025, 6, 5, 9, 47, 38, 139175)}
2025-06-05 02:47:38,139 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExODY1OCwiaWF0IjoxNzQ5MTE2ODU4fQ.wMmqw2nGKz2RSlhWA6m4blNxDlF-nmQYBF2LLy8l8Ak

2025-06-05 02:47:55,893 - INFO - app.core.security - Closing Redis connection...
2025-06-05 02:47:55,897 - INFO - app.core.security - Redis connection closed.
2025-06-05 02:47:58,701 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 02:47:58,701 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 02:47:58,790 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 02:47:58,790 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 02:47:58,790 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 02:47:58,790 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 17, 58, 790314), 'iat': datetime.datetime(2025, 6, 5, 9, 47, 58, 790319)}
2025-06-05 02:47:58,791 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExODY3OCwiaWF0IjoxNzQ5MTE2ODc4fQ.WO51b1mNCnMp9m0jCokRlPa6r1_ch_25eUhjBndgXIE

2025-06-05 02:56:44,312 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:56:44,312 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:56:44,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:56:44,314 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:56:44,314 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-05 02:56:44,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 02:56:44,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 02:56:44,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:56:44,315 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 02:56:44,315 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 02:56:44,362 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 02:56:44,362 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 02:56:44,363 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 03:00:00,007 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:00:00,007 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:00:00,008 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:00:00,008 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 30, 0, 7548), 'iat': datetime.datetime(2025, 6, 5, 10, 0, 0, 7561)}
2025-06-05 03:00:00,008 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:00:00,009 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExOTQwMCwiaWF0IjoxNzQ5MTE3NjAwfQ.OIx5cmQgi24Kr2sjk9-dMWFfoTnK3-M0mK7vyUSdA9k

2025-06-05 03:00:00,009 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:00:00,009 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:00:00,009 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 30, 0, 8269), 'iat': datetime.datetime(2025, 6, 5, 10, 0, 0, 8282)}
2025-06-05 03:00:00,011 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExOTQwMCwiaWF0IjoxNzQ5MTE3NjAwfQ.OIx5cmQgi24Kr2sjk9-dMWFfoTnK3-M0mK7vyUSdA9k

2025-06-05 03:01:21,330 - INFO - app.core.security - Closing Redis connection...
2025-06-05 03:01:21,331 - INFO - app.core.security - Redis connection closed.
2025-06-05 03:01:24,176 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 03:01:24,176 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 03:01:24,270 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:01:24,270 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:01:24,270 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:01:24,270 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 10, 31, 24, 270641), 'iat': datetime.datetime(2025, 6, 5, 10, 1, 24, 270647)}
2025-06-05 03:01:24,271 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTExOTQ4NCwiaWF0IjoxNzQ5MTE3Njg0fQ.pWlfFQsNTjPyK1ZliikuUZ6zK1E-vOaOp8c0k0zY4gQ

2025-06-05 03:03:26,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:03:26,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:03:26,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 03:03:26,080 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 03:03:26,080 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-05 03:03:26,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:03:26,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:03:26,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 03:03:26,080 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749117953, 'iat': 1749116153}
2025-06-05 03:03:26,081 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 03:03:26,176 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 03:03:26,176 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 03:03:26,176 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 03:14:24,414 - INFO - app.core.security - Closing Redis connection...
2025-06-05 03:14:24,420 - INFO - app.core.security - Redis connection closed.
2025-06-05 03:30:00,074 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:30:00,077 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:30:00,077 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:30:00,077 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 11, 0, 0, 73908), 'iat': datetime.datetime(2025, 6, 5, 10, 30, 0, 73937)}
2025-06-05 03:30:00,083 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEyMTIwMCwiaWF0IjoxNzQ5MTE5NDAwfQ.2-TRAwIukpzkv7h567bkZo7K8SACMj5xuw9SNyIebMI

2025-06-05 03:33:31,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:33:31,562 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:33:31,562 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:33:31,562 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 11, 3, 31, 561900), 'iat': datetime.datetime(2025, 6, 5, 10, 33, 31, 561909)}
2025-06-05 03:33:31,562 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMjE0MTEsImlhdCI6MTc0OTExOTYxMX0.2uPca57z14X9ZTa85V0ByzWlDuzrh6NRYFj3rALYYXY

2025-06-05 03:33:31,563 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjQ0MTEsImlhdCI6MTc0OTExOTYxMX0.oq-6feXLFbpOCMTyeO4C72AofayG7sP7ysxeNceWz3g, Expiry (seconds): 604800
2025-06-05 03:33:31,598 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 03:33:45,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:33:45,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:33:45,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749121411, 'iat': 1749119611}
2025-06-05 03:36:37,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:36:37,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:36:37,811 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-05 03:36:37,815 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-05 03:36:47,619 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:36:47,620 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:36:47,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:36:47,620 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 5, 11, 6, 47, 619882), 'iat': datetime.datetime(2025, 6, 5, 10, 36, 47, 619888)}
2025-06-05 03:36:47,620 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxMjE2MDcsImlhdCI6MTc0OTExOTgwN30.1iBwx6bhVCJCnIhDnWNdPXU9yLORFm6aNt5ZiubbzaA

2025-06-05 03:36:47,620 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjQ2MDcsImlhdCI6MTc0OTExOTgwN30.YO3vROWTVU1-m7P0NYdbbEthDQE6fspMDqdevEcNp-Q, Expiry (seconds): 604800
2025-06-05 03:36:47,621 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-05 03:37:07,699 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:37:07,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:37:07,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749121607, 'iat': 1749119807}
2025-06-05 03:37:07,700 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749121607, 'iat': 1749119807}
2025-06-05 03:37:07,700 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 03:37:07,711 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 03:37:07,711 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-05 03:38:04,919 - INFO - app.core.security - Closing Redis connection...
2025-06-05 03:38:04,919 - INFO - app.core.security - Redis connection closed.
2025-06-05 03:38:07,890 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-05 03:38:07,891 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-05 03:38:07,988 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-05 03:38:07,988 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-05 03:38:07,988 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-05 03:38:07,988 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 5, 11, 8, 7, 988464), 'iat': datetime.datetime(2025, 6, 5, 10, 38, 7, 988468)}
2025-06-05 03:38:07,989 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTEyMTY4NywiaWF0IjoxNzQ5MTE5ODg3fQ.7DZUW30DcHqL0H0sVNyiZZsNvGqUTbtL3CUgq-MTq0s

2025-06-05 03:39:49,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-05 03:39:49,090 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-05 03:39:49,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749121607, 'iat': 1749119807}
2025-06-05 03:39:49,090 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749121607, 'iat': 1749119807}
2025-06-05 03:39:49,090 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-05 03:39:49,126 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-05 03:39:49,126 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 00:55:59,182 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 00:55:59,182 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 00:55:59,278 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 00:55:59,278 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 00:55:59,278 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 00:55:59,279 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 25, 59, 278773), 'iat': datetime.datetime(2025, 6, 6, 7, 55, 59, 278777)}
2025-06-06 00:55:59,279 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODM1OSwiaWF0IjoxNzQ5MTk2NTU5fQ.SdNqLZmYKQoVPkr8eIiTgHLYOvzoxXDKZpFecZrXD8g

2025-06-06 00:56:10,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 00:56:10,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 00:56:10,511 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749196807, 'iat': 1749195007}
2025-06-06 00:56:10,511 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749196807, 'iat': 1749195007}
2025-06-06 00:56:10,512 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-06 00:56:10,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 00:56:10,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 00:56:10,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749196807, 'iat': 1749195007}
2025-06-06 00:56:10,512 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749196807, 'iat': 1749195007}
2025-06-06 00:56:10,512 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 00:56:10,584 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 00:56:10,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 00:56:10,585 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 00:57:28,037 - INFO - app.core.security - Closing Redis connection...
2025-06-06 00:57:28,037 - INFO - app.core.security - Redis connection closed.
2025-06-06 00:58:50,642 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 00:58:50,642 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 00:58:50,719 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 00:58:50,719 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 00:58:50,719 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 00:58:50,719 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 28, 50, 719811), 'iat': datetime.datetime(2025, 6, 6, 7, 58, 50, 719815)}
2025-06-06 00:58:50,720 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODUzMCwiaWF0IjoxNzQ5MTk2NzMwfQ.pszr5lWEuTU1LGYnIrLzmKky67weYZ8SKGGufpNF8Nw

2025-06-06 01:00:00,001 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:00:00,001 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:00:00,001 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:00:00,001 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 30, 0, 1056), 'iat': datetime.datetime(2025, 6, 6, 8, 0, 0, 1060)}
2025-06-06 01:00:00,001 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODYwMCwiaWF0IjoxNzQ5MTk2ODAwfQ.D2wNkTs34AzqJTB6SkHl9aPNtWJmYEzJzE9uhZ-f3cs

2025-06-06 01:00:37,675 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:00:37,675 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:00:39,603 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:00:39,603 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:00:39,697 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:00:39,697 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:00:39,697 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:00:39,697 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 30, 39, 697514), 'iat': datetime.datetime(2025, 6, 6, 8, 0, 39, 697517)}
2025-06-06 01:00:39,698 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODYzOSwiaWF0IjoxNzQ5MTk2ODM5fQ.hySfyoQ-lWiRtoyu-ma76LyPa9AXoN42bptsOGHjE6Q

2025-06-06 01:02:59,500 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:02:59,500 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:02:59,500 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:02:59,500 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 8, 32, 59, 500358), 'iat': datetime.datetime(2025, 6, 6, 8, 2, 59, 500370)}
2025-06-06 01:02:59,501 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxOTg3NzksImlhdCI6MTc0OTE5Njk3OX0.48lDff65wKlFspbaCGJ_zN2LjuSW9TdF94VAUAKb79c

2025-06-06 01:02:59,501 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDE3NzksImlhdCI6MTc0OTE5Njk3OX0.n-0FYKooxB0LGZkPC7rGF8KDh70M5O1UwHJMddiYBXI, Expiry (seconds): 604800
2025-06-06 01:02:59,503 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 01:03:17,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:03:17,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:03:17,264 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:03:17,264 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:03:17,265 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:03:17,273 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:03:17,273 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:04:05,693 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:04:05,694 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:04:07,561 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:04:07,561 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:04:07,616 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:04:07,616 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:04:07,616 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:04:07,616 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 34, 7, 616509), 'iat': datetime.datetime(2025, 6, 6, 8, 4, 7, 616511)}
2025-06-06 01:04:07,616 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODg0NywiaWF0IjoxNzQ5MTk3MDQ3fQ.Av94CDeR_FldKHcDjioFfB9Rruk_U36DTyOM-Cvubt8

2025-06-06 01:04:43,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:04:43,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:04:43,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:04:43,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:04:43,053 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:04:43,081 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:04:43,082 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:05:52,274 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:05:52,274 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:05:54,227 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:05:54,227 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:05:54,283 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:05:54,283 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:05:54,283 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:05:54,283 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 35, 54, 283618), 'iat': datetime.datetime(2025, 6, 6, 8, 5, 54, 283620)}
2025-06-06 01:05:54,284 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5ODk1NCwiaWF0IjoxNzQ5MTk3MTU0fQ.hNxH0EyPREVS4PstukPQAx8zQBQKUhjfiE12TLEuQ14

2025-06-06 01:06:07,389 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:06:07,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:06:07,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:07,390 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:07,390 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:06:07,418 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:06:07,418 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:06:50,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:06:50,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:06:50,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:50,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:50,374 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:06:50,377 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:06:50,377 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:06:57,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:06:57,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:06:57,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:57,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749198779, 'iat': 1749196979}
2025-06-06 01:06:57,845 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:06:57,849 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:06:57,849 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:19:56,007 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:19:56,008 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:20:00,516 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:20:00,516 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:20:00,974 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:20:00,975 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:20:00,975 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:20:00,975 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 50, 0, 974899), 'iat': datetime.datetime(2025, 6, 6, 8, 20, 0, 974902)}
2025-06-06 01:20:00,975 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTE5OTgwMCwiaWF0IjoxNzQ5MTk4MDAwfQ.-9CdYZ2rvXqIMpcMx4bCJ-sBSFlHbx1dBW3Zvvw2-mI

2025-06-06 01:20:18,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:20:18,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:20:18,432 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-06 01:20:22,777 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:20:22,778 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:20:22,778 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:20:22,778 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 8, 50, 22, 777789), 'iat': datetime.datetime(2025, 6, 6, 8, 20, 22, 777797)}
2025-06-06 01:20:22,778 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkxOTk4MjIsImlhdCI6MTc0OTE5ODAyMn0.LaQcRlg4wK2WWSVhV1lrkGluW6IrlzwmfJ3wiuMpGCU

2025-06-06 01:20:22,778 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDI4MjIsImlhdCI6MTc0OTE5ODAyMn0.xk5BxlVGV8fNPLMetPQm7wzmAqC6mp37nhhQ_so0HME, Expiry (seconds): 604800
2025-06-06 01:20:22,779 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 01:20:31,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:20:31,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:20:31,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:21:33,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:21:33,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:21:33,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:21:33,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:21:33,089 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:21:33,103 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:21:33,103 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:25:12,438 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:25:12,438 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:25:14,658 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:25:14,658 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:25:14,727 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:25:14,727 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:25:14,727 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:25:14,727 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 55, 14, 727550), 'iat': datetime.datetime(2025, 6, 6, 8, 25, 14, 727553)}
2025-06-06 01:25:14,728 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDExNCwiaWF0IjoxNzQ5MTk4MzE0fQ.oU9gogsHEA1A81u5HJjjiJ8NpPSIdn2m0pVNONVdoX8

2025-06-06 01:25:26,264 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:25:26,269 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:25:29,500 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:25:29,500 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:25:29,718 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:25:29,718 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:25:29,718 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:25:29,718 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 55, 29, 718262), 'iat': datetime.datetime(2025, 6, 6, 8, 25, 29, 718269)}
2025-06-06 01:25:29,719 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDEyOSwiaWF0IjoxNzQ5MTk4MzI5fQ.6-CEd-7dULTIvj6A0BZgxinMed2oVo8JzYHPNrHrQg0

2025-06-06 01:25:42,413 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:25:42,413 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:25:44,159 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:25:44,159 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:25:44,213 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:25:44,213 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:25:44,213 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:25:44,213 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 55, 44, 213346), 'iat': datetime.datetime(2025, 6, 6, 8, 25, 44, 213349)}
2025-06-06 01:25:44,213 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDE0NCwiaWF0IjoxNzQ5MTk4MzQ0fQ.Fk7xu1VqRQLTP9OGFCJgf-oxgsW6WkXC-3jVx0xVD1U

2025-06-06 01:27:30,975 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:27:30,976 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:27:33,008 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:27:33,008 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:27:33,064 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:27:33,064 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:27:33,064 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:27:33,064 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 57, 33, 64338), 'iat': datetime.datetime(2025, 6, 6, 8, 27, 33, 64341)}
2025-06-06 01:27:33,064 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDI1MywiaWF0IjoxNzQ5MTk4NDUzfQ.3ZsVij6MYQ9We5Zps23zGhy30yCHHukc6vBE0nvMvSg

2025-06-06 01:28:17,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:28:17,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:28:17,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:28:58,724 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:28:58,724 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:29:00,681 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:29:00,681 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:29:00,737 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:29:00,737 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:29:00,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:29:00,737 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 8, 59, 0, 737521), 'iat': datetime.datetime(2025, 6, 6, 8, 29, 0, 737523)}
2025-06-06 01:29:00,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDM0MCwiaWF0IjoxNzQ5MTk4NTQwfQ.fGihgfGlOf6Lvli7yqRzKTfghBKqzjk6ZslkwrEMzNM

2025-06-06 01:29:02,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:29:02,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:29:02,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:35:38,598 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:35:38,599 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:35:41,097 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:35:41,097 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:35:41,205 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:35:41,205 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:35:41,205 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:35:41,205 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 5, 41, 205154), 'iat': datetime.datetime(2025, 6, 6, 8, 35, 41, 205158)}
2025-06-06 01:35:41,205 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMDc0MSwiaWF0IjoxNzQ5MTk4OTQxfQ.bA5Dlm28JSDFlRIFlTu_txT0XxZahGSINrm1EA6hGnQ

2025-06-06 01:35:49,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:35:49,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:35:49,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:36:35,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:36:35,396 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:36:35,396 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-06 01:36:35,400 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-06 01:36:46,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:36:46,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:36:46,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:36:46,465 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:36:46,465 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-06 01:36:46,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:36:46,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:36:46,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:36:46,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:36:46,465 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:36:46,519 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:36:46,520 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:36:46,520 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:44:21,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:44:21,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:44:21,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:45:01,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:45:01,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:45:01,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:45:01,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:45:01,710 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:45:01,713 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:45:01,713 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:49:39,987 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:49:39,987 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:49:42,096 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:49:42,096 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:49:42,206 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:49:42,207 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:49:42,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:49:42,207 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 19, 42, 206943), 'iat': datetime.datetime(2025, 6, 6, 8, 49, 42, 206946)}
2025-06-06 01:49:42,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTU4MiwiaWF0IjoxNzQ5MTk5NzgyfQ.6b0A1EX37qR9BdulJ9X1ZRpxSduvwHgutvqV6sJM9CI

2025-06-06 01:49:44,602 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:49:44,603 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:49:46,740 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:49:46,740 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:49:46,871 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:49:46,871 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:49:46,871 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:49:46,871 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 19, 46, 871247), 'iat': datetime.datetime(2025, 6, 6, 8, 49, 46, 871258)}
2025-06-06 01:49:46,872 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTU4NiwiaWF0IjoxNzQ5MTk5Nzg2fQ.lKzBiw5a7e4YczCsIwdW1r5vRLqcAjJlHt9saVpyRVU

2025-06-06 01:49:50,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:49:50,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:49:50,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:49:50,867 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749199822, 'iat': 1749198022}
2025-06-06 01:49:50,868 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:49:50,958 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:49:50,958 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:53:31,209 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:53:31,209 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:53:33,624 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:53:33,624 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:53:33,703 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:53:33,703 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:53:33,703 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:53:33,703 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 23, 33, 703330), 'iat': datetime.datetime(2025, 6, 6, 8, 53, 33, 703337)}
2025-06-06 01:53:33,704 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTgxMywiaWF0IjoxNzQ5MjAwMDEzfQ.yCG_9z7bcc5E2p7lE2HzjdnIlbhuh8RBPrVx5zYkYKs

2025-06-06 01:55:54,194 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:55:54,195 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:55:57,134 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:55:57,134 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:55:57,232 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:55:57,233 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:55:57,233 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:55:57,233 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 25, 57, 232922), 'iat': datetime.datetime(2025, 6, 6, 8, 55, 57, 232926)}
2025-06-06 01:55:57,233 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTk1NywiaWF0IjoxNzQ5MjAwMTU3fQ.Ozaz9sFokiac1yqdXap4cGUu8VQODva1ElZPUt99XKs

2025-06-06 01:56:01,018 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:56:01,019 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:56:03,941 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:56:03,941 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:56:04,043 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:56:04,043 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:56:04,043 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:56:04,043 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 26, 4, 43471), 'iat': datetime.datetime(2025, 6, 6, 8, 56, 4, 43476)}
2025-06-06 01:56:04,044 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTk2NCwiaWF0IjoxNzQ5MjAwMTY0fQ.4vzoSOm1SLx-B6zroPzRpSEnmxvwk1C1dSnBd3A1pXc

2025-06-06 01:56:17,099 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:56:17,100 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:56:19,431 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:56:19,431 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:56:19,511 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:56:19,512 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:56:19,512 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:56:19,512 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 26, 19, 511969), 'iat': datetime.datetime(2025, 6, 6, 8, 56, 19, 511972)}
2025-06-06 01:56:19,512 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMTk3OSwiaWF0IjoxNzQ5MjAwMTc5fQ.rQAM3BBmGLOHC67lNcOCrQt1mC0C6hQJ_Y4v1j8VBzA

2025-06-06 01:56:21,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:56:21,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:56:21,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-06 01:56:21,212 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-06 01:56:26,270 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:56:26,270 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:56:26,270 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:56:26,270 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 9, 26, 26, 270411), 'iat': datetime.datetime(2025, 6, 6, 8, 56, 26, 270421)}
2025-06-06 01:56:26,271 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMDE5ODYsImlhdCI6MTc0OTIwMDE4Nn0.neaMjXOYNR1VY_d2vj_baUpfBvM7CJUQQalNREVzVfs

2025-06-06 01:56:26,271 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDQ5ODYsImlhdCI6MTc0OTIwMDE4Nn0.sH2IxXFCkl9t3WNJ3G4IwpGP91tK-qmgGrfpaPf0TcI, Expiry (seconds): 604800
2025-06-06 01:56:26,272 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 01:56:38,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:56:38,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:56:38,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:56:38,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:56:38,863 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:56:38,874 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:56:38,874 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:57:22,413 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:57:22,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:57:22,414 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:58:09,904 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:58:09,904 - INFO - app.core.security - Redis connection closed.
2025-06-06 01:58:26,665 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 01:58:26,665 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 01:58:26,767 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 01:58:26,767 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 01:58:26,767 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 01:58:26,767 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 28, 26, 767192), 'iat': datetime.datetime(2025, 6, 6, 8, 58, 26, 767197)}
2025-06-06 01:58:26,767 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMjEwNiwiaWF0IjoxNzQ5MjAwMzA2fQ.ZhNEsh8VSOVSXb1-ey5Mm8COTI_pRr2kzEYOThcm8S4

2025-06-06 01:58:29,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:58:29,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:58:29,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:58:46,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 01:58:46,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 01:58:46,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:58:46,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 01:58:46,136 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 01:58:46,154 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 01:58:46,154 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 01:59:23,873 - INFO - app.core.security - Closing Redis connection...
2025-06-06 01:59:23,874 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:06:37,061 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:06:37,061 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:06:37,202 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:06:37,202 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:06:37,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:06:37,202 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 36, 37, 202465), 'iat': datetime.datetime(2025, 6, 6, 9, 6, 37, 202473)}
2025-06-06 02:06:37,203 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMjU5NywiaWF0IjoxNzQ5MjAwNzk3fQ.O-67kicN0Nj_dEguEtAsJXLFPdXhB31OXwF7c4tg3ck

2025-06-06 02:06:45,376 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:06:45,376 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:06:45,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:07:23,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:07:23,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:07:23,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:07:23,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:07:23,139 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 02:07:23,160 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 02:07:23,160 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 02:08:15,105 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:08:15,106 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:08:17,049 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:08:17,049 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:08:17,107 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:08:17,107 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:08:17,107 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:08:17,107 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 38, 17, 107291), 'iat': datetime.datetime(2025, 6, 6, 9, 8, 17, 107294)}
2025-06-06 02:08:17,107 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMjY5NywiaWF0IjoxNzQ5MjAwODk3fQ.UU3-0RuCAN0gp908DiubI43Cuo84DksIbbMi9oPi_3g

2025-06-06 02:08:36,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:08:36,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:08:36,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:08:55,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:08:55,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:08:55,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:08:55,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:08:55,691 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 02:08:55,708 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 02:08:55,708 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 02:10:52,184 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:10:52,184 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:10:54,186 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:10:54,186 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:10:54,278 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:10:54,279 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:10:54,279 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:10:54,279 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 40, 54, 278966), 'iat': datetime.datetime(2025, 6, 6, 9, 10, 54, 278969)}
2025-06-06 02:10:54,279 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMjg1NCwiaWF0IjoxNzQ5MjAxMDU0fQ.nWvptoMUbpwGRWhXE1ZHk-bXau-fnfWTmmI23Wa3Wkc

2025-06-06 02:13:18,220 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:13:18,221 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:13:20,332 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:13:20,332 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:13:20,440 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:13:20,440 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:13:20,440 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:13:20,440 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 43, 20, 440675), 'iat': datetime.datetime(2025, 6, 6, 9, 13, 20, 440677)}
2025-06-06 02:13:20,441 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzAwMCwiaWF0IjoxNzQ5MjAxMjAwfQ.IkmD4_WkzPDkZkkhkUiXxV25Jdei3MemUMPjhikvKUc

2025-06-06 02:13:53,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:13:53,246 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:13:53,246 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:15:04,813 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:15:04,813 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:15:06,976 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:15:06,976 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:15:07,042 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:15:07,042 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:15:07,042 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:15:07,042 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 45, 7, 42116), 'iat': datetime.datetime(2025, 6, 6, 9, 15, 7, 42119)}
2025-06-06 02:15:07,042 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzEwNywiaWF0IjoxNzQ5MjAxMzA3fQ.02X0__o_h4X9LBHg4KTxbvPz1PrZIluOZyDqGej-rdY

2025-06-06 02:15:09,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:15:09,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:15:09,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:18:42,504 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:18:42,505 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:18:44,497 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:18:44,497 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:18:44,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:18:44,599 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:18:44,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:18:44,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 48, 44, 599464), 'iat': datetime.datetime(2025, 6, 6, 9, 18, 44, 599467)}
2025-06-06 02:18:44,599 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzMyNCwiaWF0IjoxNzQ5MjAxNTI0fQ.LyRI__X_ODkk1QBUSJBTUpU0LhQnDC90citlagQaB8Q

2025-06-06 02:18:58,675 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:18:58,675 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:19:00,437 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:19:00,438 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:19:00,530 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:19:00,530 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:19:00,530 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:19:00,530 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 49, 0, 530382), 'iat': datetime.datetime(2025, 6, 6, 9, 19, 0, 530387)}
2025-06-06 02:19:00,531 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzM0MCwiaWF0IjoxNzQ5MjAxNTQwfQ.j_o9y0tP_sfSaKmIBC50qlZxSmdqW99LKD3un9ALmb0

2025-06-06 02:19:08,000 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:19:08,001 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:19:09,982 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:19:09,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:19:10,059 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:19:10,059 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:19:10,059 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:19:10,059 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 49, 10, 59347), 'iat': datetime.datetime(2025, 6, 6, 9, 19, 10, 59349)}
2025-06-06 02:19:10,059 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzM1MCwiaWF0IjoxNzQ5MjAxNTUwfQ.1TrxQp4PlbCNlIH0tzfyJPgktvBfxMXrEGtD9oyVbSc

2025-06-06 02:19:12,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:19:12,770 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:19:12,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:19:44,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:19:44,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:19:44,585 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:20:05,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:20:05,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:20:05,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:20:05,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:20:05,913 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 02:20:05,933 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 02:20:05,933 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 02:22:31,264 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:22:31,264 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:22:33,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:22:33,251 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:22:33,317 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:22:33,317 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:22:33,317 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:22:33,317 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 52, 33, 317266), 'iat': datetime.datetime(2025, 6, 6, 9, 22, 33, 317269)}
2025-06-06 02:22:33,317 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzU1MywiaWF0IjoxNzQ5MjAxNzUzfQ.Tc9jr0bGj3-QCO8CuOSHiTGV6GVox1vZbq6hy36BKBg

2025-06-06 02:22:42,741 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:22:42,741 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:22:44,609 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:22:44,609 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:22:44,693 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:22:44,694 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:22:44,694 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:22:44,694 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 52, 44, 693776), 'iat': datetime.datetime(2025, 6, 6, 9, 22, 44, 693781)}
2025-06-06 02:22:44,695 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzU2NCwiaWF0IjoxNzQ5MjAxNzY0fQ.FXPac-irpbuwJtwX1tflfvO94D-yc3KDzSu7aDWZKPc

2025-06-06 02:22:49,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:22:49,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:22:49,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:23:04,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:23:04,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:23:04,076 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:23:04,076 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749201986, 'iat': 1749200186}
2025-06-06 02:23:04,076 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 02:23:04,103 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 02:23:04,103 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 02:26:58,525 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:26:58,526 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:27:01,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:27:01,792 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:27:01,877 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:27:01,877 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:27:01,877 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:27:01,878 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 57, 1, 877881), 'iat': datetime.datetime(2025, 6, 6, 9, 27, 1, 877884)}
2025-06-06 02:27:01,878 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzgyMSwiaWF0IjoxNzQ5MjAyMDIxfQ.Wb_pf3DwIGwIDGZE_eR2uJgE8HhtjC5Y6Cc3OSXcXx0

2025-06-06 02:27:53,833 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:27:53,833 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:27:56,124 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:27:56,124 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:27:56,224 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:27:56,224 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:27:56,224 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:27:56,224 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 57, 56, 224551), 'iat': datetime.datetime(2025, 6, 6, 9, 27, 56, 224557)}
2025-06-06 02:27:56,225 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzg3NiwiaWF0IjoxNzQ5MjAyMDc2fQ.J-VcNuq3c2EUIEbQToVIAU4h_ddEGpAVpXmvSFhCx5I

2025-06-06 02:28:23,801 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:28:23,801 - INFO - app.core.security - Redis connection closed.
2025-06-06 02:28:26,058 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 02:28:26,058 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 02:28:26,136 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:28:26,136 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:28:26,136 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:28:26,136 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 9, 58, 26, 136219), 'iat': datetime.datetime(2025, 6, 6, 9, 28, 26, 136222)}
2025-06-06 02:28:26,136 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwMzkwNiwiaWF0IjoxNzQ5MjAyMTA2fQ.kDjzx1wbz_5zTBWbHZ9Yjj19HLRHaTMXeaCfLrYJxj4

2025-06-06 02:28:45,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:28:45,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:28:45,484 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-06 02:28:59,730 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:28:59,730 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:28:59,730 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:28:59,730 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 9, 58, 59, 730112), 'iat': datetime.datetime(2025, 6, 6, 9, 28, 59, 730120)}
2025-06-06 02:28:59,730 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMDM5MzksImlhdCI6MTc0OTIwMjEzOX0.FjdDIK5i6qlDnz0GCAOtw-C6GYR-leikUhAeFKYcKvA

2025-06-06 02:28:59,730 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDY5MzksImlhdCI6MTc0OTIwMjEzOX0.V6C9dAQxzA4y2bHROXpm2TWEORsIRkwyiQpNlWuUuzc, Expiry (seconds): 604800
2025-06-06 02:28:59,731 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 02:29:16,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 02:29:16,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 02:29:16,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749203939, 'iat': 1749202139}
2025-06-06 02:30:00,009 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 02:30:00,009 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 02:30:00,009 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 02:30:00,010 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 10, 0, 0, 9688), 'iat': datetime.datetime(2025, 6, 6, 9, 30, 0, 9693)}
2025-06-06 02:30:00,010 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIwNDAwMCwiaWF0IjoxNzQ5MjAyMjAwfQ.zhQHv1w3k5ff-Toae-fMW2jqAKf30mdYd2H3wbCf8uI

2025-06-06 02:30:49,025 - INFO - app.core.security - Closing Redis connection...
2025-06-06 02:30:49,025 - INFO - app.core.security - Redis connection closed.
2025-06-06 05:46:23,327 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 05:46:23,328 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 05:46:23,627 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 05:46:23,627 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 05:46:23,627 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 05:46:23,627 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 16, 23, 627444), 'iat': datetime.datetime(2025, 6, 6, 12, 46, 23, 627451)}
2025-06-06 05:46:23,629 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNTc4MywiaWF0IjoxNzQ5MjEzOTgzfQ.AE2TTtKN-LVjL455uzc0qNDC_MLG6RlEG-ffWJ9dSB4

2025-06-06 05:46:49,844 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 05:46:49,844 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 05:46:49,844 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 05:46:49,844 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 13, 16, 49, 844301), 'iat': datetime.datetime(2025, 6, 6, 12, 46, 49, 844311)}
2025-06-06 05:46:49,845 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMTU4MDksImlhdCI6MTc0OTIxNDAwOX0.985weSGGo0zcmgOMqxOypMc6-pgLbgDCzLGwfKhMKBY

2025-06-06 05:46:49,845 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTg4MDksImlhdCI6MTc0OTIxNDAwOX0.a2x8I6PTAKWT6856tgU5P5iLTxWlnGrUqANNPTK2tzo, Expiry (seconds): 604800
2025-06-06 05:46:49,879 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 05:47:11,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 05:47:11,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 05:47:11,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749215809, 'iat': 1749214009}
2025-06-06 05:50:59,388 - INFO - app.core.security - Closing Redis connection...
2025-06-06 05:50:59,389 - INFO - app.core.security - Redis connection closed.
2025-06-06 05:53:58,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 05:53:58,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 05:53:58,433 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 05:53:58,433 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 05:53:58,433 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 05:53:58,433 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 23, 58, 433072), 'iat': datetime.datetime(2025, 6, 6, 12, 53, 58, 433075)}
2025-06-06 05:53:58,434 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNjIzOCwiaWF0IjoxNzQ5MjE0NDM4fQ.Ma_WFq07EmGckL3ACv-_RjtznZXpJ7Ddk0B-H7dmtSI

2025-06-06 05:54:03,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 05:54:03,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 05:54:03,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749215809, 'iat': 1749214009}
2025-06-06 05:54:35,465 - INFO - app.core.security - Closing Redis connection...
2025-06-06 05:54:35,466 - INFO - app.core.security - Redis connection closed.
2025-06-06 05:55:18,615 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 05:55:18,615 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 05:55:18,776 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 05:55:18,776 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 05:55:18,777 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 05:55:18,777 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 25, 18, 776570), 'iat': datetime.datetime(2025, 6, 6, 12, 55, 18, 776577)}
2025-06-06 05:55:18,778 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNjMxOCwiaWF0IjoxNzQ5MjE0NTE4fQ.5hyGw4SRTOpMO3KxkwwLVgzPOSRUnOmffsWpkf7w6qg

2025-06-06 05:55:22,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 05:55:22,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 05:55:22,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749215809, 'iat': 1749214009}
2025-06-06 05:58:22,376 - INFO - app.core.security - Closing Redis connection...
2025-06-06 05:58:22,376 - INFO - app.core.security - Redis connection closed.
2025-06-06 06:04:10,751 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 06:04:10,751 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 06:04:10,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:04:10,922 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:04:10,922 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:04:10,922 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 34, 10, 922282), 'iat': datetime.datetime(2025, 6, 6, 13, 4, 10, 922285)}
2025-06-06 06:04:10,928 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNjg1MCwiaWF0IjoxNzQ5MjE1MDUwfQ.zozZneRgrZSEEhzopSRsN2phXg78qPeoO0n8rOtqh14

2025-06-06 06:04:23,206 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:04:23,207 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:04:23,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:04:23,207 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 13, 34, 23, 206723), 'iat': datetime.datetime(2025, 6, 6, 13, 4, 23, 206732)}
2025-06-06 06:04:23,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMTY4NjMsImlhdCI6MTc0OTIxNTA2M30.7MLdUSm0O6-qE_-Ay-p3L3_Vx-RYxaZzNL9V1c354Y0

2025-06-06 06:04:23,208 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTk4NjMsImlhdCI6MTc0OTIxNTA2M30.PJ4xj0RE-u6_c_OrtJRFYnnAZksE1-VtfzVVTClrpUs, Expiry (seconds): 604800
2025-06-06 06:04:23,208 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 06:04:34,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 06:04:34,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 06:04:34,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749216863, 'iat': 1749215063}
2025-06-06 06:04:34,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749216863, 'iat': 1749215063}
2025-06-06 06:04:34,289 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 06:04:34,300 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 06:04:34,300 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 06:04:43,193 - INFO - app.core.security - Closing Redis connection...
2025-06-06 06:04:43,194 - INFO - app.core.security - Redis connection closed.
2025-06-06 06:06:13,327 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 06:06:13,327 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 06:06:13,521 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:06:13,521 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:06:13,521 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:06:13,521 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 36, 13, 521250), 'iat': datetime.datetime(2025, 6, 6, 13, 6, 13, 521261)}
2025-06-06 06:06:13,523 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNjk3MywiaWF0IjoxNzQ5MjE1MTczfQ.8iQERW6U7cMoc8_8lwA2IwMDZqQpEWtj_fkhdrhrKLA

2025-06-06 06:06:16,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 06:06:16,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 06:06:16,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749216863, 'iat': 1749215063}
2025-06-06 06:06:16,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749216863, 'iat': 1749215063}
2025-06-06 06:06:16,623 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 06:06:16,681 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 06:06:16,681 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 06:12:37,477 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 06:12:37,478 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 06:12:37,628 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:12:37,628 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:12:37,628 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:12:37,628 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 42, 37, 628023), 'iat': datetime.datetime(2025, 6, 6, 13, 12, 37, 628031)}
2025-06-06 06:12:37,630 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxNzM1NywiaWF0IjoxNzQ5MjE1NTU3fQ.VzMAwjs2-30zFcb1J7krDLleuDRCbR1WwMCRAA8yQ7Y

2025-06-06 06:13:41,616 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:13:41,616 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:13:41,616 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:13:41,617 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 13, 43, 41, 616503), 'iat': datetime.datetime(2025, 6, 6, 13, 13, 41, 616513)}
2025-06-06 06:13:41,617 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMTc0MjEsImlhdCI6MTc0OTIxNTYyMX0.akFwhr8jDYWgWDV16a76ocZq7LNyZkmTOJ9pDDjOLTI

2025-06-06 06:13:41,617 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjA0MjEsImlhdCI6MTc0OTIxNTYyMX0.KpdQrwGKw0b_7HyC-FMvpJSmn7pYD3WcjD5x8bFzuBc, Expiry (seconds): 604800
2025-06-06 06:13:41,618 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 06:13:53,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 06:13:53,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 06:13:53,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749217421, 'iat': 1749215621}
2025-06-06 06:14:14,153 - INFO - app.core.security - Closing Redis connection...
2025-06-06 06:14:14,154 - INFO - app.core.security - Redis connection closed.
2025-06-06 06:25:26,323 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 06:25:26,324 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 06:25:26,473 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:25:26,473 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:25:26,473 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:25:26,473 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 55, 26, 473568), 'iat': datetime.datetime(2025, 6, 6, 13, 25, 26, 473572)}
2025-06-06 06:25:26,474 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxODEyNiwiaWF0IjoxNzQ5MjE2MzI2fQ.wRg3MoQ_p1YclNGur4AXH8p8L68izm8Q0i0YsE2u-PU

2025-06-06 06:25:37,637 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:25:37,638 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:25:37,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:25:37,638 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 6, 13, 55, 37, 637697), 'iat': datetime.datetime(2025, 6, 6, 13, 25, 37, 637706)}
2025-06-06 06:25:37,638 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDkyMTgxMzcsImlhdCI6MTc0OTIxNjMzN30.MN13ngyFNjNW-WJ84DtpMoTjwr3cQVsva-NerVJ2-xk

2025-06-06 06:25:37,639 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MjExMzcsImlhdCI6MTc0OTIxNjMzN30.vqHPP6qkm1-hL8tAyobCBYOzNuGT6g1XO_91jydMNHU, Expiry (seconds): 604800
2025-06-06 06:25:37,640 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-06 06:25:47,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 06:25:47,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 06:25:47,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749218137, 'iat': 1749216337}
2025-06-06 06:26:00,102 - INFO - app.core.security - Closing Redis connection...
2025-06-06 06:26:00,103 - INFO - app.core.security - Redis connection closed.
2025-06-06 06:28:00,683 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 06:28:00,683 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 06:28:00,864 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 06:28:00,865 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 06:28:00,865 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 06:28:00,865 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 13, 58, 0, 864793), 'iat': datetime.datetime(2025, 6, 6, 13, 28, 0, 864808)}
2025-06-06 06:28:00,867 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIxODI4MCwiaWF0IjoxNzQ5MjE2NDgwfQ.9QxSbJgzqS0jJ4JzwqMofgZZIbR8BXQqxB9Ll7-EOgw

2025-06-06 06:28:06,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 06:28:06,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 06:28:06,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749218137, 'iat': 1749216337}
2025-06-06 06:28:14,142 - INFO - app.core.security - Closing Redis connection...
2025-06-06 06:28:14,142 - INFO - app.core.security - Redis connection closed.
2025-06-06 09:28:14,767 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 09:28:14,767 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 09:28:14,909 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:28:14,909 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:28:14,909 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:28:14,909 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 16, 58, 14, 908973), 'iat': datetime.datetime(2025, 6, 6, 16, 28, 14, 908980)}
2025-06-06 09:28:14,913 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIyOTA5NCwiaWF0IjoxNzQ5MjI3Mjk0fQ.cjScLXxglCtkCEMj1bQLyCU6c2wg_mBqUSnHI5SqOew

2025-06-06 09:30:00,023 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:30:00,023 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:30:00,023 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:30:00,024 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 17, 0, 0, 23568), 'iat': datetime.datetime(2025, 6, 6, 16, 30, 0, 23576)}
2025-06-06 09:30:00,024 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIyOTIwMCwiaWF0IjoxNzQ5MjI3NDAwfQ.dgptnz12g3bvG1FqAIjcbwY4rF0vzrThRdYmK3LD-Bg

2025-06-06 09:31:46,544 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:31:46,544 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:31:46,544 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:31:46,544 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 6, 17, 1, 46, 544189), 'iat': datetime.datetime(2025, 6, 6, 16, 31, 46, 544199)}
2025-06-06 09:31:46,545 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDkyMjkzMDYsImlhdCI6MTc0OTIyNzUwNn0.i9yZlajgSVN40_eBU74nAQRdSFXmE3M7nvdrVip2L2o

2025-06-06 09:31:46,545 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MzIzMDYsImlhdCI6MTc0OTIyNzUwNn0.frkV3o44ZytxaUmRT7kXbhinkUrqFnIhUic7pm2kJjI, Expiry (seconds): 604800
2025-06-06 09:31:46,546 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-06 09:31:57,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:31:57,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:31:57,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749229306, 'iat': 1749227506}
2025-06-06 09:32:07,106 - INFO - app.core.security - Closing Redis connection...
2025-06-06 09:32:07,107 - INFO - app.core.security - Redis connection closed.
2025-06-06 09:37:28,937 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 09:37:28,937 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 09:37:29,101 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:37:29,101 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:37:29,101 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:37:29,101 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 17, 7, 29, 101394), 'iat': datetime.datetime(2025, 6, 6, 16, 37, 29, 101398)}
2025-06-06 09:37:29,102 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIyOTY0OSwiaWF0IjoxNzQ5MjI3ODQ5fQ.aTkShZXJsiO-kEXJeSYHA0uOnHl2UoIsE8geq6JZa1E

2025-06-06 09:37:36,458 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:37:36,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:37:36,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749229306, 'iat': 1749227506}
2025-06-06 09:39:07,050 - INFO - app.core.security - Closing Redis connection...
2025-06-06 09:39:07,051 - INFO - app.core.security - Redis connection closed.
2025-06-06 09:45:40,686 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 09:45:40,687 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 09:45:40,816 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:45:40,816 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:45:40,816 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:45:40,817 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 17, 15, 40, 816808), 'iat': datetime.datetime(2025, 6, 6, 16, 45, 40, 816814)}
2025-06-06 09:45:40,817 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIzMDE0MCwiaWF0IjoxNzQ5MjI4MzQwfQ.OwiDS8WTh-XSaF7pW7ORUtWViza2ft3xyBLGGDudXAA

2025-06-06 09:46:01,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:46:01,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:46:01,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749229306, 'iat': 1749227506}
2025-06-06 09:46:29,454 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:46:29,454 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:46:29,455 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:46:29,455 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 6, 17, 16, 29, 454797), 'iat': datetime.datetime(2025, 6, 6, 16, 46, 29, 454804)}
2025-06-06 09:46:29,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDkyMzAxODksImlhdCI6MTc0OTIyODM4OX0.7k_kSo_Q6YxOGo_ZEyOGs1sWS9l-1E_08-nAJV7o6DY

2025-06-06 09:46:29,455 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MzMxODksImlhdCI6MTc0OTIyODM4OX0.ftq9RBtBfZc-LtKQlvyekvbtkg416_tCejDp-T7bKHY, Expiry (seconds): 604800
2025-06-06 09:46:29,456 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-06 09:46:48,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:46:48,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:46:48,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:50:14,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:50:14,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:50:14,673 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:51:33,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:51:33,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:51:33,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:51:33,763 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:51:33,763 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-06 09:51:33,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:51:33,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:51:33,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:51:33,763 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:51:33,763 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-06 09:51:33,769 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-06 09:51:33,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 09:51:33,770 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-06 09:52:14,621 - INFO - app.core.security - Closing Redis connection...
2025-06-06 09:52:14,622 - INFO - app.core.security - Redis connection closed.
2025-06-06 09:54:17,347 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-06 09:54:17,348 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-06 09:54:17,583 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-06 09:54:17,583 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-06 09:54:17,583 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-06 09:54:17,583 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 6, 17, 24, 17, 583265), 'iat': datetime.datetime(2025, 6, 6, 16, 54, 17, 583269)}
2025-06-06 09:54:17,584 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTIzMDY1NywiaWF0IjoxNzQ5MjI4ODU3fQ.8IsaFyIleDEJvZFqjx3Y16GdOm8e58aEjV4VQFUsz1Q

2025-06-06 09:54:22,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-06 09:54:22,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-06 09:54:22,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749230189, 'iat': 1749228389}
2025-06-06 09:54:33,267 - INFO - app.core.security - Closing Redis connection...
2025-06-06 09:54:33,272 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:36:02,983 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:36:02,983 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:36:03,108 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:36:03,108 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:36:03,109 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:36:03,109 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 6, 3, 108849), 'iat': datetime.datetime(2025, 6, 9, 9, 36, 3, 108854)}
2025-06-09 02:36:03,109 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2MzU2MywiaWF0IjoxNzQ5NDYxNzYzfQ.k-SycKSdl0y2W5RDly_y5Gt420QgXr4iUgmrKhrClS4

2025-06-09 02:39:42,202 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:39:42,203 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:39:44,815 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:39:44,815 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:39:44,952 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:39:44,952 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:39:44,952 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:39:44,952 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 9, 44, 952271), 'iat': datetime.datetime(2025, 6, 9, 9, 39, 44, 952277)}
2025-06-09 02:39:44,953 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Mzc4NCwiaWF0IjoxNzQ5NDYxOTg0fQ.eh1xVRp0p-6cK_U_K8Fj025V06xUhtWrFmUOsd0ikUQ

2025-06-09 02:40:48,960 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:40:48,962 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:40:51,407 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:40:51,407 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:40:51,539 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:40:51,539 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:40:51,539 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:40:51,539 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 10, 51, 539422), 'iat': datetime.datetime(2025, 6, 9, 9, 40, 51, 539426)}
2025-06-09 02:40:51,539 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Mzg1MSwiaWF0IjoxNzQ5NDYyMDUxfQ.-Z0hJ1vkJmFS_W_2GKF6oVy3LppyOTiIvDdhUFPRu-I

2025-06-09 02:41:14,163 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:41:14,164 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:41:16,391 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:41:16,391 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:41:16,558 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:41:16,558 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:41:16,558 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:41:16,558 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 11, 16, 558368), 'iat': datetime.datetime(2025, 6, 9, 9, 41, 16, 558374)}
2025-06-09 02:41:16,559 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Mzg3NiwiaWF0IjoxNzQ5NDYyMDc2fQ.weH9Puiggqt4Fm9vnKHfO2mDmtv7HGWz1TZcF39P4Ys

2025-06-09 02:43:07,211 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:43:07,212 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:48:06,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:48:06,254 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:48:06,505 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:48:06,505 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:48:06,505 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:48:06,505 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 18, 6, 505149), 'iat': datetime.datetime(2025, 6, 9, 9, 48, 6, 505155)}
2025-06-09 02:48:06,506 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NDI4NiwiaWF0IjoxNzQ5NDYyNDg2fQ.g9vUuJolL7P13ZxK49ZVdKGN8-WpH3CoNXslUW8wzMs

2025-06-09 02:48:38,398 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:48:38,398 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:48:38,399 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:48:38,400 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 10, 18, 38, 398270), 'iat': datetime.datetime(2025, 6, 9, 9, 48, 38, 398279)}
2025-06-09 02:48:38,400 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0NjQzMTgsImlhdCI6MTc0OTQ2MjUxOH0.SskwvWrVMYf4tz64vi9i3bRculRGZ5wSGJg3JB04m3w

2025-06-09 02:48:38,400 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNjczMTgsImlhdCI6MTc0OTQ2MjUxOH0.J3icu_YNiKx55M54jg-c6HvRUufXvtIwKTKd9pdL378, Expiry (seconds): 604800
2025-06-09 02:48:38,402 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 02:49:10,143 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 02:49:10,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 02:49:10,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464318, 'iat': 1749462518}
2025-06-09 02:50:09,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 02:50:09,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 02:50:09,834 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 02:50:09,836 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-09 02:50:35,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 02:50:35,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 02:50:35,387 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 02:50:35,388 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-09 02:51:21,415 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:51:21,415 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:51:21,415 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:51:21,415 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 10, 21, 21, 415551), 'iat': datetime.datetime(2025, 6, 9, 9, 51, 21, 415554)}
2025-06-09 02:51:21,416 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0NjQ0ODEsImlhdCI6MTc0OTQ2MjY4MX0.wwyWsh_UzLjOIfkEn2i5OW5Pqb_BSEX3v7ecIPefaVM

2025-06-09 02:51:21,416 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNjc0ODEsImlhdCI6MTc0OTQ2MjY4MX0.dhvkzctUcHhnGm1HIu8Vvcv1bO6BxFBuJxVBHB5JhiQ, Expiry (seconds): 604800
2025-06-09 02:51:21,416 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 02:51:30,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 02:51:30,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 02:51:30,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 02:51:30,419 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 02:51:30,419 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 02:51:30,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 02:51:30,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 02:51:30,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 02:51:30,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 02:51:30,419 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 02:51:30,424 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 02:51:30,424 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 02:51:30,424 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 02:59:04,245 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:59:04,246 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:59:06,820 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:59:06,820 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:59:06,954 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:59:06,954 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:59:06,954 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:59:06,954 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 29, 6, 954260), 'iat': datetime.datetime(2025, 6, 9, 9, 59, 6, 954267)}
2025-06-09 02:59:06,955 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NDk0NiwiaWF0IjoxNzQ5NDYzMTQ2fQ.MSaVEOeQts-hhJwekjsFeGUifYzyb0LLjFg2MChJYy4

2025-06-09 02:59:45,722 - INFO - app.core.security - Closing Redis connection...
2025-06-09 02:59:45,722 - INFO - app.core.security - Redis connection closed.
2025-06-09 02:59:48,018 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 02:59:48,019 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 02:59:48,146 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 02:59:48,146 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 02:59:48,146 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 02:59:48,146 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 29, 48, 146726), 'iat': datetime.datetime(2025, 6, 9, 9, 59, 48, 146729)}
2025-06-09 02:59:48,147 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NDk4OCwiaWF0IjoxNzQ5NDYzMTg4fQ.75uyi7VFD2H-RakVA80X6Gi8YXF_iTKXP1eSixLhRmM

2025-06-09 03:00:00,015 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:00:00,016 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:00:00,016 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:00:00,016 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 30, 0, 15712), 'iat': datetime.datetime(2025, 6, 9, 10, 0, 0, 15730)}
2025-06-09 03:00:00,017 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTAwMCwiaWF0IjoxNzQ5NDYzMjAwfQ.q6BG_MnC81wh15gZLObYPlYacAitS8D5aQkaYArIcKo

2025-06-09 03:00:10,910 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:00:10,911 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:00:13,275 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:00:13,276 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:00:13,421 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:00:13,421 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:00:13,421 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:00:13,421 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 30, 13, 421711), 'iat': datetime.datetime(2025, 6, 9, 10, 0, 13, 421714)}
2025-06-09 03:00:13,422 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTAxMywiaWF0IjoxNzQ5NDYzMjEzfQ.LgrHyh3VPeaujY5259uk4RCRC7vzVI0IWZ6FbIxlZJs

2025-06-09 03:00:52,290 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:00:52,294 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:00:54,972 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:00:54,972 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:00:55,139 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:00:55,139 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:00:55,139 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:00:55,139 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 30, 55, 139695), 'iat': datetime.datetime(2025, 6, 9, 10, 0, 55, 139701)}
2025-06-09 03:00:55,140 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTA1NSwiaWF0IjoxNzQ5NDYzMjU1fQ.bBsCYGGKRAbLTimEMFMIp9MN4wLDXpNM_PnULcf6Sbs

2025-06-09 03:01:18,082 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:01:18,083 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:01:20,224 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:01:20,224 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:01:20,392 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:01:20,393 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:01:20,393 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:01:20,393 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 31, 20, 392871), 'iat': datetime.datetime(2025, 6, 9, 10, 1, 20, 392879)}
2025-06-09 03:01:20,393 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTA4MCwiaWF0IjoxNzQ5NDYzMjgwfQ.FCnFSznNmwbH6oXXUuUOxCUDoVZWy_xyXn_zJl2dr0U

2025-06-09 03:01:46,338 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:01:46,339 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:01:48,599 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:01:48,599 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:01:48,757 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:01:48,757 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:01:48,757 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:01:48,757 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 31, 48, 757357), 'iat': datetime.datetime(2025, 6, 9, 10, 1, 48, 757362)}
2025-06-09 03:01:48,758 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTEwOCwiaWF0IjoxNzQ5NDYzMzA4fQ.WXEtX-uTZt0x-7f9cxVuYQqZATAkamV7DWXAk3076V4

2025-06-09 03:02:34,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:02:34,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:02:34,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464318, 'iat': 1749462518}
2025-06-09 03:03:58,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:03:58,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:03:58,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464318, 'iat': 1749462518}
2025-06-09 03:04:55,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:04:55,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:04:55,010 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:04:55,010 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:04:55,010 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:04:55,068 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:04:55,068 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:09:55,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:09:55,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:09:55,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:09:55,965 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:09:55,966 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 03:09:55,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:09:55,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:09:55,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:09:55,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464481, 'iat': 1749462681}
2025-06-09 03:09:55,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:09:55,979 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:09:55,979 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:09:55,980 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:10:06,572 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:10:06,578 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:15:39,248 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:15:39,248 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:15:39,501 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:15:39,501 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:15:39,501 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:15:39,501 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 45, 39, 501362), 'iat': datetime.datetime(2025, 6, 9, 10, 15, 39, 501367)}
2025-06-09 03:15:39,502 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTkzOSwiaWF0IjoxNzQ5NDY0MTM5fQ.RwGnCSJI31Q1flEbdJwUduOx8-Li5OoJQb_yi7ZkaWA

2025-06-09 03:15:50,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:15:50,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:15:50,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464318, 'iat': 1749462518}
2025-06-09 03:16:14,995 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:16:14,996 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:16:26,522 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:16:26,522 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:16:26,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:16:26,696 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:16:26,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:16:26,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 46, 26, 696420), 'iat': datetime.datetime(2025, 6, 9, 10, 16, 26, 696423)}
2025-06-09 03:16:26,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NTk4NiwiaWF0IjoxNzQ5NDY0MTg2fQ.Of_DIm9zOAJwU-kcSo1DoCfiYQA9vQxDbywtDSIKEOs

2025-06-09 03:16:30,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:16:30,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:16:30,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749464318, 'iat': 1749462518}
2025-06-09 03:17:22,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:17:22,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:17:22,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 03:17:22,617 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-09 03:17:32,050 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:17:32,050 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:17:32,050 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:17:32,051 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 10, 47, 32, 50428), 'iat': datetime.datetime(2025, 6, 9, 10, 17, 32, 50440)}
2025-06-09 03:17:32,051 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0NjYwNTIsImlhdCI6MTc0OTQ2NDI1Mn0.WUD8zz7BapTC__u5HEwKiUgfjlTVzSzGjbfSEgZhmtA

2025-06-09 03:17:32,051 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNjkwNTIsImlhdCI6MTc0OTQ2NDI1Mn0.NTB61AiRSVZYm-F7dgRTtdopLGUqyxDGMVy77JcdWMI, Expiry (seconds): 604800
2025-06-09 03:17:32,052 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 03:17:41,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:17:41,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:17:41,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:17:41,080 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:17:41,080 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 03:17:41,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:17:41,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:17:41,081 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:17:41,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:17:41,081 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:17:41,088 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:17:41,088 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:17:41,088 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:18:12,059 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:18:12,060 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:23:06,618 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:23:06,618 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:23:06,809 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:23:06,809 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:23:06,809 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:23:06,810 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 53, 6, 809830), 'iat': datetime.datetime(2025, 6, 9, 10, 23, 6, 809835)}
2025-06-09 03:23:06,810 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NjM4NiwiaWF0IjoxNzQ5NDY0NTg2fQ.VPFesgrd06m6CvOctjbVoZy-QtxUwvwJOg2qND2pADk

2025-06-09 03:23:08,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:23:08,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:23:08,876 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 03:23:16,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:23:16,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:23:16,751 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:23:40,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:23:40,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:23:40,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:23:40,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:23:40,041 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:23:40,064 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:23:40,065 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:24:01,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:24:01,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:24:01,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:24:01,629 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:24:01,629 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 03:24:01,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:24:01,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:24:01,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:24:01,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:24:01,630 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:24:01,637 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:24:01,637 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:24:01,637 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:24:15,491 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:24:15,492 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:29:49,293 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:29:49,294 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:29:49,462 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:29:49,462 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:29:49,462 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:29:49,462 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 10, 59, 49, 462425), 'iat': datetime.datetime(2025, 6, 9, 10, 29, 49, 462428)}
2025-06-09 03:29:49,462 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Njc4OSwiaWF0IjoxNzQ5NDY0OTg5fQ.VHhhZo1ZBBV_SyrRfNlNGe8c-tU5aTBQvVtEuJ2nEdU

2025-06-09 03:29:57,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:29:57,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:29:57,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:30:00,016 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:30:00,016 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:30:00,016 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:30:00,016 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 0, 0, 16411), 'iat': datetime.datetime(2025, 6, 9, 10, 30, 0, 16426)}
2025-06-09 03:30:00,017 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NjgwMCwiaWF0IjoxNzQ5NDY1MDAwfQ._9uNB0NSt0G5ix1-wK3rA-CmcOVK0aY8pA7gpU5ZVzg

2025-06-09 03:30:07,693 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:30:07,694 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:32:38,597 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:32:38,597 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:32:38,769 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:32:38,769 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:32:38,769 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:32:38,769 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 2, 38, 769574), 'iat': datetime.datetime(2025, 6, 9, 10, 32, 38, 769578)}
2025-06-09 03:32:38,770 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Njk1OCwiaWF0IjoxNzQ5NDY1MTU4fQ.YbneJqC9vLt5M2sV06dhwexESI5QHaqlGqIACSDfFm0

2025-06-09 03:32:42,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:32:42,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:32:42,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:33:12,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:33:12,068 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:33:12,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:33:12,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:33:12,069 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:33:12,089 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:33:12,090 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:34:07,664 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:34:07,664 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:34:56,387 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:34:56,387 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:34:56,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:34:56,561 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:34:56,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:34:56,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 4, 56, 561466), 'iat': datetime.datetime(2025, 6, 9, 10, 34, 56, 561478)}
2025-06-09 03:34:56,562 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NzA5NiwiaWF0IjoxNzQ5NDY1Mjk2fQ.sKYBcZecwujuphO_Bh5bywnKXOj4lo-jeTqhM34KtCg

2025-06-09 03:36:39,642 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:36:39,643 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:36:41,973 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:36:41,974 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:36:42,161 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:36:42,161 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:36:42,161 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:36:42,161 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 6, 42, 161272), 'iat': datetime.datetime(2025, 6, 9, 10, 36, 42, 161295)}
2025-06-09 03:36:42,162 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NzIwMiwiaWF0IjoxNzQ5NDY1NDAyfQ.u6YbY_6DjL6r2-YwTJVfK7ch3sAXO1LG6TEEPefoN3c

2025-06-09 03:36:44,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:36:44,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:36:44,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:37:22,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:37:22,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:37:22,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:37:22,470 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:37:22,470 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 03:37:22,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:37:22,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:37:22,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:37:22,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749466052, 'iat': 1749464252}
2025-06-09 03:37:22,471 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:37:22,497 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:37:22,500 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:37:22,501 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:44:41,796 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:44:41,798 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:44:44,722 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:44:44,723 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:44:44,908 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:44:44,908 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:44:44,908 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:44:44,908 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 14, 44, 908015), 'iat': datetime.datetime(2025, 6, 9, 10, 44, 44, 908018)}
2025-06-09 03:44:44,908 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NzY4NCwiaWF0IjoxNzQ5NDY1ODg0fQ.llQSP613URG5ytambv499XpSUdPgWsyQTcku4ErK-c8

2025-06-09 03:45:59,891 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:45:59,892 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:46:02,058 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:46:02,058 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:46:02,207 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:46:02,207 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:46:02,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:46:02,207 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 16, 2, 207581), 'iat': datetime.datetime(2025, 6, 9, 10, 46, 2, 207584)}
2025-06-09 03:46:02,208 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Nzc2MiwiaWF0IjoxNzQ5NDY1OTYyfQ.hZ9dY2sN-BQicr9wSIWoMIdBr3V6_0NaqXH1habhulw

2025-06-09 03:46:48,330 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:46:48,330 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:46:50,182 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:46:50,182 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:46:50,305 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:46:50,305 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:46:50,305 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:46:50,305 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 16, 50, 305564), 'iat': datetime.datetime(2025, 6, 9, 10, 46, 50, 305568)}
2025-06-09 03:46:50,306 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NzgxMCwiaWF0IjoxNzQ5NDY2MDEwfQ.1PRk3TTdiurMMc67-iaV7YV6CZmnVwmEFvSY39DiWcE

2025-06-09 03:47:13,623 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:47:13,624 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:47:15,561 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:47:15,561 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:47:15,677 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:47:15,677 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:47:15,677 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:47:15,677 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 17, 15, 677154), 'iat': datetime.datetime(2025, 6, 9, 10, 47, 15, 677162)}
2025-06-09 03:47:15,677 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2NzgzNSwiaWF0IjoxNzQ5NDY2MDM1fQ.PNXj24yiO-2mBR367IRhMCEVxDYiyivA0uJ9i20qgBg

2025-06-09 03:48:06,586 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:48:06,587 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:48:08,632 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:48:08,632 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:48:08,753 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:48:08,753 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:48:08,753 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:48:08,753 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 18, 8, 753011), 'iat': datetime.datetime(2025, 6, 9, 10, 48, 8, 753018)}
2025-06-09 03:48:08,753 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Nzg4OCwiaWF0IjoxNzQ5NDY2MDg4fQ.rTqtXVIP8sQaSzUZtm2_vbHGksjC4WpilN2BzHVBd30

2025-06-09 03:49:08,722 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:49:08,723 - INFO - app.core.security - Redis connection closed.
2025-06-09 03:49:11,350 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 03:49:11,351 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 03:49:11,469 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:49:11,470 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:49:11,470 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:49:11,470 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 19, 11, 469920), 'iat': datetime.datetime(2025, 6, 9, 10, 49, 11, 469926)}
2025-06-09 03:49:11,471 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2Nzk1MSwiaWF0IjoxNzQ5NDY2MTUxfQ.hfniBNEH8rZ3oM3qtD2VjcHn7b9k_RP2xj8o6K8D6ps

2025-06-09 03:49:13,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:49:13,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:49:13,530 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 03:49:18,171 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 03:49:18,171 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 03:49:18,171 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 03:49:18,171 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 11, 19, 18, 171072), 'iat': datetime.datetime(2025, 6, 9, 10, 49, 18, 171085)}
2025-06-09 03:49:18,172 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0Njc5NTgsImlhdCI6MTc0OTQ2NjE1OH0.7WaKRUVr1d4TKdwbxvtHR4rOJf8woSzIZL3uMhicuac

2025-06-09 03:49:18,172 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzA5NTgsImlhdCI6MTc0OTQ2NjE1OH0.ODyWc3lNflj3M6u0rPaii3ZRhK7lrRUKK0YNHe0Do50, Expiry (seconds): 604800
2025-06-09 03:49:18,174 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 03:49:31,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:49:31,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:49:31,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 03:49:59,059 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:49:59,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:49:59,060 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 03:49:59,061 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-09 03:50:17,270 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 03:50:17,270 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 03:50:17,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 03:50:17,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 03:50:17,270 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 03:50:17,284 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 03:50:17,284 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 03:51:26,807 - INFO - app.core.security - Closing Redis connection...
2025-06-09 03:51:26,808 - INFO - app.core.security - Redis connection closed.
2025-06-09 04:02:35,476 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 04:02:35,476 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 04:02:35,731 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 04:02:35,732 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 04:02:35,732 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 04:02:35,732 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 32, 35, 731931), 'iat': datetime.datetime(2025, 6, 9, 11, 2, 35, 731938)}
2025-06-09 04:02:35,735 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ2ODc1NSwiaWF0IjoxNzQ5NDY2OTU1fQ.Z48IK36whFUcFija6TmI7J2vP6eRXndxuvL2y--E-wc

2025-06-09 04:02:38,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:02:38,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:02:38,155 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 04:03:19,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:03:19,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:03:19,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 04:03:19,152 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 04:03:19,152 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-09 04:03:19,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:03:19,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:03:19,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 04:03:19,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749467958, 'iat': 1749466158}
2025-06-09 04:03:19,153 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 04:03:19,178 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 04:03:19,178 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 04:03:19,178 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 04:03:49,782 - INFO - app.core.security - Closing Redis connection...
2025-06-09 04:03:49,783 - INFO - app.core.security - Redis connection closed.
2025-06-09 04:24:36,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 04:24:36,650 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 04:24:36,911 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 04:24:36,911 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 04:24:36,911 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 04:24:36,911 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 11, 54, 36, 911044), 'iat': datetime.datetime(2025, 6, 9, 11, 24, 36, 911057)}
2025-06-09 04:24:36,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ3MDA3NiwiaWF0IjoxNzQ5NDY4Mjc2fQ.L0T3GjVsvZN3OJ4rt2-cAu8WvQYZF_GI2idaunQ67ew

2025-06-09 04:24:40,546 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:24:40,546 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:24:40,548 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 04:25:07,997 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 04:25:07,998 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 04:25:07,998 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 04:25:07,998 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 11, 55, 7, 997855), 'iat': datetime.datetime(2025, 6, 9, 11, 25, 7, 997864)}
2025-06-09 04:25:07,998 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0NzAxMDcsImlhdCI6MTc0OTQ2ODMwN30.yP_ZYVPPHdu91v81tnf0FcFEat5HlplKvZvEm7Y8XI4

2025-06-09 04:25:07,999 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzMxMDcsImlhdCI6MTc0OTQ2ODMwN30.IztWg06YDpmxIE9PTxN3OSqaEj_RTpaABP_JAAC3p_8, Expiry (seconds): 604800
2025-06-09 04:25:08,000 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 04:25:18,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:25:18,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:25:18,620 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749470107, 'iat': 1749468307}
2025-06-09 04:25:46,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:25:46,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:25:46,519 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-09 04:25:46,521 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-09 04:26:01,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:26:01,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:26:01,753 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749470107, 'iat': 1749468307}
2025-06-09 04:26:01,753 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749470107, 'iat': 1749468307}
2025-06-09 04:26:01,753 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-09 04:26:01,759 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-09 04:26:01,759 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-09 04:27:47,674 - INFO - app.core.security - Closing Redis connection...
2025-06-09 04:27:47,676 - INFO - app.core.security - Redis connection closed.
2025-06-09 04:41:05,317 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 04:41:05,317 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 04:41:05,519 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 04:41:05,519 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 04:41:05,519 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 04:41:05,519 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 12, 11, 5, 519352), 'iat': datetime.datetime(2025, 6, 9, 11, 41, 5, 519358)}
2025-06-09 04:41:05,520 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ3MTA2NSwiaWF0IjoxNzQ5NDY5MjY1fQ.6X4PgpcmfY9jsyCgwvxsZtvjuBtrVm0mwZ7pkbDyoP4

2025-06-09 04:42:10,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 04:42:10,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 04:42:10,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749470107, 'iat': 1749468307}
2025-06-09 04:43:00,165 - INFO - app.core.security - Closing Redis connection...
2025-06-09 04:43:00,168 - INFO - app.core.security - Redis connection closed.
2025-06-09 05:03:48,390 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-09 05:03:48,391 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-09 05:03:48,639 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 05:03:48,639 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 05:03:48,639 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 05:03:48,639 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 9, 12, 33, 48, 639203), 'iat': datetime.datetime(2025, 6, 9, 12, 3, 48, 639211)}
2025-06-09 05:03:48,644 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTQ3MjQyOCwiaWF0IjoxNzQ5NDcwNjI4fQ.TSUq0vYfMeVuo-wcaUZfIHDZ_ziYpQaa03dnBbK2j7I

2025-06-09 05:04:06,059 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-09 05:04:06,059 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-09 05:04:06,060 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-09 05:04:06,060 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 9, 12, 34, 6, 58936), 'iat': datetime.datetime(2025, 6, 9, 12, 4, 6, 58951)}
2025-06-09 05:04:06,061 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk0NzI0NDYsImlhdCI6MTc0OTQ3MDY0Nn0.1En8xd7cOw0sjLadEgFRCH37kmu99KkTcOPDZfXdSxU

2025-06-09 05:04:06,062 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzU0NDYsImlhdCI6MTc0OTQ3MDY0Nn0.i-FPETSQeZCTxdnwvWAIWOV66jLE4eG6yeKm-Dac794, Expiry (seconds): 604800
2025-06-09 05:04:06,064 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-09 05:04:16,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-09 05:04:16,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-09 05:04:16,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749472446, 'iat': 1749470646}
2025-06-09 05:05:00,439 - INFO - app.core.security - Closing Redis connection...
2025-06-09 05:05:00,441 - INFO - app.core.security - Redis connection closed.
2025-06-10 00:56:48,889 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 00:56:48,889 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 00:56:49,002 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 00:56:49,002 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 00:56:49,002 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 00:56:49,002 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 8, 26, 49, 2123), 'iat': datetime.datetime(2025, 6, 10, 7, 56, 49, 2127)}
2025-06-10 00:56:49,002 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NDAwOSwiaWF0IjoxNzQ5NTQyMjA5fQ.oJicF5htKF1d7IFGzO3Wm6eFF6YRfZcQGMRmynF8EYU

2025-06-10 00:56:53,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 00:56:53,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 00:56:53,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749543558, 'iat': 1749541758}
2025-06-10 01:00:00,008 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:00:00,008 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:00:00,008 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:00:00,008 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 8, 30, 0, 8610), 'iat': datetime.datetime(2025, 6, 10, 8, 0, 0, 8616)}
2025-06-10 01:00:00,009 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NDIwMCwiaWF0IjoxNzQ5NTQyNDAwfQ.t7bYlzs6Ho_dPv1s0dVr43f4Hq4wx5TDtLubiWzbk80

2025-06-10 01:05:34,118 - INFO - app.core.security - Closing Redis connection...
2025-06-10 01:05:34,121 - INFO - app.core.security - Redis connection closed.
2025-06-10 01:05:36,940 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 01:05:36,940 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 01:05:37,184 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:05:37,185 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:05:37,185 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:05:37,185 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 8, 35, 37, 184921), 'iat': datetime.datetime(2025, 6, 10, 8, 5, 37, 184928)}
2025-06-10 01:05:37,186 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NDUzNywiaWF0IjoxNzQ5NTQyNzM3fQ.e7-QIYqF8jBybnWQ9FAHbUSguPMBbuDNepOpUMtjolY

2025-06-10 01:30:00,023 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:30:00,025 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:30:00,026 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:30:00,026 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 0, 0, 23709), 'iat': datetime.datetime(2025, 6, 10, 8, 30, 0, 23725)}
2025-06-10 01:30:00,030 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NjAwMCwiaWF0IjoxNzQ5NTQ0MjAwfQ.kp9Y950v0e1lt79zczj-C8OZ1BsLoA2K6vcwQsREKis

2025-06-10 01:39:02,455 - INFO - app.core.security - Closing Redis connection...
2025-06-10 01:39:02,459 - INFO - app.core.security - Redis connection closed.
2025-06-10 01:39:05,237 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 01:39:05,237 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 01:39:05,429 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:39:05,429 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:39:05,429 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:39:05,429 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 9, 5, 429210), 'iat': datetime.datetime(2025, 6, 10, 8, 39, 5, 429213)}
2025-06-10 01:39:05,429 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NjU0NSwiaWF0IjoxNzQ5NTQ0NzQ1fQ.s6tQJCuvRdcSCJ4rLH4QcGadJqtWJkDvZ9VD9cCjWWM

2025-06-10 01:42:12,713 - INFO - app.core.security - Closing Redis connection...
2025-06-10 01:42:12,714 - INFO - app.core.security - Redis connection closed.
2025-06-10 01:42:15,053 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 01:42:15,053 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 01:42:15,246 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:42:15,246 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:42:15,246 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:42:15,246 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 12, 15, 246587), 'iat': datetime.datetime(2025, 6, 10, 8, 42, 15, 246592)}
2025-06-10 01:42:15,247 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NjczNSwiaWF0IjoxNzQ5NTQ0OTM1fQ.BTGyI12y6ZyyMg5EyOMLK5wgePJXwz7Mb5Z4YE3V6fQ

2025-06-10 01:44:13,747 - INFO - app.core.security - Closing Redis connection...
2025-06-10 01:44:13,748 - INFO - app.core.security - Redis connection closed.
2025-06-10 01:55:50,848 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 01:55:50,848 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 01:55:51,013 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:55:51,013 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:55:51,013 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:55:51,013 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 25, 51, 13596), 'iat': datetime.datetime(2025, 6, 10, 8, 55, 51, 13603)}
2025-06-10 01:55:51,014 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0NzU1MSwiaWF0IjoxNzQ5NTQ1NzUxfQ.2kqQt2YfkPEgZMW7K2gPQsEEju4x5c9_g40fO85-dp0

2025-06-10 01:55:58,094 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 01:55:58,094 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 01:55:58,094 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 01:55:58,095 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 9, 25, 58, 94372), 'iat': datetime.datetime(2025, 6, 10, 8, 55, 58, 94386)}
2025-06-10 01:55:58,095 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NDc1NTgsImlhdCI6MTc0OTU0NTc1OH0.KrewVBEz6J61EDEm3CAnlxosq9KVNG0Z7GE8uln5uZ4

2025-06-10 01:55:58,095 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTA1NTgsImlhdCI6MTc0OTU0NTc1OH0.F8BySkG1K5UfZxo7IwxAOdxxCoN0jqUQtEsTnaqZnPQ, Expiry (seconds): 604800
2025-06-10 01:55:58,127 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 01:56:08,977 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 01:56:08,978 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 01:56:08,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:56:55,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 01:56:55,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 01:56:55,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:57:20,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 01:57:20,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 01:57:20,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:57:20,670 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:57:20,670 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 01:57:20,670 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 01:57:20,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 01:57:20,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:57:20,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:57:20,670 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 01:57:20,694 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 01:57:20,696 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 01:57:20,697 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 01:57:31,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 01:57:31,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 01:57:31,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 01:59:32,669 - INFO - app.core.security - Closing Redis connection...
2025-06-10 01:59:32,670 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:08:27,519 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:08:27,520 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:08:27,645 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:08:27,645 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:08:27,645 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:08:27,645 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 38, 27, 645083), 'iat': datetime.datetime(2025, 6, 10, 9, 8, 27, 645087)}
2025-06-10 02:08:27,645 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0ODMwNywiaWF0IjoxNzQ5NTQ2NTA3fQ.jFzUY8f_vtK9TDbHWr8CotWutKzSFWyn0Iz3WKRQPwo

2025-06-10 02:08:33,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:08:33,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:08:33,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 02:12:50,455 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:12:50,456 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:15:49,056 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:15:49,056 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:15:49,173 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:15:49,173 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:15:49,173 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:15:49,173 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 45, 49, 173649), 'iat': datetime.datetime(2025, 6, 10, 9, 15, 49, 173652)}
2025-06-10 02:15:49,174 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0ODc0OSwiaWF0IjoxNzQ5NTQ2OTQ5fQ.mpQoJmaFBAbRLdQ-dOGZgQLK3rztRM8YBe0ibhNmIVQ

2025-06-10 02:15:53,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:15:53,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:15:53,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 02:16:02,150 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:16:02,152 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:19:43,455 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:19:43,455 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:19:43,571 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:19:43,571 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:19:43,571 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:19:43,571 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 49, 43, 571655), 'iat': datetime.datetime(2025, 6, 10, 9, 19, 43, 571657)}
2025-06-10 02:19:43,572 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0ODk4MywiaWF0IjoxNzQ5NTQ3MTgzfQ.EfrVYz40zJRhTPnAzMqo4QSN952KTwvxRymeOeY7Q0k

2025-06-10 02:19:54,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:19:54,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:19:54,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 02:20:59,611 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:20:59,612 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:21:01,986 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:21:01,986 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:21:02,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:21:02,117 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:21:02,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:21:02,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 9, 51, 2, 117527), 'iat': datetime.datetime(2025, 6, 10, 9, 21, 2, 117530)}
2025-06-10 02:21:02,118 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0OTA2MiwiaWF0IjoxNzQ5NTQ3MjYyfQ.g97e7_vLeEcmAzS0p0xrw-IY5mH4fuViQ1dD5wECoRI

2025-06-10 02:22:23,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:22:23,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:22:23,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749547558, 'iat': 1749545758}
2025-06-10 02:23:16,162 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:23:16,163 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:23:16,163 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:23:16,163 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 9, 53, 16, 162785), 'iat': datetime.datetime(2025, 6, 10, 9, 23, 16, 162797)}
2025-06-10 02:23:16,163 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NDkxOTYsImlhdCI6MTc0OTU0NzM5Nn0.6pDtgCIIFG_EQIfZWiWFLUFbZ6UhOz0f5FbJePG9IOY

2025-06-10 02:23:16,164 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTIxOTYsImlhdCI6MTc0OTU0NzM5Nn0.7lClEbK5oDBRgPkzneTgoe_9mY4k5NJGCeRIyn4C4HY, Expiry (seconds): 604800
2025-06-10 02:23:16,166 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 02:23:30,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:23:30,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:23:30,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549196, 'iat': 1749547396}
2025-06-10 02:23:30,311 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549196, 'iat': 1749547396}
2025-06-10 02:23:30,311 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 02:23:30,317 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 02:23:30,317 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:23:47,623 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:23:47,625 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:31:09,981 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:31:09,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:31:10,155 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:31:10,155 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:31:10,155 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:31:10,155 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 1, 10, 155640), 'iat': datetime.datetime(2025, 6, 10, 9, 31, 10, 155645)}
2025-06-10 02:31:10,157 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU0OTY3MCwiaWF0IjoxNzQ5NTQ3ODcwfQ.2ht6_OVvEKGtbVtlA35q2-RxOtVg3F7gzrfeKTHyqN0

2025-06-10 02:31:12,669 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:31:12,669 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:31:12,669 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:31:12,669 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 10, 1, 12, 669595), 'iat': datetime.datetime(2025, 6, 10, 9, 31, 12, 669599)}
2025-06-10 02:31:12,670 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NDk2NzIsImlhdCI6MTc0OTU0Nzg3Mn0.eLvZ7NW9YRz3kZkMZOVvqOTk6MOczGyH1d9DElTVDs4

2025-06-10 02:31:12,670 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTI2NzIsImlhdCI6MTc0OTU0Nzg3Mn0.dLTcMsua1fKrDN4qtKCXUmkTB8y-B4lOAuMwfm46JrY, Expiry (seconds): 604800
2025-06-10 02:31:12,670 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 02:31:26,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:31:26,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:31:26,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:31:41,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:31:41,908 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:31:41,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:31:41,909 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:31:41,909 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 02:31:41,932 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 02:31:41,933 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:32:23,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:32:23,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:32:23,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:32:23,536 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:32:23,536 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 02:32:23,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:32:23,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:32:23,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:32:23,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:32:23,536 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 02:32:23,545 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 02:32:23,546 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:32:23,546 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:32:46,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:32:46,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:32:46,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:33:20,062 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:33:20,063 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:39:41,787 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:39:41,787 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:39:41,913 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:39:41,913 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:39:41,913 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:39:41,913 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 9, 41, 913505), 'iat': datetime.datetime(2025, 6, 10, 9, 39, 41, 913509)}
2025-06-10 02:39:41,914 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MDE4MSwiaWF0IjoxNzQ5NTQ4MzgxfQ.mYN2eZ4LuPT-NCjKe4cYomnafu7I3tkN14kNsUmpu7M

2025-06-10 02:39:57,671 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:39:57,671 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:39:57,672 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749549672, 'iat': 1749547872}
2025-06-10 02:40:01,709 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:40:01,710 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:40:01,710 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:40:01,710 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 10, 10, 1, 709649), 'iat': datetime.datetime(2025, 6, 10, 9, 40, 1, 709662)}
2025-06-10 02:40:01,710 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTAyMDEsImlhdCI6MTc0OTU0ODQwMX0.g1tESiQLiEPgyEtNDcD3WU3sXKmuFWvyM8L1A3A4i_4

2025-06-10 02:40:01,711 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTMyMDEsImlhdCI6MTc0OTU0ODQwMX0.Lj-0v47o_C5TJakUb2LPFPp8Hi5YzQNSy8FLmkRTuws, Expiry (seconds): 604800
2025-06-10 02:40:01,712 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 02:40:09,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:40:09,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:40:09,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:41:21,473 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:41:21,474 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:41:23,497 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:41:23,497 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:41:23,625 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:41:23,625 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:41:23,625 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:41:23,625 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 11, 23, 625074), 'iat': datetime.datetime(2025, 6, 10, 9, 41, 23, 625079)}
2025-06-10 02:41:23,626 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MDI4MywiaWF0IjoxNzQ5NTQ4NDgzfQ.0XOvKlAuQRPJ7arS5gRQfcrQbkDBrFFHOJDbD-kAWpU

2025-06-10 02:43:55,193 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:43:55,195 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:43:57,507 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:43:57,508 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:43:57,658 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:43:57,658 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:43:57,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:43:57,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 13, 57, 658374), 'iat': datetime.datetime(2025, 6, 10, 9, 43, 57, 658378)}
2025-06-10 02:43:57,658 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MDQzNywiaWF0IjoxNzQ5NTQ4NjM3fQ.6Roy_hyTiJLdzU_WfAaRgbvyUgt2o-vzLHPP0u2Q29A

2025-06-10 02:44:33,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:44:33,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:44:33,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:45:28,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:45:28,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:45:28,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:45:28,430 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:45:28,430 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 02:45:28,457 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 02:45:28,457 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:46:00,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:46:00,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:46:00,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:46:00,936 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:46:00,936 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 02:46:00,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:46:00,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:46:00,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:46:00,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:46:00,937 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 02:46:00,944 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 02:46:00,944 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:46:00,944 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 02:46:22,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 02:46:22,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 02:46:22,688 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 02:58:05,129 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:58:05,130 - INFO - app.core.security - Redis connection closed.
2025-06-10 02:58:08,377 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 02:58:08,377 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 02:58:08,506 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 02:58:08,506 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 02:58:08,506 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 02:58:08,506 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 28, 8, 506213), 'iat': datetime.datetime(2025, 6, 10, 9, 58, 8, 506223)}
2025-06-10 02:58:08,507 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MTI4OCwiaWF0IjoxNzQ5NTQ5NDg4fQ.l51fwY0WsYeFH-6r3yojo7MXv81LzWAmXVrdJd5gP9U

2025-06-10 02:58:12,045 - INFO - app.core.security - Closing Redis connection...
2025-06-10 02:58:12,046 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:06:32,872 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:06:32,872 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:06:33,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:06:33,022 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:06:33,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:06:33,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 36, 33, 22038), 'iat': datetime.datetime(2025, 6, 10, 10, 6, 33, 22043)}
2025-06-10 03:06:33,024 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MTc5MywiaWF0IjoxNzQ5NTQ5OTkzfQ.r9x8vq3thJaxtXl6D6dAQZSXybLRINzcH-epi7WpUnY

2025-06-10 03:06:38,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:06:38,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:06:38,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:03,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:07:03,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:07:03,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:03,821 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:03,823 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:07:03,926 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:07:03,927 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:07:24,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:07:24,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:07:24,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:24,381 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:24,381 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 03:07:24,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:07:24,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:07:24,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:24,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749550201, 'iat': 1749548401}
2025-06-10 03:07:24,382 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:07:24,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:07:24,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:07:24,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:07:53,941 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:07:53,942 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:20:15,371 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:20:15,371 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:20:15,493 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:20:15,494 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:20:15,494 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:20:15,494 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 10, 50, 15, 493928), 'iat': datetime.datetime(2025, 6, 10, 10, 20, 15, 493936)}
2025-06-10 03:20:15,495 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MjYxNSwiaWF0IjoxNzQ5NTUwODE1fQ.xtHQEZZxcfaEdGcV6bFZQURAsj9NY0Ukk-Z6r-mjjBw

2025-06-10 03:20:24,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:20:24,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:20:24,562 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 03:20:25,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:20:25,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:20:25,860 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 03:20:37,062 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:20:37,062 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:20:37,062 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:20:37,062 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 10, 50, 37, 62186), 'iat': datetime.datetime(2025, 6, 10, 10, 20, 37, 62189)}
2025-06-10 03:20:37,062 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTI2MzcsImlhdCI6MTc0OTU1MDgzN30.3w87MyhXzjQvkrZH2aqy_0wBl1u92qrCm_bpmdw_eNY

2025-06-10 03:20:37,062 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTU2MzcsImlhdCI6MTc0OTU1MDgzN30.DrpMOqsjmaHhLixV_jAz5STvWktuyBrvB6930oh_6dU, Expiry (seconds): 604800
2025-06-10 03:20:37,063 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 03:20:48,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:20:48,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:20:48,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:21:16,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:21:16,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:21:16,596 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-10 03:21:16,599 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-10 03:21:27,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:21:27,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:21:27,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:21:27,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:21:27,437 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:21:27,456 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:21:27,456 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:22:29,124 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:22:29,125 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:31:40,441 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:31:40,441 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:31:40,567 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:31:40,567 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:31:40,567 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:31:40,567 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 1, 40, 567189), 'iat': datetime.datetime(2025, 6, 10, 10, 31, 40, 567192)}
2025-06-10 03:31:40,567 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1MzMwMCwiaWF0IjoxNzQ5NTUxNTAwfQ.0-oaMGvjeVx6Fq2UagNgGWX9_fxwZJI6Txwdr03MSDE

2025-06-10 03:31:46,050 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:31:46,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:31:46,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:32:28,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:32:28,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:32:28,353 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 03:32:28,356 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-10 03:32:34,455 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:32:34,455 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:32:34,455 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:32:34,455 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 11, 2, 34, 455020), 'iat': datetime.datetime(2025, 6, 10, 10, 32, 34, 455030)}
2025-06-10 03:32:34,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTMzNTQsImlhdCI6MTc0OTU1MTU1NH0.hIIbFXtlHk7XS1UU71UwwNruGs00WCSWNGBY1TPCFdc

2025-06-10 03:32:34,456 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTYzNTQsImlhdCI6MTc0OTU1MTU1NH0.iRaG11CBeH8kBJxKoS-nMyIWu03CmfslSo5d2ICwwj8, Expiry (seconds): 604800
2025-06-10 03:32:34,456 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 03:32:43,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:32:43,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:32:43,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749553354, 'iat': 1749551554}
2025-06-10 03:32:43,259 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749553354, 'iat': 1749551554}
2025-06-10 03:32:43,259 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 03:32:43,259 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:32:43,259 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:32:43,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749553354, 'iat': 1749551554}
2025-06-10 03:32:43,260 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749553354, 'iat': 1749551554}
2025-06-10 03:32:43,260 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:32:43,268 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:32:43,269 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:32:43,269 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:33:25,616 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:33:25,617 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:46:15,968 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:46:15,968 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:46:16,118 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:46:16,118 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:46:16,118 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:46:16,118 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 16, 16, 118575), 'iat': datetime.datetime(2025, 6, 10, 10, 46, 16, 118579)}
2025-06-10 03:46:16,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NDE3NiwiaWF0IjoxNzQ5NTUyMzc2fQ.EjWOGVKtGN6RCakENAyXM9t-Al9rO39_DIfyXvlcPWA

2025-06-10 03:46:20,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:46:20,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:46:20,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:48:29,232 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:48:29,233 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:48:31,574 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:48:31,574 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:48:31,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:48:31,723 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:48:31,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:48:31,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 18, 31, 723576), 'iat': datetime.datetime(2025, 6, 10, 10, 48, 31, 723582)}
2025-06-10 03:48:31,724 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NDMxMSwiaWF0IjoxNzQ5NTUyNTExfQ.kUvpNxMkvCNS5bxOCfbf5FSzwYN1nXssjuM0VGAfc6E

2025-06-10 03:48:54,563 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:48:54,564 - INFO - app.core.security - Redis connection closed.
2025-06-10 03:48:56,797 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 03:48:56,798 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 03:48:56,938 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 03:48:56,938 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 03:48:56,939 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 03:48:56,939 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 18, 56, 938813), 'iat': datetime.datetime(2025, 6, 10, 10, 48, 56, 938819)}
2025-06-10 03:48:56,939 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NDMzNiwiaWF0IjoxNzQ5NTUyNTM2fQ.zPD8PIdwp8zDQvRXWB3vl_LbrfMAp7pl20y-55vqUo4

2025-06-10 03:48:58,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:48:58,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:48:58,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:49:32,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:49:32,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:49:32,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:49:32,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:49:32,198 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:49:32,215 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:49:32,215 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:50:05,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 03:50:05,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 03:50:05,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:50:05,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749552637, 'iat': 1749550837}
2025-06-10 03:50:05,304 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 03:50:05,311 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 03:50:05,311 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 03:50:29,377 - INFO - app.core.security - Closing Redis connection...
2025-06-10 03:50:29,378 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:00:12,711 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:00:12,711 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:00:12,879 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:00:12,879 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:00:12,879 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:00:12,879 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 30, 12, 878996), 'iat': datetime.datetime(2025, 6, 10, 11, 0, 12, 879008)}
2025-06-10 04:00:12,880 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NTAxMiwiaWF0IjoxNzQ5NTUzMjEyfQ.5qqzjJF0h8PFUX-fAJGcVLPj74TVx_UJslSzUu0uuGQ

2025-06-10 04:12:31,886 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:12:31,889 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:12:34,976 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:12:34,977 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:12:35,175 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:12:35,175 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:12:35,176 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:12:35,176 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 42, 35, 175816), 'iat': datetime.datetime(2025, 6, 10, 11, 12, 35, 175819)}
2025-06-10 04:12:35,176 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NTc1NSwiaWF0IjoxNzQ5NTUzOTU1fQ.NGgRav5tlvHs9bRGMUdqlnVMMTYeg7HHD7_4adX037U

2025-06-10 04:13:15,692 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:13:15,693 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:13:17,929 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:13:17,929 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:13:18,054 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:13:18,054 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:13:18,054 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:13:18,054 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 43, 18, 54189), 'iat': datetime.datetime(2025, 6, 10, 11, 13, 18, 54192)}
2025-06-10 04:13:18,054 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NTc5OCwiaWF0IjoxNzQ5NTUzOTk4fQ.aWI4KVw1tpEd92PWUoAKZSJx1TwKo7W-SPM2d46_RLg

2025-06-10 04:13:52,638 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:13:52,639 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:13:54,843 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:13:54,843 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:13:55,007 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:13:55,007 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:13:55,007 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:13:55,007 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 43, 55, 7378), 'iat': datetime.datetime(2025, 6, 10, 11, 13, 55, 7384)}
2025-06-10 04:13:55,008 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NTgzNSwiaWF0IjoxNzQ5NTU0MDM1fQ.M9dUQNH9c82ZHLsOBGhE5i8liAEi6OJArzAemWDwbAg

2025-06-10 04:19:32,306 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:19:32,308 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:19:35,615 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:19:35,615 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:19:35,778 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:19:35,778 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:19:35,778 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:19:35,778 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 49, 35, 778283), 'iat': datetime.datetime(2025, 6, 10, 11, 19, 35, 778286)}
2025-06-10 04:19:35,779 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjE3NSwiaWF0IjoxNzQ5NTU0Mzc1fQ.HUT0YXCC6cPG_HLttqgqCYJ4sRzK-So7Wh1Wul3KL9A

2025-06-10 04:19:57,709 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:19:57,711 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:19:59,990 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:19:59,990 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:20:00,139 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:20:00,139 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:20:00,140 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:20:00,140 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 50, 0, 139780), 'iat': datetime.datetime(2025, 6, 10, 11, 20, 0, 139786)}
2025-06-10 04:20:00,141 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjIwMCwiaWF0IjoxNzQ5NTU0NDAwfQ.ikOozuCoCLL0pIgr-9_TO2NMCTok9fNsnkuI0RPWZ4c

2025-06-10 04:20:32,312 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:20:32,313 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:20:34,317 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:20:34,318 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:20:34,451 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:20:34,451 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:20:34,451 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:20:34,451 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 50, 34, 451628), 'iat': datetime.datetime(2025, 6, 10, 11, 20, 34, 451631)}
2025-06-10 04:20:34,452 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjIzNCwiaWF0IjoxNzQ5NTU0NDM0fQ.ljlt8NlsMDOY7A4Z5SulOXDFeUBBbIFHaWV8nIlR-f0

2025-06-10 04:21:06,928 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:21:06,929 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:21:08,892 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:21:08,892 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:21:09,014 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:21:09,014 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:21:09,015 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:21:09,015 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 51, 9, 14857), 'iat': datetime.datetime(2025, 6, 10, 11, 21, 9, 14861)}
2025-06-10 04:21:09,015 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjI2OSwiaWF0IjoxNzQ5NTU0NDY5fQ.K-xMBPRea2yOi9x3oVp3LrtoXBRP5FNy8yQsZIXJTtY

2025-06-10 04:21:39,279 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:21:39,279 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:21:41,185 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:21:41,185 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:21:41,291 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:21:41,291 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:21:41,291 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:21:41,291 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 51, 41, 291642), 'iat': datetime.datetime(2025, 6, 10, 11, 21, 41, 291646)}
2025-06-10 04:21:41,292 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjMwMSwiaWF0IjoxNzQ5NTU0NTAxfQ.N97-Yub6Qgh75QZ0qVLkwWMjBbm8Vf8-0Ne99DHMQLE

2025-06-10 04:27:25,289 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:27:25,290 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:27:27,481 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:27:27,482 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:27:27,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:27:27,696 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:27:27,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:27:27,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 11, 57, 27, 696064), 'iat': datetime.datetime(2025, 6, 10, 11, 27, 27, 696072)}
2025-06-10 04:27:27,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjY0NywiaWF0IjoxNzQ5NTU0ODQ3fQ.luqAcbsdxZiqcXEl91BOuqBWZ4jQskL8T7U8qL1Ne9o

2025-06-10 04:28:49,410 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:28:49,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:28:49,411 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 04:30:00,005 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:30:00,006 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:30:00,006 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:30:00,006 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 0, 0, 5805), 'iat': datetime.datetime(2025, 6, 10, 11, 30, 0, 5816)}
2025-06-10 04:30:00,007 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NjgwMCwiaWF0IjoxNzQ5NTU1MDAwfQ.L2oImhpTXYllfQOsKeiP54kALJLcAj3vl1lSP5QnMOU

2025-06-10 04:30:28,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:30:28,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:30:28,893 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 04:31:09,678 - WARNING - app.core.security - Access token is missing.
2025-06-10 04:32:21,128 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:32:21,129 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:32:21,129 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:32:21,129 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 12, 2, 21, 128852), 'iat': datetime.datetime(2025, 6, 10, 11, 32, 21, 128861)}
2025-06-10 04:32:21,130 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTY5NDEsImlhdCI6MTc0OTU1NTE0MX0.8mrc5Q6Vny7p29c6C-LSPAkTA8TV-gLC1z_c6VjUZ3E

2025-06-10 04:32:21,130 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNTk5NDEsImlhdCI6MTc0OTU1NTE0MX0.6RG8KFIGZ47-MbvcsJS6h-u0D-bpF1Rk6ZrhdeNiDyo, Expiry (seconds): 604800
2025-06-10 04:32:21,163 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 04:32:41,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:32:41,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:32:41,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:10,086 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:10,086 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:33:10,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:10,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:10,086 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:33:10,093 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:33:10,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:33:10,093 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:37,540 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:37,540 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:33:37,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:37,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:33:37,540 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:33:37,546 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:33:37,546 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:33:37,546 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:34:33,454 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:34:33,455 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:40:12,617 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:40:12,617 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:40:12,789 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:40:12,789 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:40:12,789 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:40:12,789 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 10, 12, 789545), 'iat': datetime.datetime(2025, 6, 10, 11, 40, 12, 789547)}
2025-06-10 04:40:12,790 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1NzQxMiwiaWF0IjoxNzQ5NTU1NjEyfQ.bYKaNqt7G2oPN_JsTcAEMDKzwrNAsUprC7GsKI-yhfU

2025-06-10 04:40:16,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:40:16,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:40:16,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:33,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:40:33,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:40:33,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:33,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:33,255 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:40:33,271 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:40:33,271 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:40:51,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:40:51,571 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:40:51,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:51,572 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:51,572 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 04:40:51,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:40:51,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:40:51,572 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:51,572 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:40:51,572 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:40:51,579 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:40:51,579 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:40:51,580 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:42:24,954 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:42:24,955 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:52:11,522 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:52:11,523 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:52:11,895 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:52:11,895 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:52:11,895 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:52:11,895 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 22, 11, 895059), 'iat': datetime.datetime(2025, 6, 10, 11, 52, 11, 895068)}
2025-06-10 04:52:11,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1ODEzMSwiaWF0IjoxNzQ5NTU2MzMxfQ.uwtnxPx1hI3c6mQw6uPiZUJFMxdxLDGyAm9wX1fnxFo

2025-06-10 04:52:25,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:52:25,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:52:25,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:52:45,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:52:45,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:52:45,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:52:45,224 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:52:45,224 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:52:45,291 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:52:45,292 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:53:10,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:53:10,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:53:10,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:53:10,761 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:53:10,761 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 04:53:10,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:53:10,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:53:10,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:53:10,762 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 04:53:10,762 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 04:53:10,774 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 04:53:10,774 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:53:10,775 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 04:54:26,355 - INFO - app.core.security - Closing Redis connection...
2025-06-10 04:54:26,356 - INFO - app.core.security - Redis connection closed.
2025-06-10 04:59:31,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 04:59:31,908 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 04:59:32,072 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 04:59:32,072 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 04:59:32,072 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 04:59:32,072 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 29, 32, 72627), 'iat': datetime.datetime(2025, 6, 10, 11, 59, 32, 72632)}
2025-06-10 04:59:32,073 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1ODU3MiwiaWF0IjoxNzQ5NTU2NzcyfQ.Nv1O5cDVTQNUuGauuOGU1Bge4ccimBu_vaaAEyz2jHE

2025-06-10 04:59:43,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 04:59:43,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 04:59:43,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:00,012 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:00:00,012 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:00:00,013 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:00:00,013 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 30, 0, 12521), 'iat': datetime.datetime(2025, 6, 10, 12, 0, 0, 12532)}
2025-06-10 05:00:00,013 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1ODYwMCwiaWF0IjoxNzQ5NTU2ODAwfQ.rCM--jr0TYK9BbQPxbuswWmzs199Ggo9KjGmXwPMnyQ

2025-06-10 05:00:04,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:00:04,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:00:04,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:04,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:04,380 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:00:04,390 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:00:04,390 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:00:32,550 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:00:32,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:00:32,551 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:32,551 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:32,551 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:00:32,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:00:32,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:00:32,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:32,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749556941, 'iat': 1749555141}
2025-06-10 05:00:32,552 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:00:32,559 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:00:32,559 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:00:32,560 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:03:09,609 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:03:09,610 - INFO - app.core.security - Redis connection closed.
2025-06-10 05:09:12,117 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 05:09:12,117 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 05:09:12,294 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:09:12,294 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:09:12,294 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:09:12,294 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 39, 12, 294343), 'iat': datetime.datetime(2025, 6, 10, 12, 9, 12, 294345)}
2025-06-10 05:09:12,295 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1OTE1MiwiaWF0IjoxNzQ5NTU3MzUyfQ.AUfWcPTRuGVb5t1qfjKwtmAO_ClBDAmMWyYD734iyQA

2025-06-10 05:09:19,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:09:19,211 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:09:19,212 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 05:09:23,694 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:09:23,694 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:09:23,694 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:09:23,694 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 12, 39, 23, 694497), 'iat': datetime.datetime(2025, 6, 10, 12, 9, 23, 694506)}
2025-06-10 05:09:23,695 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTkxNjMsImlhdCI6MTc0OTU1NzM2M30.rueQFPJwGnCc_RqPQvjWE_57HLD4LgryvF3zgCst5GM

2025-06-10 05:09:23,695 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNjIxNjMsImlhdCI6MTc0OTU1NzM2M30.mxqZUJXHckj4k0Qd_LZTr8cvrQiMUnCi0cmWCTkJx7c, Expiry (seconds): 604800
2025-06-10 05:09:23,697 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 05:09:34,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:09:34,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:09:34,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:09:59,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:09:59,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:09:59,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:09:59,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:09:59,657 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:09:59,668 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:09:59,669 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:10:42,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:10:42,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:10:42,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:10:42,643 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:10:42,643 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:10:42,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:10:42,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:10:42,643 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:10:42,644 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:10:42,644 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:10:42,653 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:10:42,653 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:10:42,653 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:11:06,736 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:11:06,737 - INFO - app.core.security - Redis connection closed.
2025-06-10 05:12:21,098 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 05:12:21,098 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 05:12:21,213 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:12:21,213 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:12:21,214 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:12:21,214 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 42, 21, 213777), 'iat': datetime.datetime(2025, 6, 10, 12, 12, 21, 213784)}
2025-06-10 05:12:21,214 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1OTM0MSwiaWF0IjoxNzQ5NTU3NTQxfQ.F9f8esQ7Ps7lV_Zo5LzV6qbse7dKCqrPQ7MFDzCFhIc

2025-06-10 05:12:29,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:12:29,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:12:29,339 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:12:46,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:12:46,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:12:46,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:12:46,850 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:12:46,850 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:12:46,858 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:12:46,858 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:13:07,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:13:07,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:13:07,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:13:07,771 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:13:07,771 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:13:07,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:13:07,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:13:07,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:13:07,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:13:07,773 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:13:07,789 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:13:07,789 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:13:07,790 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:13:26,185 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:13:26,185 - INFO - app.core.security - Redis connection closed.
2025-06-10 05:15:52,666 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 05:15:52,667 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 05:15:52,789 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:15:52,789 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:15:52,789 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:15:52,789 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 45, 52, 789045), 'iat': datetime.datetime(2025, 6, 10, 12, 15, 52, 789049)}
2025-06-10 05:15:52,790 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1OTU1MiwiaWF0IjoxNzQ5NTU3NzUyfQ.A7FfWbe_uw7bra321SfaGFmcd1WwsC6YUp-r7sLlN4Y

2025-06-10 05:16:30,204 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:16:30,204 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:16:30,204 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:16:30,204 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 12, 46, 30, 204086), 'iat': datetime.datetime(2025, 6, 10, 12, 16, 30, 204093)}
2025-06-10 05:16:30,205 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NTk1OTAsImlhdCI6MTc0OTU1Nzc5MH0.qi_HueA8zyqqwht67HjbLmqBXm1SxITSTdb_itwdeL4

2025-06-10 05:16:30,205 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNjI1OTAsImlhdCI6MTc0OTU1Nzc5MH0.VZcOqpy-CKZdHCPldTMFXQeUBWVsN15zMZ3Kfx5JuIg, Expiry (seconds): 604800
2025-06-10 05:16:30,205 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 05:16:40,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:16:40,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:16:40,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559590, 'iat': 1749557790}
2025-06-10 05:17:00,854 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:17:00,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:17:00,855 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:00,855 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:00,855 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:17:00,860 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:17:00,861 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:17:23,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:17:23,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:17:23,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:23,680 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:23,680 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:17:23,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:17:23,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:17:23,680 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:23,680 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:17:23,680 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:17:23,685 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:17:23,685 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:17:23,685 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:17:53,923 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:17:53,924 - INFO - app.core.security - Redis connection closed.
2025-06-10 05:20:52,109 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 05:20:52,109 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 05:20:52,231 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:20:52,231 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:20:52,231 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:20:52,231 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 12, 50, 52, 231319), 'iat': datetime.datetime(2025, 6, 10, 12, 20, 52, 231325)}
2025-06-10 05:20:52,232 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU1OTg1MiwiaWF0IjoxNzQ5NTU4MDUyfQ.FmKUYYVdBVf4DTE3sxkUGgArzp1bQ80D4442nd3qVGk

2025-06-10 05:21:12,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:21:12,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:21:12,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559590, 'iat': 1749557790}
2025-06-10 05:21:28,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:21:28,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:21:28,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:28,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:28,065 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:21:28,074 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:21:28,074 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:21:46,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:21:46,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:21:46,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:46,788 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:46,788 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:21:46,788 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:21:46,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:21:46,789 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:46,789 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559163, 'iat': 1749557363}
2025-06-10 05:21:46,789 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:21:46,811 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:21:46,811 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:21:46,811 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:27:38,503 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:27:38,505 - INFO - app.core.security - Redis connection closed.
2025-06-10 05:44:27,440 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 05:44:27,440 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 05:44:27,593 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:44:27,593 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:44:27,593 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:44:27,594 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 10, 13, 14, 27, 593910), 'iat': datetime.datetime(2025, 6, 10, 12, 44, 27, 593913)}
2025-06-10 05:44:27,595 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTU2MTI2NywiaWF0IjoxNzQ5NTU5NDY3fQ.uIFuO8vwFDOkLxvZYoldD3vKGqUppTcw_exTPSIyQZ4

2025-06-10 05:44:34,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:44:34,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:44:34,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749559590, 'iat': 1749557790}
2025-06-10 05:44:56,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:44:56,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:44:56,141 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 05:44:56,145 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-10 05:45:00,852 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 05:45:00,852 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 05:45:00,852 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 05:45:00,852 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 10, 13, 15, 0, 852475), 'iat': datetime.datetime(2025, 6, 10, 12, 45, 0, 852484)}
2025-06-10 05:45:00,853 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk1NjEzMDAsImlhdCI6MTc0OTU1OTUwMH0.hgvx8RpeeXHd4xA-_JcrUI1tQw_l_5kflqseYP0g7jA

2025-06-10 05:45:00,853 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAxNjQzMDAsImlhdCI6MTc0OTU1OTUwMH0._56KFYKju_hyGDwvp2HrsLg0xZAJH13kR1PKrGPRWII, Expiry (seconds): 604800
2025-06-10 05:45:00,854 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 05:45:17,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:45:17,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:45:17,616 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:17,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:17,617 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:45:17,638 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:45:17,639 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:45:35,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:45:35,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:45:35,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:35,967 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:35,967 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 05:45:35,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 05:45:35,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 05:45:35,968 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:35,968 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749561300, 'iat': 1749559500}
2025-06-10 05:45:35,968 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 05:45:35,973 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 05:45:35,973 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:45:35,973 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 05:45:50,793 - INFO - app.core.security - Closing Redis connection...
2025-06-10 05:45:50,794 - INFO - app.core.security - Redis connection closed.
2025-06-10 21:32:44,585 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 21:32:44,585 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 21:32:44,913 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 21:32:44,913 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 21:32:44,913 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 21:32:44,913 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 5, 2, 44, 913696), 'iat': datetime.datetime(2025, 6, 11, 4, 32, 44, 913699)}
2025-06-10 21:32:44,918 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYxODE2NCwiaWF0IjoxNzQ5NjE2MzY0fQ.oU1INdZIGDjhydY1YRwUnkCGvKByBI3_sI6pPpMUeF8

2025-06-10 21:33:41,712 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 21:33:41,712 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 21:33:41,712 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 21:33:41,712 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 5, 3, 41, 712492), 'iat': datetime.datetime(2025, 6, 11, 4, 33, 41, 712499)}
2025-06-10 21:33:41,713 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MTgyMjEsImlhdCI6MTc0OTYxNjQyMX0.3bWHWEoGgVRHxMZB2JhrEK_We42BXCc3HdAVPIvJ_04

2025-06-10 21:33:41,713 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjEyMjEsImlhdCI6MTc0OTYxNjQyMX0.vshPyxh_FdMPzsqUMZKqem-RdRbeDRgJ5bCNL7dYi_0, Expiry (seconds): 604800
2025-06-10 21:33:41,732 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 21:33:57,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:33:57,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:33:57,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749618221, 'iat': 1749616421}
2025-06-10 21:34:25,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:34:25,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:34:25,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749618221, 'iat': 1749616421}
2025-06-10 21:34:25,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749618221, 'iat': 1749616421}
2025-06-10 21:34:25,585 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 21:34:25,594 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 21:34:25,594 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 21:34:40,945 - INFO - app.core.security - Closing Redis connection...
2025-06-10 21:34:40,947 - INFO - app.core.security - Redis connection closed.
2025-06-10 21:52:33,620 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 21:52:33,620 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 21:52:33,769 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 21:52:33,769 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 21:52:33,769 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 21:52:33,769 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 5, 22, 33, 769118), 'iat': datetime.datetime(2025, 6, 11, 4, 52, 33, 769122)}
2025-06-10 21:52:33,771 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYxOTM1MywiaWF0IjoxNzQ5NjE3NTUzfQ.XPer5IGAsyn9Si0QucoO1EkNbrMRJIhATSiwW38Woxg

2025-06-10 21:52:39,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 21:52:39,696 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 21:52:39,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 21:52:39,696 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 5, 22, 39, 695952), 'iat': datetime.datetime(2025, 6, 11, 4, 52, 39, 695962)}
2025-06-10 21:52:39,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MTkzNTksImlhdCI6MTc0OTYxNzU1OX0.m0IxQak8HrpMhwv2y0yYIEKDeTQPrTlk-FpjJQ_E2kg

2025-06-10 21:52:39,697 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjIzNTksImlhdCI6MTc0OTYxNzU1OX0.GZiS11JM1MPVoDhvtnOeFvgTFY809Y9-8sqbNSjPu4w, Expiry (seconds): 604800
2025-06-10 21:52:39,698 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 21:52:56,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:52:56,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:52:56,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:55:50,001 - INFO - app.core.security - Closing Redis connection...
2025-06-10 21:55:50,002 - INFO - app.core.security - Redis connection closed.
2025-06-10 21:55:54,640 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 21:55:54,640 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 21:55:54,741 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 21:55:54,741 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 21:55:54,741 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 21:55:54,741 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 5, 25, 54, 741583), 'iat': datetime.datetime(2025, 6, 11, 4, 55, 54, 741586)}
2025-06-10 21:55:54,742 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYxOTU1NCwiaWF0IjoxNzQ5NjE3NzU0fQ.Ke3sRq5cf0YJ4PDzA0WddWroXYRN65XndT2nhnyX6YI

2025-06-10 21:56:06,805 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:56:06,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:56:06,806 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:56:23,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:56:23,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:56:23,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:56:23,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:56:23,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 21:56:23,526 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 21:56:23,526 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 21:57:03,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:57:03,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:57:03,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:57:03,301 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:57:03,302 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 21:57:03,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 21:57:03,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 21:57:03,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:57:03,302 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 21:57:03,302 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 21:57:03,308 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 21:57:03,309 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 21:57:03,309 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 21:58:35,865 - INFO - app.core.security - Closing Redis connection...
2025-06-10 21:58:35,866 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:08:08,299 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:08:08,299 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:08:08,459 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:08:08,459 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:08:08,459 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:08:08,459 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 5, 38, 8, 459177), 'iat': datetime.datetime(2025, 6, 11, 5, 8, 8, 459183)}
2025-06-10 22:08:08,460 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMDI4OCwiaWF0IjoxNzQ5NjE4NDg4fQ.zm_A9DxKvkO0NLgbrdFzf3qscoea7-aAflhN9F-lLG8

2025-06-10 22:08:17,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:08:17,131 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:08:17,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:29,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:08:29,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:08:29,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:29,338 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:29,338 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:08:29,350 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:08:29,350 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:08:46,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:08:46,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:08:46,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:46,066 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:46,067 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-10 22:08:46,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:08:46,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:08:46,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:46,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:08:46,068 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:08:46,170 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:08:46,170 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:08:46,170 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:10:23,773 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:10:23,774 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:10:23,774 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:10:23,774 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 5, 40, 23, 773910), 'iat': datetime.datetime(2025, 6, 11, 5, 10, 23, 773917)}
2025-06-10 22:10:23,775 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MjA0MjMsImlhdCI6MTc0OTYxODYyM30.BebgwFtOLGN0cz_GzAsphwLZWHLkEk6TGj67Y1jySFo

2025-06-10 22:10:23,775 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjM0MjMsImlhdCI6MTc0OTYxODYyM30.WmPxzpMtHr_XD81Bv2zFTMXba7H1XzvkYzYVlcPR8-U, Expiry (seconds): 604800
2025-06-10 22:10:23,777 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 22:10:36,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:10:36,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:10:36,610 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:10:36,610 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:10:36,610 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:10:36,639 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:10:36,640 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:11:36,475 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:11:36,476 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:18:53,179 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:18:53,179 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:18:53,294 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:18:53,294 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:18:53,294 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:18:53,294 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 5, 48, 53, 293973), 'iat': datetime.datetime(2025, 6, 11, 5, 18, 53, 293977)}
2025-06-10 22:18:53,294 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMDkzMywiaWF0IjoxNzQ5NjE5MTMzfQ.nNh75Vhc5K0322UqxNmsnGOrH7vUVYGvcbXIujwKvV4

2025-06-10 22:19:00,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:19:00,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:19:00,027 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749619359, 'iat': 1749617559}
2025-06-10 22:19:08,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:19:08,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:19:08,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:08,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:08,435 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:19:08,451 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:19:08,452 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:19:16,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:19:16,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:19:16,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:16,690 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:16,690 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:19:16,697 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:19:16,697 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:19:25,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:19:25,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:19:25,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:25,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:19:25,913 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:19:25,917 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:19:25,917 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:27:43,407 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:27:43,408 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:31:52,342 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:31:52,342 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:31:52,643 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:31:52,644 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:31:52,644 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:31:52,644 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 1, 52, 643947), 'iat': datetime.datetime(2025, 6, 11, 5, 31, 52, 643953)}
2025-06-10 22:31:52,645 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMTcxMiwiaWF0IjoxNzQ5NjE5OTEyfQ.OvJeKcizYFMr9CgYIoFSgK_ok_JTI87qR-eD7BcLIIw

2025-06-10 22:31:58,987 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:31:58,988 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:32:03,389 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:32:03,389 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:32:03,515 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:32:03,515 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:32:03,515 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:32:03,515 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 2, 3, 515652), 'iat': datetime.datetime(2025, 6, 11, 5, 32, 3, 515657)}
2025-06-10 22:32:03,517 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMTcyMywiaWF0IjoxNzQ5NjE5OTIzfQ.KiU6vTDwtT9UV7qJiYncFTFfDttcrnityaxRx3YUMCU

2025-06-10 22:32:19,663 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:32:19,664 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:32:20,609 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:32:20,610 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:32:20,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:32:20,713 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:32:20,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:32:20,713 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 2, 20, 713658), 'iat': datetime.datetime(2025, 6, 11, 5, 32, 20, 713662)}
2025-06-10 22:32:20,714 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMTc0MCwiaWF0IjoxNzQ5NjE5OTQwfQ.xzV6QDxnia2tO57rNMd8RsckAnU0_5Nhce6ESt4R85Y

2025-06-10 22:32:21,858 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:32:21,858 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:32:21,979 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:32:21,979 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:32:21,979 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:32:21,979 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 2, 21, 979092), 'iat': datetime.datetime(2025, 6, 11, 5, 32, 21, 979095)}
2025-06-10 22:32:21,979 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMTc0MSwiaWF0IjoxNzQ5NjE5OTQxfQ.hlG9es7Q2UV5cK5s4ZFAvjnc4hniD2egenZAnbHhI2c

2025-06-10 22:32:35,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:32:35,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:32:35,258 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 22:32:45,285 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:32:45,285 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:32:45,285 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:32:45,286 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 6, 2, 45, 285315), 'iat': datetime.datetime(2025, 6, 11, 5, 32, 45, 285326)}
2025-06-10 22:32:45,286 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MjE3NjUsImlhdCI6MTc0OTYxOTk2NX0.OJ28-X3w0t4SRsdxzmHBGCnu_9ml0_Oq7KSSYPI-wPY

2025-06-10 22:32:45,286 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjQ3NjUsImlhdCI6MTc0OTYxOTk2NX0.-EwXuAoMYuV6lp8p-5Nr2KzZ-tlH4FCgCcdKh0q6-x4, Expiry (seconds): 604800
2025-06-10 22:32:45,290 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 22:32:55,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:32:55,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:32:55,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749621765, 'iat': 1749619965}
2025-06-10 22:34:32,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:34:32,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:34:32,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:34:32,428 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:34:32,428 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:34:32,454 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:34:32,457 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:34:45,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:34:45,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:34:45,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:34:45,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749620423, 'iat': 1749618623}
2025-06-10 22:34:45,649 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:34:45,661 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:34:45,661 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:36:41,818 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:36:41,820 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:46:42,056 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:46:42,056 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:46:42,220 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:46:42,220 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:46:42,220 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:46:42,220 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 16, 42, 220437), 'iat': datetime.datetime(2025, 6, 11, 5, 46, 42, 220442)}
2025-06-10 22:46:42,221 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMjYwMiwiaWF0IjoxNzQ5NjIwODAyfQ.z8nmUj0I8EGveh2XjjwU22ErvXA19Tc64L7NmPXdu6E

2025-06-10 22:47:22,413 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:47:22,413 - INFO - app.core.security - Redis connection closed.
2025-06-10 22:47:24,359 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 22:47:24,359 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 22:47:24,497 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:47:24,497 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:47:24,497 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:47:24,497 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 17, 24, 496973), 'iat': datetime.datetime(2025, 6, 11, 5, 47, 24, 496978)}
2025-06-10 22:47:24,497 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyMjY0NCwiaWF0IjoxNzQ5NjIwODQ0fQ.2QJDGdCmITBrrM7r-l943RluyBNwljo3dWhrCMdEymM

2025-06-10 22:48:05,444 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 22:48:05,445 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 22:48:05,445 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 22:48:05,445 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 6, 18, 5, 444931), 'iat': datetime.datetime(2025, 6, 11, 5, 48, 5, 444943)}
2025-06-10 22:48:05,446 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MjI2ODUsImlhdCI6MTc0OTYyMDg4NX0.FN_xX0OhVRAadbm5j_jgYDxGET10rN8pdj3h1iMSj74

2025-06-10 22:48:05,446 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjU2ODUsImlhdCI6MTc0OTYyMDg4NX0.H2lX6OjdfBBwqFEPzux3O27wL61sbcAx7ovHMkLFMik, Expiry (seconds): 604800
2025-06-10 22:48:05,447 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 22:50:00,009 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:50:00,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:50:00,013 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749621765, 'iat': 1749619965}
2025-06-10 22:50:50,989 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:50:50,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:50:50,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:50:50,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:50:50,990 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:50:50,997 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:50:50,997 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:52:46,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:52:46,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:52:46,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:52:46,110 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:52:46,111 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:52:46,122 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:52:46,123 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:53:13,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 22:53:13,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 22:53:13,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:53:13,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749622685, 'iat': 1749620885}
2025-06-10 22:53:13,203 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 22:53:13,210 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 22:53:13,210 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 22:54:13,958 - INFO - app.core.security - Closing Redis connection...
2025-06-10 22:54:13,959 - INFO - app.core.security - Redis connection closed.
2025-06-10 23:25:06,648 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-10 23:25:06,649 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-10 23:25:06,844 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 23:25:06,844 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 23:25:06,844 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 23:25:06,844 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 6, 55, 6, 844655), 'iat': datetime.datetime(2025, 6, 11, 6, 25, 6, 844659)}
2025-06-10 23:25:06,846 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyNDkwNiwiaWF0IjoxNzQ5NjIzMTA2fQ.DwCnl_XGC7RMw4o9bpKvAlPK79GWqr9YE3DiUIlgeU4

2025-06-10 23:25:09,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:25:09,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:25:09,705 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-10 23:25:21,108 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 23:25:21,108 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 23:25:21,108 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 23:25:21,108 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 6, 55, 21, 108403), 'iat': datetime.datetime(2025, 6, 11, 6, 25, 21, 108412)}
2025-06-10 23:25:21,109 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2MjQ5MjEsImlhdCI6MTc0OTYyMzEyMX0.BSuCUGtt8UDJiI80aHDF_FJO2_0qRY5b1He3Knr2s-g

2025-06-10 23:25:21,109 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyMjc5MjEsImlhdCI6MTc0OTYyMzEyMX0.A-82-4jFe4KkQEpw5JIea0mHXsseCd7J4lAFqLVugPY, Expiry (seconds): 604800
2025-06-10 23:25:21,124 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-10 23:25:31,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:25:31,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:25:31,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749624921, 'iat': 1749623121}
2025-06-10 23:25:50,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:25:50,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:25:50,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749624921, 'iat': 1749623121}
2025-06-10 23:25:50,692 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749624921, 'iat': 1749623121}
2025-06-10 23:25:50,692 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-10 23:25:50,705 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-10 23:25:50,705 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-10 23:29:52,544 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 23:29:52,544 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 23:29:52,544 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 23:29:52,544 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 6, 59, 52, 544088), 'iat': datetime.datetime(2025, 6, 11, 6, 29, 52, 544098)}
2025-06-10 23:29:52,545 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2MjUxOTIsImlhdCI6MTc0OTYyMzM5Mn0.m40oTHIs0bBCGT_S5AclW6pTUlp805CJ8aCtdDEaS6I

2025-06-10 23:29:52,545 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyMjgxOTIsImlhdCI6MTc0OTYyMzM5Mn0.w33eqcepbQtj39kJyMLpyou-BGUMQgJtE7NTEdAGVyg, Expiry (seconds): 604800
2025-06-10 23:29:52,546 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-10 23:30:00,007 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 23:30:00,007 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 23:30:00,007 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 23:30:00,007 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 7, 0, 0, 7528), 'iat': datetime.datetime(2025, 6, 11, 6, 30, 0, 7535)}
2025-06-10 23:30:00,008 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyNTIwMCwiaWF0IjoxNzQ5NjIzNDAwfQ.f0ZFdqM9trotfOQ6vNFSDTXWMFLaLqiemC8Tt88-dK4

2025-06-10 23:30:22,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:30:22,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:30:22,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:30:22,922 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:30:22,922 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-10 23:30:22,982 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-10 23:30:22,983 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-10 23:32:19,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:32:19,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:32:19,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:32:19,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:32:19,656 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-10 23:32:19,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-10 23:32:19,661 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-10 23:32:38,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:32:38,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:32:38,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:32:38,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:32:38,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-10 23:32:38,590 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-10 23:32:38,590 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-10 23:35:42,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:35:42,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:35:42,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:35:42,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625192, 'iat': 1749623392}
2025-06-10 23:35:42,293 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-10 23:35:42,299 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-10 23:35:42,299 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-10 23:36:01,544 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-10 23:36:01,544 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-10 23:36:01,544 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-10 23:36:01,544 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 7, 6, 1, 544504), 'iat': datetime.datetime(2025, 6, 11, 6, 36, 1, 544512)}
2025-06-10 23:36:01,545 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2MjU1NjEsImlhdCI6MTc0OTYyMzc2MX0.pKl4ZYvWToHet0KrypxgR6xQ_J9Mf7ed_ByELS9OoH4

2025-06-10 23:36:01,545 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyMjg1NjEsImlhdCI6MTc0OTYyMzc2MX0.mZ3VpcUc77PCZ-ziP_uqsiYAKUf5KLrZNulBZ6CWy8Q, Expiry (seconds): 604800
2025-06-10 23:36:01,546 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-10 23:36:16,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-10 23:36:16,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-10 23:36:16,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625561, 'iat': 1749623761}
2025-06-10 23:36:16,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749625561, 'iat': 1749623761}
2025-06-10 23:36:16,520 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-10 23:36:16,528 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-10 23:36:16,529 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 00:00:00,035 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:00:00,035 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:00:00,035 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:00:00,035 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 7, 30, 0, 35230), 'iat': datetime.datetime(2025, 6, 11, 7, 0, 0, 35234)}
2025-06-11 00:00:00,035 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyNzAwMCwiaWF0IjoxNzQ5NjI1MjAwfQ.Kz6vPVrUI53xZRYHCIfAtnmQXSRs5wHegft5fgkkjWk

2025-06-11 00:02:21,945 - INFO - app.core.security - Closing Redis connection...
2025-06-11 00:02:21,951 - INFO - app.core.security - Redis connection closed.
2025-06-11 00:23:36,117 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 00:23:36,117 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 00:23:36,334 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:23:36,334 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:23:36,335 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:23:36,335 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 7, 53, 36, 334774), 'iat': datetime.datetime(2025, 6, 11, 7, 23, 36, 334782)}
2025-06-11 00:23:36,338 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyODQxNiwiaWF0IjoxNzQ5NjI2NjE2fQ.dVMWlvJlkJRCXAp_WGewYT4Kd3Qx2EjaeTmEbG0HA60

2025-06-11 00:24:11,083 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:24:11,083 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:24:11,083 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:24:11,084 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 7, 54, 11, 83106), 'iat': datetime.datetime(2025, 6, 11, 7, 24, 11, 83121)}
2025-06-11 00:24:11,084 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2Mjg0NTEsImlhdCI6MTc0OTYyNjY1MX0.SjwNPjH81TYb37AX0lTZnFcpLkBLf8I2TWG0C3dBU1g

2025-06-11 00:24:11,085 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyMzE0NTEsImlhdCI6MTc0OTYyNjY1MX0.7ZbviWriE0cs2u5STFx9OZRJkJSyfoI0DN5c1EdLenQ, Expiry (seconds): 604800
2025-06-11 00:24:11,087 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 00:25:03,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 00:25:03,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 00:25:03,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:25:03,812 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:25:03,812 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 00:25:03,830 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 00:25:03,831 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 00:25:03,831 - WARNING - app.core.security - User ID 4 attempted to access admin resource without admin privileges.
2025-06-11 00:26:39,589 - INFO - app.core.security - Closing Redis connection...
2025-06-11 00:26:39,590 - INFO - app.core.security - Redis connection closed.
2025-06-11 00:29:19,814 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 00:29:19,814 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 00:29:20,000 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:29:20,001 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:29:20,001 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:29:20,001 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 7, 59, 20, 848), 'iat': datetime.datetime(2025, 6, 11, 7, 29, 20, 859)}
2025-06-11 00:29:20,002 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyODc2MCwiaWF0IjoxNzQ5NjI2OTYwfQ.Suaxp7xLdOyLkm-E3FNGgxOa4FnatwSS89JlrcKQcrw

2025-06-11 00:30:00,004 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:30:00,005 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:30:00,005 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:30:00,005 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 8, 0, 0, 4653), 'iat': datetime.datetime(2025, 6, 11, 7, 30, 0, 4668)}
2025-06-11 00:30:00,006 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyODgwMCwiaWF0IjoxNzQ5NjI3MDAwfQ.tiJ1x8YR6y1W6alLvrJ02WqJanZu8vBrTrKt7iqiua0

2025-06-11 00:30:34,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 00:30:34,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 00:30:34,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:30:34,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:30:34,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 00:30:34,730 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 00:30:34,730 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 00:31:30,293 - INFO - app.core.security - Closing Redis connection...
2025-06-11 00:31:30,293 - INFO - app.core.security - Redis connection closed.
2025-06-11 00:31:34,066 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 00:31:34,066 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 00:31:34,319 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:31:34,319 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:31:34,319 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:31:34,320 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 8, 1, 34, 319641), 'iat': datetime.datetime(2025, 6, 11, 7, 31, 34, 319647)}
2025-06-11 00:31:34,321 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyODg5NCwiaWF0IjoxNzQ5NjI3MDk0fQ.4AR-Qlntj7W1lT5kF9TqIxwFS8JFcEklsoYs1u7yuEY

2025-06-11 00:31:41,872 - INFO - app.core.security - Closing Redis connection...
2025-06-11 00:31:41,873 - INFO - app.core.security - Redis connection closed.
2025-06-11 00:33:37,322 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 00:33:37,323 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 00:33:37,577 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 00:33:37,577 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 00:33:37,578 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 00:33:37,578 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 8, 3, 37, 577581), 'iat': datetime.datetime(2025, 6, 11, 7, 33, 37, 577594)}
2025-06-11 00:33:37,579 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTYyOTAxNywiaWF0IjoxNzQ5NjI3MjE3fQ.8HvX7y38cfVeZLwkdoP_ejulc32uR-ROcEG3KVVcXp0

2025-06-11 00:33:42,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 00:33:42,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 00:33:42,358 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:33:42,358 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749628451, 'iat': 1749626651}
2025-06-11 00:33:42,359 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 00:33:42,592 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 00:33:42,592 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 00:34:44,124 - INFO - app.core.security - Closing Redis connection...
2025-06-11 00:34:44,125 - INFO - app.core.security - Redis connection closed.
2025-06-11 04:37:57,521 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 04:37:57,522 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 04:37:57,657 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 04:37:57,657 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 04:37:57,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 04:37:57,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 7, 57, 657932), 'iat': datetime.datetime(2025, 6, 11, 11, 37, 57, 657935)}
2025-06-11 04:37:57,658 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0MzY3NywiaWF0IjoxNzQ5NjQxODc3fQ.QLs30HLJ2oF6wL9kZ-l9y0To12oeAG8Pzy-OhHok14A

2025-06-11 04:38:04,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:04,646 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:04,647 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:10,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:10,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:10,686 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:17,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:17,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:17,069 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:22,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:22,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:22,589 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:28,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:28,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:28,708 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:34,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:34,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:34,595 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:40,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:40,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:40,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:46,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:38:46,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:38:46,636 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:38:51,445 - INFO - app.core.security - Closing Redis connection...
2025-06-11 04:38:51,447 - INFO - app.core.security - Redis connection closed.
2025-06-11 04:40:31,594 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 04:40:31,595 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 04:40:31,741 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 04:40:31,741 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 04:40:31,742 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 04:40:31,742 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 10, 31, 741711), 'iat': datetime.datetime(2025, 6, 11, 11, 40, 31, 741719)}
2025-06-11 04:40:31,742 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0MzgzMSwiaWF0IjoxNzQ5NjQyMDMxfQ.wbmsgI6pCuG1THeRypkWbWlckrbVT4kfjI6o0WJSeR4

2025-06-11 04:40:35,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:35,182 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:35,182 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:40:40,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:40,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:40,598 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:40:46,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:46,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:46,649 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:40:50,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:50,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:50,776 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749643419, 'iat': 1749641619}
2025-06-11 04:40:50,776 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749643419, 'iat': 1749641619}
2025-06-11 04:40:50,776 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 04:40:50,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 04:40:50,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 04:40:52,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:52,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:52,613 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:40:58,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:40:58,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:40:58,720 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:04,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:04,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:04,576 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:10,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:10,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:10,642 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:16,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:16,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:16,580 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:22,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:22,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:22,936 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:28,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:28,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:28,594 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:34,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:34,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:34,595 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:42,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:42,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:42,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:48,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:48,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:48,512 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:54,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:41:54,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:41:54,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:41:56,248 - INFO - app.core.security - Closing Redis connection...
2025-06-11 04:41:56,248 - INFO - app.core.security - Redis connection closed.
2025-06-11 04:42:11,316 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 04:42:11,316 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 04:42:11,422 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 04:42:11,422 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 04:42:11,422 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 04:42:11,422 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 12, 11, 422486), 'iat': datetime.datetime(2025, 6, 11, 11, 42, 11, 422490)}
2025-06-11 04:42:11,423 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0MzkzMSwiaWF0IjoxNzQ5NjQyMTMxfQ.tY0Q6nMRoxNGK919fbPzkVpPROmMU4z3Le6Cb2fDuak

2025-06-11 04:42:14,568 - INFO - app.core.security - Closing Redis connection...
2025-06-11 04:42:14,568 - INFO - app.core.security - Redis connection closed.
2025-06-11 04:50:49,326 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 04:50:49,326 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 04:50:49,454 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 04:50:49,454 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 04:50:49,454 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 04:50:49,454 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 20, 49, 454475), 'iat': datetime.datetime(2025, 6, 11, 11, 50, 49, 454478)}
2025-06-11 04:50:49,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NDQ0OSwiaWF0IjoxNzQ5NjQyNjQ5fQ.PPlkBb_rMfBevRUYbv_hJimfgljrAokvYu-fw5cmDzE

2025-06-11 04:50:55,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:50:55,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:50:55,716 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:01,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:01,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:01,642 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:07,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:07,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:07,611 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:13,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:13,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:13,582 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:19,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:19,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:19,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:25,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:25,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:25,711 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:31,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:31,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:31,661 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:37,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:37,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:37,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:43,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:43,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:43,651 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:49,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:49,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:49,595 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:51:55,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:51:55,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:51:55,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:01,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:01,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:01,662 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:07,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:07,019 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:07,019 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:12,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:12,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:12,417 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:17,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:17,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:17,740 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:23,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:23,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:23,102 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:26,652 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 04:52:26,652 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 04:52:26,652 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 04:52:26,652 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 12, 22, 26, 652329), 'iat': datetime.datetime(2025, 6, 11, 11, 52, 26, 652335)}
2025-06-11 04:52:26,653 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2NDQ1NDYsImlhdCI6MTc0OTY0Mjc0Nn0.mFnls_u8zixLy1zhvwJ0Jd7fy1Bw95IZjuiuzpMqbWw

2025-06-11 04:52:26,653 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyNDc1NDYsImlhdCI6MTc0OTY0Mjc0Nn0.WWZ3mvRdOg1eGbK1LPyuY2d0imZMLqAmCVGlt2oO8R4, Expiry (seconds): 604800
2025-06-11 04:52:26,656 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-11 04:52:28,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:28,573 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:28,574 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:34,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:34,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:34,036 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:52:37,753 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:52:37,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:52:37,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 04:52:37,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 04:52:37,754 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 04:52:37,764 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 04:52:37,765 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 04:54:30,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:54:30,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:54:30,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 04:54:30,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 04:54:30,030 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 04:54:30,035 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 04:54:30,035 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 04:58:39,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:58:39,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:58:39,109 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:58:45,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:58:45,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:58:45,598 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:58:51,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:58:51,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:58:51,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:58:57,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:58:57,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:58:57,674 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:03,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:03,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:03,747 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:09,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:09,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:09,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:15,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:15,551 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:15,552 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:21,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:21,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:21,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:27,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:27,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:27,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:33,644 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:33,644 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:33,645 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:39,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:39,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:39,836 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:45,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:45,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:45,726 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:51,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:51,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:51,661 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 04:59:57,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 04:59:57,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 04:59:57,748 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:00,008 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:00:00,008 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:00:00,008 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:00:00,008 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 30, 0, 8455), 'iat': datetime.datetime(2025, 6, 11, 12, 0, 0, 8460)}
2025-06-11 05:00:00,009 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTAwMCwiaWF0IjoxNzQ5NjQzMjAwfQ.4RXONLKnTR6tkdSnOVMHGGRhnuX5JkuqprqXmlgR0bA

2025-06-11 05:00:04,474 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:04,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:04,474 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:10,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:10,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:10,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:16,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:16,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:16,568 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:22,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:22,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:22,501 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:24,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:24,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:24,648 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:25,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:25,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:25,890 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:32,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:32,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:32,565 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:38,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:38,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:38,643 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:44,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:44,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:44,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:50,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:50,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:50,260 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:00:52,454 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:00:52,455 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:00:52,457 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 05:00:58,638 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:00:58,638 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:00:58,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:00:58,638 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 11, 12, 30, 58, 638614), 'iat': datetime.datetime(2025, 6, 11, 12, 0, 58, 638617)}
2025-06-11 05:00:58,638 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk2NDUwNTgsImlhdCI6MTc0OTY0MzI1OH0.LtEbloZo11rnWdnIq53RUy04FlB4X1AVjzBJliNc7Oo

2025-06-11 05:00:58,639 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAyNDgwNTgsImlhdCI6MTc0OTY0MzI1OH0.DU2isg2bW3e71Rew2kfN3CHqogTDnMeH7BxX_8NlBAM, Expiry (seconds): 604800
2025-06-11 05:00:58,642 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-11 05:01:00,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:01:00,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:01:00,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:01:54,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:01:54,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:01:54,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:02:33,989 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:02:33,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:02:33,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:02:36,943 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:02:36,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:02:36,943 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:02:59,951 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:02:59,952 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:03:02,369 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:03:02,369 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:03:02,428 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:03:02,428 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:03:02,428 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:03:02,428 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 33, 2, 428802), 'iat': datetime.datetime(2025, 6, 11, 12, 3, 2, 428804)}
2025-06-11 05:03:02,429 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTE4MiwiaWF0IjoxNzQ5NjQzMzgyfQ.OI4JBsKxnDsRBWiytPVSSlb5bsycw6yPU-a1cSEVk3g

2025-06-11 05:03:06,571 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:03:06,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:03:06,572 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:03:09,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:03:09,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:03:09,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:03:51,830 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:03:51,830 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:03:51,830 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:03:57,709 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:03:57,709 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:04:00,022 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:04:00,023 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:04:00,108 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:04:00,108 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:04:00,108 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:04:00,108 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 34, 0, 108069), 'iat': datetime.datetime(2025, 6, 11, 12, 4, 0, 108072)}
2025-06-11 05:04:00,108 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTI0MCwiaWF0IjoxNzQ5NjQzNDQwfQ.BqBH-95GubbtItsqCOm7gyO2pzr5ZYJkIq4YILwdU1A

2025-06-11 05:04:01,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:04:01,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:04:01,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:04:25,439 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:04:25,439 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:04:25,439 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:04:25,439 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 12, 34, 25, 439191), 'iat': datetime.datetime(2025, 6, 11, 12, 4, 25, 439198)}
2025-06-11 05:04:25,439 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDUyNjUsImlhdCI6MTc0OTY0MzQ2NX0.MKmxDYD3f-_Gx3wJz6Nh_VAGrt3D5BE3u1UlrRzhonQ

2025-06-11 05:04:25,440 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNDgyNjUsImlhdCI6MTc0OTY0MzQ2NX0.Uef-xi5xBVwjn63EJhYyYL-X_QMtlmdtScSZZGD830g, Expiry (seconds): 604800
2025-06-11 05:04:25,441 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:04:29,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:04:29,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:04:29,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:04:37,271 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:04:37,271 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:04:37,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:04:41,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:04:41,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:04:41,513 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:06:51,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:06:51,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:06:51,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:07:18,699 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:07:18,700 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:07:20,808 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:07:20,808 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:07:20,902 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:07:20,902 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:07:20,902 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:07:20,902 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 37, 20, 902280), 'iat': datetime.datetime(2025, 6, 11, 12, 7, 20, 902283)}
2025-06-11 05:07:20,902 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTQ0MCwiaWF0IjoxNzQ5NjQzNjQwfQ.4HiO6p46BjiecsPCRVyXWQjvgtdXDdRNFeazWYPoU30

2025-06-11 05:07:23,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:07:23,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:07:23,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:08:07,137 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:08:07,138 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:08:09,119 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:08:09,119 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:08:09,206 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:08:09,206 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:08:09,206 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:08:09,207 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 38, 9, 206897), 'iat': datetime.datetime(2025, 6, 11, 12, 8, 9, 206900)}
2025-06-11 05:08:09,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTQ4OSwiaWF0IjoxNzQ5NjQzNjg5fQ.icjl3owKsA0BqCTno4YHcuORbuvP5l_2_YWZmisz_AA

2025-06-11 05:08:11,625 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:08:11,627 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:08:11,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:08:11,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:08:11,636 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:08:13,460 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:08:13,461 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:08:13,549 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:08:13,549 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:08:13,549 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:08:13,549 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 38, 13, 549068), 'iat': datetime.datetime(2025, 6, 11, 12, 8, 13, 549071)}
2025-06-11 05:08:13,549 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NTQ5MywiaWF0IjoxNzQ5NjQzNjkzfQ.l2YVIgcMDV5ztc8ru_CcB5a4YtjtHoMPTekPHKq4K5o

2025-06-11 05:08:17,704 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:08:17,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:08:17,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:08:20,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:08:20,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:08:20,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:08:20,492 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:08:20,493 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:08:20,512 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:08:20,513 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:09:39,817 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:09:39,818 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:17:10,168 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:17:10,168 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:17:10,269 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:17:10,269 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:17:10,269 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:17:10,269 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 47, 10, 269638), 'iat': datetime.datetime(2025, 6, 11, 12, 17, 10, 269649)}
2025-06-11 05:17:10,271 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjAzMCwiaWF0IjoxNzQ5NjQ0MjMwfQ.yteKkztwJlGnXQ_m70qcdffeagozlr5K2eqK1985jWI

2025-06-11 05:17:20,057 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:17:20,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:17:20,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 05:17:20,058 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749644546, 'iat': 1749642746}
2025-06-11 05:17:20,058 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 05:17:20,153 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 05:17:20,153 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 05:17:47,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:17:47,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:17:47,031 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:17:47,032 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:17:47,032 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:17:47,054 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:17:47,055 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:17:52,669 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:17:52,669 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:17:52,669 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:17:52,669 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 12, 47, 52, 669458), 'iat': datetime.datetime(2025, 6, 11, 12, 17, 52, 669466)}
2025-06-11 05:17:52,670 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDYwNzIsImlhdCI6MTc0OTY0NDI3Mn0.Tm4JB95c9-3MN1K99USKPzs0SzR_NLTT-EN5mHvnccw

2025-06-11 05:17:52,670 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNDkwNzIsImlhdCI6MTc0OTY0NDI3Mn0.r6VMm3J-VhGKLgNCmEr5IhU2TPZqS0Fr2SeGXQ97qfY, Expiry (seconds): 604800
2025-06-11 05:17:52,671 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:18:01,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:18:01,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:18:01,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:18:01,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:18:01,670 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:18:01,686 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:18:01,686 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:19:39,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:19:39,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:19:39,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:19:56,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:19:56,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:19:56,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:19:56,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:19:56,126 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:19:56,238 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:19:56,241 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:20:16,964 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:20:16,966 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:20:19,606 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:20:19,607 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:20:19,720 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:20:19,721 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:20:19,721 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:20:19,721 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 50, 19, 720926), 'iat': datetime.datetime(2025, 6, 11, 12, 20, 19, 720933)}
2025-06-11 05:20:19,722 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjIxOSwiaWF0IjoxNzQ5NjQ0NDE5fQ.L_eTtTNQvIG-CXb_jssRoanpX4nLPn3hRNqIyIpQFr8

2025-06-11 05:20:21,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:20:21,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:20:21,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:20:40,068 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:20:40,069 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:20:42,039 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:20:42,039 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:20:42,132 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:20:42,132 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:20:42,132 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:20:42,132 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 50, 42, 132643), 'iat': datetime.datetime(2025, 6, 11, 12, 20, 42, 132645)}
2025-06-11 05:20:42,133 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjI0MiwiaWF0IjoxNzQ5NjQ0NDQyfQ.Yx5icA_cnDqHZ9vhm0f1mawO9XLKas9tMUu76dxAXn4

2025-06-11 05:20:44,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:20:44,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:20:44,828 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:20:46,417 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:20:46,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:20:46,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:20:46,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:20:46,418 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:20:46,436 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:20:46,436 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:20:58,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:20:58,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:20:58,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:20:58,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:20:58,847 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:20:58,850 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:20:58,850 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:21:03,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:21:03,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:21:03,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:21:03,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:21:03,515 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:21:03,531 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:21:03,531 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:21:23,994 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:21:23,995 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:21:25,902 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:21:25,902 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:21:26,001 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:21:26,001 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:21:26,001 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:21:26,001 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 51, 26, 1591), 'iat': datetime.datetime(2025, 6, 11, 12, 21, 26, 1596)}
2025-06-11 05:21:26,002 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjI4NiwiaWF0IjoxNzQ5NjQ0NDg2fQ.yuEkfHqk_KTXarXWFkFa1XDhiuYYNL0Ua9GYiCZaGPM

2025-06-11 05:21:27,650 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:21:27,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:21:27,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:21:31,116 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:21:31,116 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:21:31,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:21:31,118 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749645265, 'iat': 1749643465}
2025-06-11 05:21:31,118 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:21:31,153 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:21:31,153 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:21:51,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:21:51,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:21:51,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:21:51,152 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:21:51,152 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:21:51,159 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:21:51,159 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:21:57,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:21:57,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:21:57,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:21:57,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646072, 'iat': 1749644272}
2025-06-11 05:21:57,255 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:21:57,263 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:21:57,263 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:22:07,927 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:22:07,928 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:22:09,827 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:22:09,827 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:22:09,924 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:22:09,924 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:22:09,924 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:22:09,924 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 52, 9, 924323), 'iat': datetime.datetime(2025, 6, 11, 12, 22, 9, 924328)}
2025-06-11 05:22:09,925 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjMyOSwiaWF0IjoxNzQ5NjQ0NTI5fQ.ML-BMiM1RAVQgdgH6Fd-J3qwHf4CJETHUQ5UDYtXknc

2025-06-11 05:22:12,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:22:12,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:22:12,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:22:51,893 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:22:51,893 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:22:51,894 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:22:51,894 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 12, 52, 51, 893511), 'iat': datetime.datetime(2025, 6, 11, 12, 22, 51, 893521)}
2025-06-11 05:22:51,894 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDYzNzEsImlhdCI6MTc0OTY0NDU3MX0.a5P2EJoMxHTd3jfqysYEaj_QbXjjoicX6hXXhbZ7xeU

2025-06-11 05:22:51,894 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNDkzNzEsImlhdCI6MTc0OTY0NDU3MX0.rNSmuxuzoOTlswYI2BxAEZMhrocOBThEmv4JdOcbHb0, Expiry (seconds): 604800
2025-06-11 05:22:51,895 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:23:10,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:23:10,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:23:10,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:23:10,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:23:10,761 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:23:10,775 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:23:10,776 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:23:41,960 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:23:41,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:23:41,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:23:41,961 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:23:41,961 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:23:41,967 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:23:41,967 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:24:20,492 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:24:20,493 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:24:22,882 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:24:22,882 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:24:22,972 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:24:22,972 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:24:22,972 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:24:22,972 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 54, 22, 972420), 'iat': datetime.datetime(2025, 6, 11, 12, 24, 22, 972425)}
2025-06-11 05:24:22,973 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjQ2MiwiaWF0IjoxNzQ5NjQ0NjYyfQ.cZixTeE1h2yFYGDVfb-IW6UQx-FJiOwB4MxdF-p1dBc

2025-06-11 05:24:25,092 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:24:25,094 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:24:27,000 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:24:27,000 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:24:27,107 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:24:27,107 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:24:27,107 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:24:27,107 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 54, 27, 107352), 'iat': datetime.datetime(2025, 6, 11, 12, 24, 27, 107355)}
2025-06-11 05:24:27,107 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjQ2NywiaWF0IjoxNzQ5NjQ0NjY3fQ.bEZk03fx6qBwyYULKMlB3pfExO0AZKWAYtGI61VlQak

2025-06-11 05:24:29,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:24:29,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:24:29,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:29,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:29,653 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:24:29,703 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:24:29,703 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:24:41,235 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:24:41,235 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:24:43,081 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:24:43,081 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:24:43,191 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:24:43,191 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:24:43,191 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:24:43,191 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 54, 43, 190998), 'iat': datetime.datetime(2025, 6, 11, 12, 24, 43, 191008)}
2025-06-11 05:24:43,192 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjQ4MywiaWF0IjoxNzQ5NjQ0NjgzfQ.tXt3szfzaTSAofFgnZVJKORe0iwQGbO45bSry5qRyhE

2025-06-11 05:24:45,813 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:24:45,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:24:45,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:24:45,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:45,816 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:45,816 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:24:45,869 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:24:45,873 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:24:45,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:24:47,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:24:47,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:24:48,058 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:24:48,058 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:24:48,058 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:24:48,058 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 54, 48, 58024), 'iat': datetime.datetime(2025, 6, 11, 12, 24, 48, 58029)}
2025-06-11 05:24:48,058 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjQ4OCwiaWF0IjoxNzQ5NjQ0Njg4fQ.xY-YRIQOQWJkFXBNQesledVmbnP9aE-TZO9COlxg4Ek

2025-06-11 05:24:53,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:24:53,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:24:53,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:53,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:24:53,976 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:24:54,048 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:24:54,049 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:25:01,993 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:25:01,994 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:25:04,282 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:25:04,282 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:25:04,373 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:25:04,373 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:25:04,373 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:25:04,374 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 55, 4, 373904), 'iat': datetime.datetime(2025, 6, 11, 12, 25, 4, 373907)}
2025-06-11 05:25:04,374 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjUwNCwiaWF0IjoxNzQ5NjQ0NzA0fQ.cv6CxMUuTUPYMi5gBZn0vP0xg1zenKngAGI3dIPB-Iw

2025-06-11 05:25:06,600 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:25:06,600 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:25:09,002 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:25:09,003 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:25:09,078 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:25:09,078 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:25:09,078 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:25:09,078 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 55, 9, 78048), 'iat': datetime.datetime(2025, 6, 11, 12, 25, 9, 78050)}
2025-06-11 05:25:09,078 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjUwOSwiaWF0IjoxNzQ5NjQ0NzA5fQ.jx7n0KBYD59t-F1xYtx_cuIO5iV40wSxFnVS_GCenYo

2025-06-11 05:25:22,849 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:25:22,849 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:25:25,039 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:25:25,039 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:25:25,162 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:25:25,163 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:25:25,163 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:25:25,163 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 55, 25, 162699), 'iat': datetime.datetime(2025, 6, 11, 12, 25, 25, 162707)}
2025-06-11 05:25:25,163 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjUyNSwiaWF0IjoxNzQ5NjQ0NzI1fQ.EcZv9S7uuOfDtkbrmqvxNPsX_ujiVhaeAeDSnui1rXo

2025-06-11 05:25:27,436 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:25:27,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:25:27,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:25:27,439 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:25:27,440 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:25:27,440 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:25:27,492 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:25:27,496 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:25:27,507 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:25:29,305 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:25:29,305 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:25:29,411 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:25:29,411 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:25:29,411 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:25:29,411 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 55, 29, 411607), 'iat': datetime.datetime(2025, 6, 11, 12, 25, 29, 411610)}
2025-06-11 05:25:29,412 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjUyOSwiaWF0IjoxNzQ5NjQ0NzI5fQ.Xx1ZdxuplfntZpeY-6GDy5zs11YQcvWQ430vE3SFpHU

2025-06-11 05:25:30,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:25:30,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:25:30,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:25:30,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:25:30,900 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:25:30,952 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:25:30,953 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:26:27,513 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:26:27,514 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:26:29,689 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:26:29,690 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:26:29,811 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:26:29,811 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:26:29,811 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:26:29,811 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 56, 29, 811432), 'iat': datetime.datetime(2025, 6, 11, 12, 26, 29, 811435)}
2025-06-11 05:26:29,811 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjU4OSwiaWF0IjoxNzQ5NjQ0Nzg5fQ.JuW6Pml9r1csU8_xyychyhauc-_preD0Rq8QXTmsP8c

2025-06-11 05:26:32,083 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:26:32,084 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:26:33,938 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:26:33,938 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:26:34,062 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:26:34,062 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:26:34,063 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:26:34,063 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 56, 34, 62684), 'iat': datetime.datetime(2025, 6, 11, 12, 26, 34, 62690)}
2025-06-11 05:26:34,064 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjU5NCwiaWF0IjoxNzQ5NjQ0Nzk0fQ.lRWzrwu19jyYBL85LY3C5ZxkXAEQcMbzjI2JG0jCTn0

2025-06-11 05:26:38,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:26:38,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:26:38,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:26:38,503 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:26:38,504 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:26:38,618 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:26:38,619 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:26:46,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:26:46,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:26:46,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:26:46,641 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:26:46,641 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:26:46,649 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:26:46,650 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:27:03,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:27:03,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:27:03,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:28:47,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:28:47,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:28:47,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:28:47,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:28:47,665 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:28:47,685 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:28:47,685 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:28:54,470 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:28:54,470 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:28:54,471 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:28:54,471 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 12, 58, 54, 470393), 'iat': datetime.datetime(2025, 6, 11, 12, 28, 54, 470406)}
2025-06-11 05:28:54,471 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDY3MzQsImlhdCI6MTc0OTY0NDkzNH0.5jtuKcQUMcUkyk2vk8iHwC4Fq3Mo_nyumuE60sHZhIY

2025-06-11 05:28:54,471 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNDk3MzQsImlhdCI6MTc0OTY0NDkzNH0.rRbsPynmuiVsH2giwcW2cd9CRqTY27TBol_opFIydp8, Expiry (seconds): 604800
2025-06-11 05:28:54,473 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:29:55,489 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:29:55,490 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:29:57,850 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:29:57,850 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:29:57,964 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:29:57,964 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:29:57,964 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:29:57,964 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 12, 59, 57, 964691), 'iat': datetime.datetime(2025, 6, 11, 12, 29, 57, 964695)}
2025-06-11 05:29:57,965 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0Njc5NywiaWF0IjoxNzQ5NjQ0OTk3fQ.OMgSQHn77BkUo0oNZpBtfwTeODw5gJqrWm4oq9QDysA

2025-06-11 05:30:00,001 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:30:00,001 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:30:00,001 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:30:00,001 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 0, 0, 1420), 'iat': datetime.datetime(2025, 6, 11, 12, 30, 0, 1423)}
2025-06-11 05:30:00,001 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjgwMCwiaWF0IjoxNzQ5NjQ1MDAwfQ.lKOPptghq1BTOgLV3obj7vucHS3ESrQq6JRVvTw6nrM

2025-06-11 05:30:00,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:00,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:00,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:30:16,222 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:30:16,222 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:30:18,370 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:30:18,370 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:30:18,455 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:30:18,455 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:30:18,455 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:30:18,455 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 0, 18, 455014), 'iat': datetime.datetime(2025, 6, 11, 12, 30, 18, 455018)}
2025-06-11 05:30:18,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjgxOCwiaWF0IjoxNzQ5NjQ1MDE4fQ.IlkD2rcfYrSdrSjwJzzdnWDFg4PZZDTXYWdCanyy-RU

2025-06-11 05:30:23,181 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:30:23,181 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:30:25,369 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:30:25,370 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:30:25,494 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:30:25,494 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:30:25,495 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:30:25,495 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 0, 25, 494828), 'iat': datetime.datetime(2025, 6, 11, 12, 30, 25, 494834)}
2025-06-11 05:30:25,495 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NjgyNSwiaWF0IjoxNzQ5NjQ1MDI1fQ.wl78fpFCLp1jggnIQu5jjbTzmUjAjbPLaP-gZF8Lg-A

2025-06-11 05:30:26,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:26,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:26,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749645058, 'iat': 1749643258}
2025-06-11 05:30:28,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:28,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:28,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:30:28,779 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646371, 'iat': 1749644571}
2025-06-11 05:30:28,779 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:30:28,785 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:30:28,785 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:30:35,252 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:30:35,252 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:30:35,253 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:30:35,253 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 13, 0, 35, 252577), 'iat': datetime.datetime(2025, 6, 11, 12, 30, 35, 252587)}
2025-06-11 05:30:35,253 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDY4MzUsImlhdCI6MTc0OTY0NTAzNX0.4Shw9Lg3OZRg5QJrfY80zpKIR-s4TWsoO5BsJU9DDYc

2025-06-11 05:30:35,254 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNDk4MzUsImlhdCI6MTc0OTY0NTAzNX0.UI5pqrnV4Z2AcjztFg7LVEGR3LiDc50jIuYFsBSO9GM, Expiry (seconds): 604800
2025-06-11 05:30:35,259 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:30:45,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:45,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:45,755 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:45,756 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:45,756 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:30:45,765 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:30:45,765 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:30:48,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:48,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:48,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:48,096 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:48,096 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:30:48,104 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:30:48,104 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:30:55,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:30:55,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:30:55,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:55,538 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:30:55,538 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:30:55,544 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:30:55,545 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:34:48,871 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:34:48,872 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:34:51,161 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:34:51,161 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:34:51,252 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:34:51,252 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:34:51,252 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:34:51,252 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 4, 51, 252335), 'iat': datetime.datetime(2025, 6, 11, 12, 34, 51, 252338)}
2025-06-11 05:34:51,253 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NzA5MSwiaWF0IjoxNzQ5NjQ1MjkxfQ.y4OVrm7px0FbteJXZajEBihNlf5XjqU0LIkp3KCnwgU

2025-06-11 05:35:55,694 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:35:55,694 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:35:57,894 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:35:57,894 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:35:57,991 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:35:57,991 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:35:57,992 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:35:57,992 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 5, 57, 991876), 'iat': datetime.datetime(2025, 6, 11, 12, 35, 57, 991882)}
2025-06-11 05:35:57,992 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0NzE1NywiaWF0IjoxNzQ5NjQ1MzU3fQ.-EMGWuESv7B37sm-KXPEwHfufE1PWCQFvwQHOZbzNRo

2025-06-11 05:36:03,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:03,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:03,223 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:36:03,227 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 05:36:06,816 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:36:06,816 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:36:06,816 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:36:06,816 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 13, 6, 6, 816364), 'iat': datetime.datetime(2025, 6, 11, 12, 36, 6, 816373)}
2025-06-11 05:36:06,817 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDcxNjYsImlhdCI6MTc0OTY0NTM2Nn0.ufvV2W900CHBgeT2a5dzjgee6AP8prylIjSf5FvFn8g

2025-06-11 05:36:06,817 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNTAxNjYsImlhdCI6MTc0OTY0NTM2Nn0.qLCSj2hr3HE_T28Qf0bbYPgwxS-33BvaV9JAOQZvIR0, Expiry (seconds): 604800
2025-06-11 05:36:06,818 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:36:21,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:21,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:21,856 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:36:21,856 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:36:21,856 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:36:21,868 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:36:21,868 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:36:27,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:27,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:27,083 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:36:32,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:32,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:32,107 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:36:32,110 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 05:36:32,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:32,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:32,330 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 05:36:38,142 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:36:38,142 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:36:38,142 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:36:38,143 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 13, 6, 38, 142431), 'iat': datetime.datetime(2025, 6, 11, 12, 36, 38, 142441)}
2025-06-11 05:36:38,143 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDcxOTgsImlhdCI6MTc0OTY0NTM5OH0.bCjxrFAJXRViRR6zRFgao_4eYA4ISQ_VENHQXh1kbC4

2025-06-11 05:36:38,143 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNTAxOTgsImlhdCI6MTc0OTY0NTM5OH0.n8ZlHJwLW-XF4-E-u9gU8Ao7z03SUKfkine2RbmofLo, Expiry (seconds): 604800
2025-06-11 05:36:38,144 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:36:40,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:36:40,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:36:40,778 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:01,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:01,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:01,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:15,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:15,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:15,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:33,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:33,822 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:33,822 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:45,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:45,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:45,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:53,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:53,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:53,996 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:37:57,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:37:57,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:37:57,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647198, 'iat': 1749645398}
2025-06-11 05:38:45,644 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:38:45,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:38:45,645 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:38:45,645 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:38:45,645 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:38:45,654 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:38:45,655 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:39:01,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:39:01,869 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:39:01,869 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:39:01,869 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:39:01,869 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:39:01,873 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:39:01,874 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:39:20,068 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:39:20,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:39:20,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:39:20,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749647166, 'iat': 1749645366}
2025-06-11 05:39:20,070 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:39:20,079 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:39:20,080 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:50:20,570 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:50:20,572 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:50:22,829 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:50:22,829 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:50:22,914 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:50:22,914 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:50:22,914 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:50:22,914 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 20, 22, 914182), 'iat': datetime.datetime(2025, 6, 11, 12, 50, 22, 914185)}
2025-06-11 05:50:22,914 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODAyMiwiaWF0IjoxNzQ5NjQ2MjIyfQ.T5gkJ651dPn5Dg_5b3xbGmijRIcw62GzCJUXJ1qnPs4

2025-06-11 05:50:52,707 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:50:52,707 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:50:55,009 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:50:55,009 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:50:55,075 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:50:55,075 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:50:55,075 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:50:55,075 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 20, 55, 75852), 'iat': datetime.datetime(2025, 6, 11, 12, 50, 55, 75854)}
2025-06-11 05:50:55,076 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODA1NSwiaWF0IjoxNzQ5NjQ2MjU1fQ.94m8tAOYSDo1gzeAS1prOcv-0NCuGH92ZeeCAb4E2CM

2025-06-11 05:51:43,304 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:51:43,305 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:51:45,959 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:51:45,959 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:51:46,028 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:51:46,028 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:51:46,028 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:51:46,028 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 21, 46, 28344), 'iat': datetime.datetime(2025, 6, 11, 12, 51, 46, 28347)}
2025-06-11 05:51:46,028 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODEwNiwiaWF0IjoxNzQ5NjQ2MzA2fQ.IMduGL3pXhLim0apWKT5IyvWbDJok7rCmNUsneGTPTY

2025-06-11 05:52:43,066 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:52:43,067 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:52:44,917 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:52:44,917 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:52:44,965 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:52:44,965 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:52:44,965 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:52:44,965 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 22, 44, 965310), 'iat': datetime.datetime(2025, 6, 11, 12, 52, 44, 965312)}
2025-06-11 05:52:44,965 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODE2NCwiaWF0IjoxNzQ5NjQ2MzY0fQ.c3XzYEEScUT1Nyz3sDt7028YsOhxVV-6WcMIDM00-WQ

2025-06-11 05:53:22,110 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:53:22,111 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:53:24,038 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:53:24,038 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:53:24,119 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:53:24,119 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:53:24,119 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:53:24,119 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 23, 24, 119146), 'iat': datetime.datetime(2025, 6, 11, 12, 53, 24, 119148)}
2025-06-11 05:53:24,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODIwNCwiaWF0IjoxNzQ5NjQ2NDA0fQ.O1E6Q_ZaojEbE8avLuP1_EDAW7OTrz9KBv00MjGLMBs

2025-06-11 05:53:54,360 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:53:54,361 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:53:56,279 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:53:56,279 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:53:56,350 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:53:56,350 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:53:56,350 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:53:56,350 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 23, 56, 350539), 'iat': datetime.datetime(2025, 6, 11, 12, 53, 56, 350542)}
2025-06-11 05:53:56,351 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODIzNiwiaWF0IjoxNzQ5NjQ2NDM2fQ.RbDEGT0MQ6lFdPQgQQcEaC93V_TrRN5W00WNemZYcmU

2025-06-11 05:54:28,871 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:54:28,871 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:54:30,962 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:54:30,962 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:54:31,011 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:54:31,011 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:54:31,011 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:54:31,011 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 24, 31, 11141), 'iat': datetime.datetime(2025, 6, 11, 12, 54, 31, 11144)}
2025-06-11 05:54:31,011 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODI3MSwiaWF0IjoxNzQ5NjQ2NDcxfQ.fzvWAWUf_mgtSBJxBTbSRfSxLZvyz3050WOI5wT1itg

2025-06-11 05:55:51,804 - INFO - app.core.security - Closing Redis connection...
2025-06-11 05:55:51,805 - INFO - app.core.security - Redis connection closed.
2025-06-11 05:55:54,061 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 05:55:54,061 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 05:55:54,123 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:55:54,123 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:55:54,123 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:55:54,123 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 11, 13, 25, 54, 123149), 'iat': datetime.datetime(2025, 6, 11, 12, 55, 54, 123152)}
2025-06-11 05:55:54,123 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTY0ODM1NCwiaWF0IjoxNzQ5NjQ2NTU0fQ.lYlssIcTY-R0LKejW5ByEWpmi_IeXU5xpdL3s1o9ev4

2025-06-11 05:56:11,637 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 05:56:11,638 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 05:56:11,638 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 05:56:11,638 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 11, 13, 26, 11, 637876), 'iat': datetime.datetime(2025, 6, 11, 12, 56, 11, 637887)}
2025-06-11 05:56:11,638 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk2NDgzNzEsImlhdCI6MTc0OTY0NjU3MX0.qOlNmwct3ykjIlnRzA7JR6qz68HM1n7A55sEmMlRAIY

2025-06-11 05:56:11,639 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAyNTEzNzEsImlhdCI6MTc0OTY0NjU3MX0.Q1EgYBXIF98aKEJBRniQMLM-q03-LgscU5dicGm1hmw, Expiry (seconds): 604800
2025-06-11 05:56:11,640 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 05:56:26,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:56:26,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:56:26,655 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749648371, 'iat': 1749646571}
2025-06-11 05:56:26,655 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749648371, 'iat': 1749646571}
2025-06-11 05:56:26,655 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:56:26,666 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:56:26,666 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 05:57:59,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 05:57:59,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 05:57:59,760 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:57:59,760 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749646835, 'iat': 1749645035}
2025-06-11 05:57:59,760 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 05:57:59,764 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 05:57:59,764 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 21:24:55,790 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 21:24:55,791 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 21:24:55,906 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:24:55,906 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:24:55,906 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:24:55,906 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 4, 54, 55, 906166), 'iat': datetime.datetime(2025, 6, 12, 4, 24, 55, 906170)}
2025-06-11 21:24:55,907 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDA5NSwiaWF0IjoxNzQ5NzAyMjk1fQ.bHB7lBl-mMgjWNgRWH7FqI-MO95JzU6fJqCa5H8XQtQ

2025-06-11 21:26:46,661 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:26:46,661 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:26:46,662 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:26:46,662 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 4, 56, 46, 661535), 'iat': datetime.datetime(2025, 6, 12, 4, 26, 46, 661545)}
2025-06-11 21:26:46,662 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MDQyMDYsImlhdCI6MTc0OTcwMjQwNn0.yUKK8Hsgj1_3o8LrMRqgyD1ETzYqzVrVvES683GTDvc

2025-06-11 21:26:46,662 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMDcyMDYsImlhdCI6MTc0OTcwMjQwNn0.MjiL3nyYWxQN0XF40uhGdqy9w04S89QlcX_xnG8JnX8, Expiry (seconds): 604800
2025-06-11 21:26:46,663 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-11 21:27:12,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:27:12,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:27:12,664 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:27:12,664 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:27:12,664 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 21:27:12,678 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 21:27:12,678 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 21:27:54,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:27:54,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:27:54,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:27:54,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:27:54,631 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 21:27:54,635 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 21:27:54,635 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 21:29:29,604 - INFO - app.core.security - Closing Redis connection...
2025-06-11 21:29:29,606 - INFO - app.core.security - Redis connection closed.
2025-06-11 21:29:32,516 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 21:29:32,516 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 21:29:32,640 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:29:32,640 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:29:32,640 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:29:32,640 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 4, 59, 32, 640377), 'iat': datetime.datetime(2025, 6, 12, 4, 29, 32, 640382)}
2025-06-11 21:29:32,641 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDM3MiwiaWF0IjoxNzQ5NzAyNTcyfQ.RBJRS6bzow3LbeYlKSOMxBofuat6S4m-MAuAVn-8h7g

2025-06-11 21:30:00,014 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:30:00,016 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:30:00,016 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:30:00,017 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 0, 0, 14564), 'iat': datetime.datetime(2025, 6, 12, 4, 30, 0, 14577)}
2025-06-11 21:30:00,017 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDQwMCwiaWF0IjoxNzQ5NzAyNjAwfQ.IanXP36y03ZzssExsvwttlYktw406M-2VSpxQsWKDVI

2025-06-11 21:30:28,964 - INFO - app.core.security - Closing Redis connection...
2025-06-11 21:30:28,966 - INFO - app.core.security - Redis connection closed.
2025-06-11 21:30:31,840 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 21:30:31,840 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 21:30:32,026 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:30:32,026 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:30:32,027 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:30:32,027 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 0, 32, 26482), 'iat': datetime.datetime(2025, 6, 12, 4, 30, 32, 26490)}
2025-06-11 21:30:32,028 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDQzMiwiaWF0IjoxNzQ5NzAyNjMyfQ.SjXrP9biuOv2A5ME6bJ-_7fY-CWlEYTrUOK5hunsPfE

2025-06-11 21:31:38,086 - INFO - app.core.security - Closing Redis connection...
2025-06-11 21:31:38,089 - INFO - app.core.security - Redis connection closed.
2025-06-11 21:31:40,537 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 21:31:40,537 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 21:31:40,688 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:31:40,688 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:31:40,688 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:31:40,688 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 1, 40, 688619), 'iat': datetime.datetime(2025, 6, 12, 4, 31, 40, 688626)}
2025-06-11 21:31:40,689 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDUwMCwiaWF0IjoxNzQ5NzAyNzAwfQ.Xgqeom7Ds93uHg2ry92btMnZJpVX6Tlbm99fTtKdLEA

2025-06-11 21:31:50,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:31:50,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:31:50,920 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:31:50,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749704206, 'iat': 1749702406}
2025-06-11 21:31:50,920 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 21:31:51,063 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 21:31:51,064 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 21:32:22,462 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:32:22,462 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:32:22,462 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:32:22,462 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 5, 2, 22, 462270), 'iat': datetime.datetime(2025, 6, 12, 4, 32, 22, 462280)}
2025-06-11 21:32:22,463 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MDQ1NDIsImlhdCI6MTc0OTcwMjc0Mn0.HmtuMZ2Jkt9wNT874aoxPDDasnY4Gf7Pf2g1YgpkyEA

2025-06-11 21:32:22,463 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMDc1NDIsImlhdCI6MTc0OTcwMjc0Mn0.mQbIpfwrCaW8InpTJzy7Kh_FSh_pMGdPfXCi4AolUjg, Expiry (seconds): 604800
2025-06-11 21:32:22,464 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 21:32:34,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:32:34,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:32:34,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:32:34,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:32:34,517 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 21:32:34,525 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 21:32:34,525 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 21:32:48,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:32:48,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:32:48,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:32:48,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:32:48,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 21:32:48,972 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 21:32:48,972 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 21:33:14,645 - INFO - app.core.security - Closing Redis connection...
2025-06-11 21:33:14,646 - INFO - app.core.security - Redis connection closed.
2025-06-11 21:36:11,928 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 21:36:11,928 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 21:36:12,035 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 21:36:12,035 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 21:36:12,035 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 21:36:12,035 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 6, 12, 35659), 'iat': datetime.datetime(2025, 6, 12, 4, 36, 12, 35663)}
2025-06-11 21:36:12,036 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNDc3MiwiaWF0IjoxNzQ5NzAyOTcyfQ.hqEqcrRdrEKiTYjsJTQim7LO0Y1Z9ai_GK1ItEfEkU4

2025-06-11 21:36:20,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 21:36:20,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 21:36:20,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:36:20,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749704542, 'iat': 1749702742}
2025-06-11 21:36:20,911 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 21:36:20,950 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 21:36:20,951 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 21:36:41,840 - INFO - app.core.security - Closing Redis connection...
2025-06-11 21:36:41,841 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:05:50,712 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:05:50,712 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:05:50,889 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:05:50,889 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:05:50,889 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:05:50,889 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 35, 50, 889356), 'iat': datetime.datetime(2025, 6, 12, 5, 5, 50, 889361)}
2025-06-11 22:05:50,890 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNjU1MCwiaWF0IjoxNzQ5NzA0NzUwfQ.SaI14T84QPYMR0efDcds9XyknAT8VZNPs_NxJT2PuTU

2025-06-11 22:07:02,109 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:07:02,110 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:07:02,110 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:07:02,110 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 5, 37, 2, 109685), 'iat': datetime.datetime(2025, 6, 12, 5, 7, 2, 109696)}
2025-06-11 22:07:02,110 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MDY2MjIsImlhdCI6MTc0OTcwNDgyMn0.UTARvnPu1mj7crqep9jXMxtvfGb1jJiPXaB1e8gLPlc

2025-06-11 22:07:02,111 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMDk2MjIsImlhdCI6MTc0OTcwNDgyMn0.G17fe45uVcDLWN9iBzAndfGmk-jfnzDLhProgb3h_3Y, Expiry (seconds): 604800
2025-06-11 22:07:02,112 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 22:07:20,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:07:20,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:07:20,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:10:31,952 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:10:31,953 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:13:15,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:13:15,791 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:13:15,954 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:13:15,954 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:13:15,954 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:13:15,954 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 43, 15, 954199), 'iat': datetime.datetime(2025, 6, 12, 5, 13, 15, 954208)}
2025-06-11 22:13:15,955 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNjk5NSwiaWF0IjoxNzQ5NzA1MTk1fQ.k16yPnYjkwcYt3OTJTObvLDpf_wvoHEsoiNWCErovMo

2025-06-11 22:13:22,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:13:22,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:13:22,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:14:13,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:14:13,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:14:13,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:14:13,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:14:13,969 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:14:14,020 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:14:14,020 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:14:41,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:14:41,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:14:41,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:15:01,323 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:15:01,324 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:15:09,735 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:15:09,735 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:15:09,896 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:15:09,896 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:15:09,897 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:15:09,897 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 45, 9, 896877), 'iat': datetime.datetime(2025, 6, 12, 5, 15, 9, 896880)}
2025-06-11 22:15:09,897 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNzEwOSwiaWF0IjoxNzQ5NzA1MzA5fQ.rPfOAVTH0Px2RpiKFazh-6C99BJuTmTRju8ceowJ-uo

2025-06-11 22:15:41,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:15:41,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:15:41,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:16:14,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:16:14,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:16:14,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:16:14,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:16:14,837 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:16:14,850 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:16:14,850 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:16:26,518 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:16:26,519 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:21:47,007 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:21:47,008 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:21:47,192 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:21:47,192 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:21:47,192 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:21:47,192 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 51, 47, 192203), 'iat': datetime.datetime(2025, 6, 12, 5, 21, 47, 192209)}
2025-06-11 22:21:47,194 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNzUwNywiaWF0IjoxNzQ5NzA1NzA3fQ.5hY3S8cNhXnccK6xYwYcXJDx2B-xPF63GoePmX8YDD0

2025-06-11 22:22:47,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:22:47,719 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:22:47,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:22:47,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:22:47,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:22:47,774 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:22:47,774 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:23:40,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:23:40,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:23:40,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:23:40,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:23:40,623 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:23:40,632 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:23:40,632 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:23:45,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:23:45,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:23:45,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:23:45,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:23:45,649 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:23:45,672 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:23:45,673 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:27:22,409 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:27:22,409 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:27:22,521 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:27:22,521 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:27:22,521 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:27:22,521 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 57, 22, 521509), 'iat': datetime.datetime(2025, 6, 12, 5, 27, 22, 521512)}
2025-06-11 22:27:22,522 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNzg0MiwiaWF0IjoxNzQ5NzA2MDQyfQ.uzj4bKWqVcuupIhHFE3stBqsEgTEAgMK9H0R_gy-YGU

2025-06-11 22:27:30,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:27:30,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:27:30,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:27:30,338 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:27:30,338 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:27:30,424 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:27:30,425 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:27:51,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:27:51,103 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:27:51,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:27:51,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:27:51,103 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:27:51,111 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:27:51,112 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:27:54,433 - WARNING - app.core.security - Access token is missing.
2025-06-11 22:28:12,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:28:12,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:28:12,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:28:12,849 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:28:12,849 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:28:12,854 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:28:12,854 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:28:49,944 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:28:49,945 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:28:52,458 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:28:52,458 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:28:52,589 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:28:52,589 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:28:52,589 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:28:52,590 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 58, 52, 589681), 'iat': datetime.datetime(2025, 6, 12, 5, 28, 52, 589687)}
2025-06-11 22:28:52,590 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNzkzMiwiaWF0IjoxNzQ5NzA2MTMyfQ.TmFXTJNsW6cPPWQQUd5w5iwYWfH0TQzvbNLMs1sGkH4

2025-06-11 22:29:04,356 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:29:04,356 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:29:04,519 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:29:04,519 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:29:04,519 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:29:04,519 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 5, 59, 4, 519228), 'iat': datetime.datetime(2025, 6, 12, 5, 29, 4, 519232)}
2025-06-11 22:29:04,519 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwNzk0NCwiaWF0IjoxNzQ5NzA2MTQ0fQ.4ojsZexhHMY4mijPSfW3hxSD8x1WjmWiY5ZDIUIPccg

2025-06-11 22:29:27,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:29:27,181 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:29:27,181 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:29:27,181 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:29:27,182 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:29:27,272 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:29:27,272 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:29:33,404 - WARNING - app.core.security - Access token is missing.
2025-06-11 22:30:00,007 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:30:00,008 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:30:00,008 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:30:00,009 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 0, 0, 7877), 'iat': datetime.datetime(2025, 6, 12, 5, 30, 0, 7895)}
2025-06-11 22:30:00,010 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODAwMCwiaWF0IjoxNzQ5NzA2MjAwfQ.ehq74B8QeVXy0KVyHyPGapmhifOAAmTCuDbpBMLaKYE

2025-06-11 22:30:56,792 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:30:56,795 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:30:59,324 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:30:59,324 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:30:59,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:30:59,569 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:30:59,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:30:59,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 0, 59, 568877), 'iat': datetime.datetime(2025, 6, 12, 5, 30, 59, 568886)}
2025-06-11 22:30:59,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODA1OSwiaWF0IjoxNzQ5NzA2MjU5fQ.C7enbEkU2qkk4sCzyeXfQqsKhzifQFVoNB_7ynWGcOw

2025-06-11 22:31:31,404 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:31:31,405 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:31:33,903 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:31:33,903 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:31:34,066 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:31:34,066 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:31:34,066 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:31:34,066 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 1, 34, 66155), 'iat': datetime.datetime(2025, 6, 12, 5, 31, 34, 66160)}
2025-06-11 22:31:34,067 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODA5NCwiaWF0IjoxNzQ5NzA2Mjk0fQ.--1zyRKTU6CSpMmsqSuv2siARsK59XJdD-P9E9t0MOI

2025-06-11 22:32:24,318 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:32:24,318 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:32:24,498 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:32:24,498 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:32:24,498 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:32:24,498 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 2, 24, 498442), 'iat': datetime.datetime(2025, 6, 12, 5, 32, 24, 498448)}
2025-06-11 22:32:24,499 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODE0NCwiaWF0IjoxNzQ5NzA2MzQ0fQ.fD5o-m1oitlUm90kC5wxbUgcj4C8xwNLWuRZB4T5thA

2025-06-11 22:32:31,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:32:31,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:32:31,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:32:31,446 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:32:31,446 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:32:31,499 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:32:31,499 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:33:53,338 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:33:53,339 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:33:55,672 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:33:55,672 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:33:55,775 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:33:55,775 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:33:55,775 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:33:55,775 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 3, 55, 775250), 'iat': datetime.datetime(2025, 6, 12, 5, 33, 55, 775255)}
2025-06-11 22:33:55,775 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODIzNSwiaWF0IjoxNzQ5NzA2NDM1fQ.87D9Y9B7wTwx2K7xrFfvwC5Miqa0ReQEyFi4ZTAIdX8

2025-06-11 22:34:15,380 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:34:15,380 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:34:15,532 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:34:15,532 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:34:15,532 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:34:15,532 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 4, 15, 532399), 'iat': datetime.datetime(2025, 6, 12, 5, 34, 15, 532409)}
2025-06-11 22:34:15,533 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODI1NSwiaWF0IjoxNzQ5NzA2NDU1fQ.PKCUyQZNw8fd2w9JU4D0EeDS92WMFnb5x0Lh1AYDI5M

2025-06-11 22:34:34,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:34:34,798 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:34:34,799 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-11 22:34:34,804 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 22:36:46,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:36:46,982 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:36:46,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:36:46,983 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749706622, 'iat': 1749704822}
2025-06-11 22:36:46,983 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:36:47,041 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:36:47,041 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:37:24,990 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:37:24,991 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:37:27,424 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:37:27,425 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:37:27,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:37:27,537 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:37:27,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:37:27,537 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 7, 27, 537766), 'iat': datetime.datetime(2025, 6, 12, 5, 37, 27, 537768)}
2025-06-11 22:37:27,538 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODQ0NywiaWF0IjoxNzQ5NzA2NjQ3fQ.aObd9nlNSAkvCnwR1xcdezDdERUdffKHpa3kR-ytUD0

2025-06-11 22:37:54,778 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:37:54,779 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:37:54,930 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:37:54,931 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:37:54,931 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:37:54,931 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 7, 54, 930886), 'iat': datetime.datetime(2025, 6, 12, 5, 37, 54, 930891)}
2025-06-11 22:37:54,931 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODQ3NCwiaWF0IjoxNzQ5NzA2Njc0fQ.qgVI1iqz_amVz7Q4K1p3Q7sf40WhiqZ9SbBRJT0Tudw

2025-06-11 22:38:18,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:38:18,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:38:18,235 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 22:38:18,238 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 22:38:23,466 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:38:23,466 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:38:23,467 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:38:23,467 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 6, 8, 23, 466481), 'iat': datetime.datetime(2025, 6, 12, 5, 38, 23, 466493)}
2025-06-11 22:38:23,467 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MDg1MDMsImlhdCI6MTc0OTcwNjcwM30.eFcLvOkL2Gj9k9ch76gtOXKSd2K9gH19vkBk8UQ8m5M

2025-06-11 22:38:23,468 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMTE1MDMsImlhdCI6MTc0OTcwNjcwM30.lSgjbZLvD2qfxvqw7t8BO5BTPqEc2ZK8WZoAS7YjMgs, Expiry (seconds): 604800
2025-06-11 22:38:23,470 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-11 22:38:37,008 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:38:37,008 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:38:37,009 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749708503, 'iat': 1749706703}
2025-06-11 22:38:37,009 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749708503, 'iat': 1749706703}
2025-06-11 22:38:37,009 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-11 22:38:37,023 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-11 22:38:37,024 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-11 22:40:21,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:40:21,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:40:21,660 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-11 22:40:37,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:40:37,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:40:37,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749708503, 'iat': 1749706703}
2025-06-11 22:41:22,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:41:22,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:41:22,589 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-11 22:41:22,592 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-11 22:45:26,984 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:45:26,985 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:45:29,384 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:45:29,384 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:45:29,495 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:45:29,495 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:45:29,495 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:45:29,495 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 15, 29, 495563), 'iat': datetime.datetime(2025, 6, 12, 5, 45, 29, 495567)}
2025-06-11 22:45:29,496 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODkyOSwiaWF0IjoxNzQ5NzA3MTI5fQ.Z-enFWGpD2qSGcT_5-fOd55dmYpYwqz1eh6byGJWMg4

2025-06-11 22:46:22,169 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:46:22,169 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:46:24,665 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:46:24,665 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:46:24,804 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:46:24,804 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:46:24,804 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:46:24,804 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 16, 24, 804814), 'iat': datetime.datetime(2025, 6, 12, 5, 46, 24, 804818)}
2025-06-11 22:46:24,805 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwODk4NCwiaWF0IjoxNzQ5NzA3MTg0fQ.9GLCO9KJRdlvCX_xhEd8ROP2QgfdE_HjXMS2RtyamfA

2025-06-11 22:46:49,729 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:46:49,730 - INFO - app.core.security - Redis connection closed.
2025-06-11 22:47:38,224 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-11 22:47:38,224 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-11 22:47:38,358 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:47:38,358 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:47:38,358 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:47:38,358 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 6, 17, 38, 358554), 'iat': datetime.datetime(2025, 6, 12, 5, 47, 38, 358557)}
2025-06-11 22:47:38,359 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcwOTA1OCwiaWF0IjoxNzQ5NzA3MjU4fQ.bINsdh81Y36bGAHiZVFP0MKot10IOiOdYCcmPBJ1DaM

2025-06-11 22:50:00,066 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-11 22:50:00,066 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-11 22:50:00,066 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-11 22:50:00,066 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 6, 20, 0, 66351), 'iat': datetime.datetime(2025, 6, 12, 5, 50, 0, 66363)}
2025-06-11 22:50:00,067 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MDkyMDAsImlhdCI6MTc0OTcwNzQwMH0.UokSJvbNF4ZXFrnbX7Xf30ONX9zSbDnqdC2NMXlRqo4

2025-06-11 22:50:00,067 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMTIyMDAsImlhdCI6MTc0OTcwNzQwMH0.hcK-OJCJTbVDPkL56xpcICa9rwAmw9C5go0ybyZG9Ws, Expiry (seconds): 604800
2025-06-11 22:50:00,068 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-11 22:50:17,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:50:17,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:50:17,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:50:59,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:50:59,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:50:59,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:50:59,374 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:50:59,375 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-11 22:50:59,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:50:59,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:50:59,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:50:59,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:50:59,377 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:50:59,423 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:50:59,423 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:50:59,423 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:51:26,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:51:26,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:51:26,790 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:51:26,790 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:51:26,790 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-11 22:51:26,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:51:26,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:51:26,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:51:26,791 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:51:26,791 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:51:26,796 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:51:26,797 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:51:26,797 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:54:15,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:54:15,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:54:15,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:54:15,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:54:15,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:54:15,869 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:54:15,869 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:54:24,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:54:24,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:54:24,833 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:54:24,833 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:54:24,833 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:54:24,839 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:54:24,839 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:54:39,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:54:39,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:54:39,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:02,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:55:02,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:55:02,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:02,570 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:02,570 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:55:02,576 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:55:02,576 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:55:08,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:55:08,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:55:08,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:08,749 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:08,749 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:55:08,754 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:55:08,754 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:55:17,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-11 22:55:17,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-11 22:55:17,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:17,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749709200, 'iat': 1749707400}
2025-06-11 22:55:17,149 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-11 22:55:17,185 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-11 22:55:17,185 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-11 22:56:36,050 - INFO - app.core.security - Closing Redis connection...
2025-06-11 22:56:36,050 - INFO - app.core.security - Redis connection closed.
2025-06-12 01:58:27,031 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 01:58:27,031 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 01:58:27,118 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 01:58:27,118 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 01:58:27,118 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 01:58:27,118 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 28, 27, 118656), 'iat': datetime.datetime(2025, 6, 12, 8, 58, 27, 118659)}
2025-06-12 01:58:27,119 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMDUwNywiaWF0IjoxNzQ5NzE4NzA3fQ.9CMjUJdcguoWJvXY0RfmaaaU29y8BnIlXMRvX7ckOf4

2025-06-12 02:00:00,015 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:00:00,016 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:00:00,016 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:00:00,016 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 30, 0, 15774), 'iat': datetime.datetime(2025, 6, 12, 9, 0, 0, 15784)}
2025-06-12 02:00:00,016 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMDYwMCwiaWF0IjoxNzQ5NzE4ODAwfQ.iqVIq7NG3oGuOd8hrC0JJ6cI8ti403EateHfyyC87UQ

2025-06-12 02:02:41,585 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:02:41,586 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:07:21,850 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:07:21,850 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:07:21,998 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:07:21,998 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:07:21,998 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:07:21,999 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 37, 21, 998714), 'iat': datetime.datetime(2025, 6, 12, 9, 7, 21, 998722)}
2025-06-12 02:07:21,999 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMTA0MSwiaWF0IjoxNzQ5NzE5MjQxfQ.eBMK_NKpvU4NJlQEXA0eO5ECaGQfjrUxQTO2I70fxs4

2025-06-12 02:09:32,103 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:09:32,104 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:21:14,915 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:21:14,915 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:21:15,033 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:21:15,033 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:21:15,033 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:21:15,033 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 51, 15, 33001), 'iat': datetime.datetime(2025, 6, 12, 9, 21, 15, 33007)}
2025-06-12 02:21:15,033 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMTg3NSwiaWF0IjoxNzQ5NzIwMDc1fQ.2Z5Uk5O2wuae5yPr0e4pzpV5GDqLjg4FV1BhV0UBtWg

2025-06-12 02:21:28,932 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:21:28,932 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:21:28,933 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:21:28,933 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 9, 51, 28, 932568), 'iat': datetime.datetime(2025, 6, 12, 9, 21, 28, 932576)}
2025-06-12 02:21:28,933 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjE4ODgsImlhdCI6MTc0OTcyMDA4OH0.Qu-XUmBMHLupalWuMPKjkCQ5WQ36mgVkH1ArT8C9EyI

2025-06-12 02:21:28,933 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMjQ4ODgsImlhdCI6MTc0OTcyMDA4OH0.xjGNgigbt8zlzxo_YJjGYkP98rQvr9T-V2xeqWwXpPc, Expiry (seconds): 604800
2025-06-12 02:21:28,936 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 02:22:34,837 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:22:34,838 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:23:55,411 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:23:55,411 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:23:55,571 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:23:55,571 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:23:55,571 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:23:55,571 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 53, 55, 571485), 'iat': datetime.datetime(2025, 6, 12, 9, 23, 55, 571489)}
2025-06-12 02:23:55,572 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjAzNSwiaWF0IjoxNzQ5NzIwMjM1fQ.ELpsQuwnuO7AnLcsBrw5rgops3VzGU23CMRDdOS5Ea8

2025-06-12 02:24:09,146 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:24:09,147 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:28:14,103 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:28:14,103 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:28:14,105 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:28:14,105 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:28:14,235 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:28:14,235 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:28:14,235 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:28:14,235 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 58, 14, 235772), 'iat': datetime.datetime(2025, 6, 12, 9, 28, 14, 235777)}
2025-06-12 02:28:14,236 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjI5NCwiaWF0IjoxNzQ5NzIwNDk0fQ.IBvKOLuSlw0I4EoBNi_NwB2TSulkoxBSvPZ_vfNSqQA

2025-06-12 02:28:14,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:28:14,262 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:28:14,262 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:28:14,262 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 58, 14, 262272), 'iat': datetime.datetime(2025, 6, 12, 9, 28, 14, 262276)}
2025-06-12 02:28:14,263 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjI5NCwiaWF0IjoxNzQ5NzIwNDk0fQ.IBvKOLuSlw0I4EoBNi_NwB2TSulkoxBSvPZ_vfNSqQA

2025-06-12 02:28:30,914 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:28:30,915 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:28:30,915 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:28:30,915 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 9, 58, 30, 914865), 'iat': datetime.datetime(2025, 6, 12, 9, 28, 30, 914875)}
2025-06-12 02:28:30,916 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjIzMTAsImlhdCI6MTc0OTcyMDUxMH0.jruhREn9WzCPUzuMJxLC9zbMd4LTkkka8q0dkyqDWlw

2025-06-12 02:28:30,916 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMjUzMTAsImlhdCI6MTc0OTcyMDUxMH0.T118VdTAJH1GSIYR8GmMWbf9bzBdPNmj9i6MwJoHyII, Expiry (seconds): 604800
2025-06-12 02:28:30,917 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 02:28:38,252 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:28:38,252 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:28:38,254 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749721888, 'iat': 1749720088}
2025-06-12 02:28:38,254 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749721888, 'iat': 1749720088}
2025-06-12 02:28:38,255 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:28:38,266 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:28:38,267 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:29:45,024 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:29:45,024 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:29:47,284 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:29:47,284 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:29:47,446 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:29:47,446 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:29:47,446 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:29:47,446 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 9, 59, 47, 446430), 'iat': datetime.datetime(2025, 6, 12, 9, 29, 47, 446436)}
2025-06-12 02:29:47,447 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjM4NywiaWF0IjoxNzQ5NzIwNTg3fQ.yjyoZyAqazTebfVdvkTGHkCwzmy0uykljDX-mT2iUyM

2025-06-12 02:30:00,017 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:30:00,017 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:30:00,018 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:30:00,018 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 0, 0, 17747), 'iat': datetime.datetime(2025, 6, 12, 9, 30, 0, 17756)}
2025-06-12 02:30:00,018 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjQwMCwiaWF0IjoxNzQ5NzIwNjAwfQ.0FpSnf5y6iVsl0XcYZdQY0eS1J0YkOCvseIzPJmFqEo

2025-06-12 02:32:38,062 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:32:38,063 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:32:40,511 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:32:40,511 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:32:40,882 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:32:40,882 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:32:40,882 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:32:40,882 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 2, 40, 882486), 'iat': datetime.datetime(2025, 6, 12, 9, 32, 40, 882493)}
2025-06-12 02:32:40,883 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjU2MCwiaWF0IjoxNzQ5NzIwNzYwfQ._o__xcpRoE7N5hk2g-yUu5Pfp54-y70av-1NRpOdVj0

2025-06-12 02:33:03,457 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:03,457 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:06,143 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:06,143 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:06,275 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:06,275 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:06,275 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:06,275 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 6, 275542), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 6, 275546)}
2025-06-12 02:33:06,276 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjU4NiwiaWF0IjoxNzQ5NzIwNzg2fQ.c5pnoELrKRhfFsKnRkDCviYDVBYBrqa2F6mVmby5BgA

2025-06-12 02:33:10,289 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:10,292 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:14,554 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:14,554 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:14,686 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:14,686 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:14,686 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:14,686 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 14, 686036), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 14, 686042)}
2025-06-12 02:33:14,686 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjU5NCwiaWF0IjoxNzQ5NzIwNzk0fQ.m03JzG-2biLaaxDW-bfWcAVvBKoar1rp-1vMHDCIenE

2025-06-12 02:33:17,076 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:17,076 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:19,564 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:19,564 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:19,665 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:19,665 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:19,665 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:19,665 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 19, 665085), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 19, 665089)}
2025-06-12 02:33:19,665 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjU5OSwiaWF0IjoxNzQ5NzIwNzk5fQ.9nqx7pYPLmV1h55zVjesUCL1ifl4QXsnjBgaUSkBo5Y

2025-06-12 02:33:21,886 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:21,887 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:24,880 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:24,880 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:25,016 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:25,016 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:25,016 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:25,016 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 25, 16553), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 25, 16556)}
2025-06-12 02:33:25,017 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjYwNSwiaWF0IjoxNzQ5NzIwODA1fQ.HM81ZfwVAT1vg1l2s4AegR0DROWHIAd3SMB543-Gi9s

2025-06-12 02:33:28,046 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:28,046 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:28,184 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:28,184 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:28,184 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:28,184 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 28, 184047), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 28, 184054)}
2025-06-12 02:33:28,185 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjYwOCwiaWF0IjoxNzQ5NzIwODA4fQ.KTIu9NmYSsOkPsh5L7Vbo9tWqOtsD7xz4DC_5Q6n7iQ

2025-06-12 02:33:30,901 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:30,902 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:37,863 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:33:37,864 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:33:40,009 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:33:40,009 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:33:40,132 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:33:40,132 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:33:40,132 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:33:40,133 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 3, 40, 132792), 'iat': datetime.datetime(2025, 6, 12, 9, 33, 40, 132797)}
2025-06-12 02:33:40,133 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjYyMCwiaWF0IjoxNzQ5NzIwODIwfQ.P96-d69eoTQqXX4cLbB9-TDyoU6FfBD-NSxbdIg-wLs

2025-06-12 02:34:30,818 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:34:30,819 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:34:33,075 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:34:33,075 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:34:33,234 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:34:33,235 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:34:33,235 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:34:33,235 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 4, 33, 234858), 'iat': datetime.datetime(2025, 6, 12, 9, 34, 33, 234866)}
2025-06-12 02:34:33,235 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjY3MywiaWF0IjoxNzQ5NzIwODczfQ.ZG6ovkxS8h-zYOkoYRP54V74O1dfYvk6MFw06kOPfPU

2025-06-12 02:35:00,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:35:00,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:35:00,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749721888, 'iat': 1749720088}
2025-06-12 02:35:00,736 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749721888, 'iat': 1749720088}
2025-06-12 02:35:00,736 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:35:00,761 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:35:00,761 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:35:15,046 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:35:15,047 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:35:17,419 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:35:17,419 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:35:17,522 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:35:17,522 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:35:17,522 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:35:17,522 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 5, 17, 522681), 'iat': datetime.datetime(2025, 6, 12, 9, 35, 17, 522684)}
2025-06-12 02:35:17,523 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjcxNywiaWF0IjoxNzQ5NzIwOTE3fQ.Sy1YiN0Irec31rQWDwP_V0nezibuECuw_NRJ6HJcJD8

2025-06-12 02:35:19,669 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:35:19,670 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:35:22,771 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:35:22,772 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:35:22,889 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:35:22,889 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:35:22,889 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:35:22,889 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 5, 22, 889054), 'iat': datetime.datetime(2025, 6, 12, 9, 35, 22, 889058)}
2025-06-12 02:35:22,889 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjcyMiwiaWF0IjoxNzQ5NzIwOTIyfQ.cv5In8Z0swCRsHMy_3SuNtptSOwTeu1ySwtmMTy0Sj8

2025-06-12 02:35:31,121 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:35:31,122 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:35:33,123 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:35:33,124 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:35:33,270 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:35:33,270 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:35:33,270 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:35:33,270 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 5, 33, 270545), 'iat': datetime.datetime(2025, 6, 12, 9, 35, 33, 270552)}
2025-06-12 02:35:33,271 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjczMywiaWF0IjoxNzQ5NzIwOTMzfQ.GC3ejqcEL5voefLi6sWVSiEUUhjoOYE0Y1poYXtoN9s

2025-06-12 02:35:51,702 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:35:51,703 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:35:55,145 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:35:55,145 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:35:55,269 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:35:55,269 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:35:55,270 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:35:55,270 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 5, 55, 269812), 'iat': datetime.datetime(2025, 6, 12, 9, 35, 55, 269817)}
2025-06-12 02:35:55,270 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjc1NSwiaWF0IjoxNzQ5NzIwOTU1fQ.4RG7Av1VCrrA8ZV7AXy8kdRSTaKnTDrvB8RBJqsRZFU

2025-06-12 02:35:58,532 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:35:58,533 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:36:01,512 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:36:01,513 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:36:01,656 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:36:01,656 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:36:01,656 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:36:01,656 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 6, 1, 655989), 'iat': datetime.datetime(2025, 6, 12, 9, 36, 1, 655995)}
2025-06-12 02:36:01,656 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjc2MSwiaWF0IjoxNzQ5NzIwOTYxfQ.L2dMzOiWQdIvxBrXlSskxqYCXKUBvkJr4UIi4wIT5mI

2025-06-12 02:36:07,682 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:36:07,683 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:36:11,811 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:36:11,811 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:36:11,951 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:36:11,951 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:36:11,951 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:36:11,952 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 6, 11, 951522), 'iat': datetime.datetime(2025, 6, 12, 9, 36, 11, 951528)}
2025-06-12 02:36:11,952 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjc3MSwiaWF0IjoxNzQ5NzIwOTcxfQ.oPnddURhxuBGiF01PeJEUHV5b4D5f47TKsMFn2GKpHQ

2025-06-12 02:36:39,927 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:36:39,927 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:36:51,917 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:36:51,917 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:36:52,061 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:36:52,061 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:36:52,061 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:36:52,061 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 6, 52, 61020), 'iat': datetime.datetime(2025, 6, 12, 9, 36, 52, 61025)}
2025-06-12 02:36:52,061 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjgxMiwiaWF0IjoxNzQ5NzIxMDEyfQ.vQg0uib20gft2lqrA1TAve36dpdcTSfY5eCq9B2U7IA

2025-06-12 02:36:55,440 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:36:55,440 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:36:55,440 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:36:55,440 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 10, 6, 55, 440238), 'iat': datetime.datetime(2025, 6, 12, 9, 36, 55, 440244)}
2025-06-12 02:36:55,440 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjI4MTUsImlhdCI6MTc0OTcyMTAxNX0.J7ficOswTJgMp7XGambzZcyyAuLmIdL7uJ1dPoARFGU

2025-06-12 02:36:55,441 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMjU4MTUsImlhdCI6MTc0OTcyMTAxNX0.OPXBdeFpzVMMTQkk_h9udqGqkeF8xJheXmlpTBZt_cs, Expiry (seconds): 604800
2025-06-12 02:36:55,442 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 02:37:09,740 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:09,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:09,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:09,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:09,741 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:09,754 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:09,756 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:37:15,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:15,748 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:15,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:15,749 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:15,749 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:15,758 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:15,758 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:37:49,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:49,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:49,054 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:49,055 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:49,055 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:49,064 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:49,065 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:37:56,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:56,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:56,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:56,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:56,041 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:56,047 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:56,047 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:37:57,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:57,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:57,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:57,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:57,863 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:57,872 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:57,873 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:37:59,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:37:59,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:37:59,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:59,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:37:59,671 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:37:59,679 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:37:59,680 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:38:09,117 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:38:09,118 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:38:13,622 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:38:13,622 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:38:13,763 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:38:13,764 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:38:13,764 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:38:13,764 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 8, 13, 763859), 'iat': datetime.datetime(2025, 6, 12, 9, 38, 13, 763864)}
2025-06-12 02:38:13,764 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMjg5MywiaWF0IjoxNzQ5NzIxMDkzfQ.CRs0kgKcpFnDArC5I8WIzJGCQPNDZZb_u1AgIhJghks

2025-06-12 02:38:19,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:38:19,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:38:19,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:38:19,721 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:38:19,721 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:38:19,912 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:38:19,913 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:38:22,838 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:38:22,839 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:40:52,194 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:40:52,194 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:40:52,299 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:40:52,299 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:40:52,299 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:40:52,299 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 10, 52, 299596), 'iat': datetime.datetime(2025, 6, 12, 9, 40, 52, 299599)}
2025-06-12 02:40:52,300 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMzA1MiwiaWF0IjoxNzQ5NzIxMjUyfQ.s1ekZuA1tO1N_F-fKWALTz8qQfvij9pjb95ivXaYNeg

2025-06-12 02:40:54,488 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:40:54,489 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:40:56,797 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:40:56,797 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:40:56,946 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:40:56,946 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:40:56,946 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:40:56,946 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 10, 56, 946447), 'iat': datetime.datetime(2025, 6, 12, 9, 40, 56, 946453)}
2025-06-12 02:40:56,947 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMzA1NiwiaWF0IjoxNzQ5NzIxMjU2fQ.mltEWzfwHBASSkxmZufQVLjtkIafkpo7Q4EMLvgNA4E

2025-06-12 02:41:00,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:41:00,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:41:00,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:41:00,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749722815, 'iat': 1749721015}
2025-06-12 02:41:00,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:41:00,401 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:41:00,402 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:42:52,379 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:42:52,380 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:47:06,312 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:47:06,313 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:47:06,418 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:47:06,418 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:47:06,418 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:47:06,418 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 17, 6, 418028), 'iat': datetime.datetime(2025, 6, 12, 9, 47, 6, 418036)}
2025-06-12 02:47:06,418 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMzQyNiwiaWF0IjoxNzQ5NzIxNjI2fQ.I86uZGBOsf9hur9DJVjJjjf9VCeQWzUaV4tcxT3kclg

2025-06-12 02:47:17,102 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:47:17,102 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:47:17,102 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:47:17,102 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 10, 17, 17, 102106), 'iat': datetime.datetime(2025, 6, 12, 9, 47, 17, 102116)}
2025-06-12 02:47:17,103 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MjM0MzcsImlhdCI6MTc0OTcyMTYzN30.68IkwHooJk5Yp_b7mla1FBrDNB3GBAWRCY9g4UsKEG0

2025-06-12 02:47:17,103 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMjY0MzcsImlhdCI6MTc0OTcyMTYzN30.ilaE_KaakAdPD27FFhZfG9oUdstkikDAx4b9Gd2Oe2o, Expiry (seconds): 604800
2025-06-12 02:47:17,104 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 02:47:49,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:47:49,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:47:49,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:47:49,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:47:49,276 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:47:49,283 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:47:49,283 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:47:54,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:47:54,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:47:54,296 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:47:54,296 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:47:54,297 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:47:54,305 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:47:54,305 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:48:23,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:48:23,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:48:23,061 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:23,062 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:23,062 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:48:23,071 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:48:23,071 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:48:29,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:48:29,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:48:29,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:29,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:29,897 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:48:29,909 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:48:29,909 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:48:35,585 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:48:35,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:48:35,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:35,586 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:35,586 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:48:35,597 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:48:35,598 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:48:47,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:48:47,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:48:47,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:47,090 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:48:47,090 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:48:47,098 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:48:47,099 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:49:09,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:49:09,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:49:09,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:09,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:09,802 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:49:09,812 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:49:09,812 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:49:32,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:49:32,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:49:32,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:32,325 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:32,325 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:49:32,332 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:49:32,333 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:49:42,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:49:42,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:49:42,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:42,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:49:42,149 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:49:42,158 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:49:42,158 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:49:50,448 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:49:50,449 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:51:55,804 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:51:55,805 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:51:56,079 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:51:56,080 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:51:56,080 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:51:56,080 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 21, 56, 79889), 'iat': datetime.datetime(2025, 6, 12, 9, 51, 56, 79903)}
2025-06-12 02:51:56,083 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyMzcxNiwiaWF0IjoxNzQ5NzIxOTE2fQ.7Aqz9VJlLdWefRh8XMYZUxsLMJWX3eNH6TV2Y-GwmGU

2025-06-12 02:52:02,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:52:02,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:52:02,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:02,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:02,345 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:52:02,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:52:02,663 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:52:09,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:52:09,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:52:09,974 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:09,974 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:09,974 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:52:09,984 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:52:09,985 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:52:41,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:52:41,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:52:41,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:41,729 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:52:41,729 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:52:41,741 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:52:41,742 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:53:16,364 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:53:16,365 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:57:27,481 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:57:27,487 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:57:27,611 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:57:27,611 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:57:27,611 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:57:27,611 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 27, 27, 611225), 'iat': datetime.datetime(2025, 6, 12, 9, 57, 27, 611231)}
2025-06-12 02:57:27,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyNDA0NywiaWF0IjoxNzQ5NzIyMjQ3fQ.hD4vh_Y7rONl4B6OhBy9EbiybI80L6DhR1OT9WbKRxk

2025-06-12 02:57:32,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 02:57:32,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 02:57:32,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:57:32,922 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 02:57:32,922 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 02:57:33,062 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 02:57:33,062 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 02:58:16,192 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:58:16,196 - INFO - app.core.security - Redis connection closed.
2025-06-12 02:58:19,897 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 02:58:19,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 02:58:20,114 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 02:58:20,114 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 02:58:20,114 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 02:58:20,114 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 28, 20, 114426), 'iat': datetime.datetime(2025, 6, 12, 9, 58, 20, 114437)}
2025-06-12 02:58:20,115 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyNDEwMCwiaWF0IjoxNzQ5NzIyMzAwfQ._dgGJmAqNzJLDW1QaV-TyRnLHbtrxsEMFinP4FsGaYM

2025-06-12 02:58:23,068 - INFO - app.core.security - Closing Redis connection...
2025-06-12 02:58:23,070 - INFO - app.core.security - Redis connection closed.
2025-06-12 03:00:06,119 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 03:00:06,120 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 03:00:06,293 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 03:00:06,293 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 03:00:06,293 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 03:00:06,293 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 10, 30, 6, 293238), 'iat': datetime.datetime(2025, 6, 12, 10, 0, 6, 293249)}
2025-06-12 03:00:06,294 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTcyNDIwNiwiaWF0IjoxNzQ5NzIyNDA2fQ.A7-KuYR76xIfbPNrSpulC12nx382JWx4Fx268I9Fedk

2025-06-12 03:00:45,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 03:00:45,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 03:00:45,977 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 03:00:45,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749723437, 'iat': 1749721637}
2025-06-12 03:00:45,978 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 03:00:46,249 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 03:00:46,249 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 03:01:04,737 - INFO - app.core.security - Closing Redis connection...
2025-06-12 03:01:04,739 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:33:06,292 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:33:06,292 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:34:07,638 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:34:07,638 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:35:34,420 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:35:34,420 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:36:02,784 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:36:02,785 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:36:26,932 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:36:26,933 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:36:26,947 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:36:26,947 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:36:42,154 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:36:42,154 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:36:42,170 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:36:42,170 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:37:39,090 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:37:39,090 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:37:39,113 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:37:39,114 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:37:41,157 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:37:41,157 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:37:41,157 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:37:41,157 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 37, 41, 157119), 'iat': datetime.datetime(2025, 6, 12, 11, 37, 41, 157123)}
2025-06-12 04:37:41,157 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTg2MSwiaWF0IjoxNzQ5NzI4MjYxfQ.QwcA-Igo1YTmdfThVaRZCdG4MWA_75OXx-RifgGrcuQ

2025-06-12 04:37:41,209 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:37:41,209 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:37:41,209 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:37:41,209 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 37, 41, 209449), 'iat': datetime.datetime(2025, 6, 12, 11, 37, 41, 209454)}
2025-06-12 04:37:41,210 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTg2MSwiaWF0IjoxNzQ5NzI4MjYxfQ.QwcA-Igo1YTmdfThVaRZCdG4MWA_75OXx-RifgGrcuQ

2025-06-12 04:38:17,347 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:38:17,347 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:38:17,357 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:38:17,357 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:38:19,406 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:38:19,406 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:38:19,406 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:38:19,406 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 38, 19, 406285), 'iat': datetime.datetime(2025, 6, 12, 11, 38, 19, 406288)}
2025-06-12 04:38:19,406 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTg5OSwiaWF0IjoxNzQ5NzI4Mjk5fQ.Ze6OExX7or-bDBYdC87tOECS5KtiLJs7m2a4VIJVfp4

2025-06-12 04:38:19,406 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:38:19,406 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:38:19,406 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:38:19,406 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 38, 19, 406793), 'iat': datetime.datetime(2025, 6, 12, 11, 38, 19, 406795)}
2025-06-12 04:38:19,407 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTg5OSwiaWF0IjoxNzQ5NzI4Mjk5fQ.Ze6OExX7or-bDBYdC87tOECS5KtiLJs7m2a4VIJVfp4

2025-06-12 04:38:54,519 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:38:54,521 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:38:56,747 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:38:56,747 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:38:56,747 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:38:56,747 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 38, 56, 747555), 'iat': datetime.datetime(2025, 6, 12, 11, 38, 56, 747560)}
2025-06-12 04:38:56,749 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:38:56,749 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:38:56,749 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:38:56,749 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 38, 56, 749196), 'iat': datetime.datetime(2025, 6, 12, 11, 38, 56, 749204)}
2025-06-12 04:38:56,755 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTkzNiwiaWF0IjoxNzQ5NzI4MzM2fQ.-hj6pbc9ZcJwSlw1lOrnuu0EHDFPa5LkzU8lSRAXxbk

2025-06-12 04:38:56,756 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTkzNiwiaWF0IjoxNzQ5NzI4MzM2fQ.-hj6pbc9ZcJwSlw1lOrnuu0EHDFPa5LkzU8lSRAXxbk

2025-06-12 04:39:30,923 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:39:30,923 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:39:30,934 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:39:30,935 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:39:33,024 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:39:33,024 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:39:33,025 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:39:33,025 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 39, 33, 24761), 'iat': datetime.datetime(2025, 6, 12, 11, 39, 33, 24764)}
2025-06-12 04:39:33,025 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:39:33,025 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:39:33,025 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:39:33,025 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 39, 33, 25237), 'iat': datetime.datetime(2025, 6, 12, 11, 39, 33, 25240)}
2025-06-12 04:39:33,025 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTk3MywiaWF0IjoxNzQ5NzI4MzczfQ.B0ygdXtc6shArrFhufmqT-aFatRe4Uh0IhmhajM4clc

2025-06-12 04:39:33,025 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMTk3MywiaWF0IjoxNzQ5NzI4MzczfQ.B0ygdXtc6shArrFhufmqT-aFatRe4Uh0IhmhajM4clc

2025-06-12 04:39:58,177 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:39:58,177 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:40:00,226 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:40:00,226 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:40:00,226 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:40:00,226 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 40, 0, 226439), 'iat': datetime.datetime(2025, 6, 12, 11, 40, 0, 226442)}
2025-06-12 04:40:00,226 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjAwMCwiaWF0IjoxNzQ5NzI4NDAwfQ.JwWaDD7Qna9bkBJkNOUdQMdWN52efJnXcSMFiueewLk

2025-06-12 04:40:37,349 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:40:37,349 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:40:37,351 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:40:37,352 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:40:39,443 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:40:39,443 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:40:39,443 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:40:39,443 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 40, 39, 443396), 'iat': datetime.datetime(2025, 6, 12, 11, 40, 39, 443401)}
2025-06-12 04:40:39,444 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:40:39,444 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:40:39,444 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:40:39,444 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjAzOSwiaWF0IjoxNzQ5NzI4NDM5fQ.e64xG6Nzueshrw3H4MSrEibW-K1oVwxyyLVD5mbnZdw

2025-06-12 04:40:39,444 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjAzOSwiaWF0IjoxNzQ5NzI4NDM5fQ.e64xG6Nzueshrw3H4MSrEibW-K1oVwxyyLVD5mbnZdw

2025-06-12 04:40:54,344 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:40:54,344 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:40:54,395 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:40:54,395 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:40:56,424 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:40:56,424 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:40:56,424 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:40:56,424 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 40, 56, 424782), 'iat': datetime.datetime(2025, 6, 12, 11, 40, 56, 424787)}
2025-06-12 04:40:56,425 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjA1NiwiaWF0IjoxNzQ5NzI4NDU2fQ.-ja3Cu6UTaZVLVUCvk5kRoGUvTSazfmHGzgemlQ8sE4

2025-06-12 04:40:56,494 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:40:56,494 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:40:56,494 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:40:56,494 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 40, 56, 494588), 'iat': datetime.datetime(2025, 6, 12, 11, 40, 56, 494595)}
2025-06-12 04:40:56,495 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjA1NiwiaWF0IjoxNzQ5NzI4NDU2fQ.-ja3Cu6UTaZVLVUCvk5kRoGUvTSazfmHGzgemlQ8sE4

2025-06-12 04:41:09,938 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:41:09,938 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:41:09,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:41:09,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:41:09,975 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:41:09,975 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:41:09,975 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:41:09,975 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 41, 9, 975736), 'iat': datetime.datetime(2025, 6, 12, 11, 41, 9, 975739)}
2025-06-12 04:41:09,976 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjA2OSwiaWF0IjoxNzQ5NzI4NDY5fQ.epD10IGKtZdi3ydFUmZUeaF9AACGI81g761C09xFQuw

2025-06-12 04:41:09,977 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:41:09,977 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:41:09,977 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:41:09,977 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 41, 9, 977394), 'iat': datetime.datetime(2025, 6, 12, 11, 41, 9, 977397)}
2025-06-12 04:41:09,977 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjA2OSwiaWF0IjoxNzQ5NzI4NDY5fQ.epD10IGKtZdi3ydFUmZUeaF9AACGI81g761C09xFQuw

2025-06-12 04:41:51,739 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:41:51,739 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:41:51,740 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:41:51,740 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:41:54,738 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:41:54,738 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:41:54,799 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:41:54,799 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:41:54,799 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:41:54,799 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 41, 54, 799101), 'iat': datetime.datetime(2025, 6, 12, 11, 41, 54, 799110)}
2025-06-12 04:41:54,800 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjExNCwiaWF0IjoxNzQ5NzI4NTE0fQ.b6S4XDy_oycpM9e2kLTth5Gx3VqgWhwIPAc4AMrbInM

2025-06-12 04:41:54,806 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:41:54,807 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:41:54,883 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:41:54,883 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:41:54,883 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:41:54,883 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 41, 54, 883053), 'iat': datetime.datetime(2025, 6, 12, 11, 41, 54, 883060)}
2025-06-12 04:41:54,883 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjExNCwiaWF0IjoxNzQ5NzI4NTE0fQ.b6S4XDy_oycpM9e2kLTth5Gx3VqgWhwIPAc4AMrbInM

2025-06-12 04:42:40,124 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:42:40,125 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:42:40,133 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:42:40,133 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:42:42,170 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:42:42,170 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:42:42,174 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:42:42,175 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:42:42,202 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:42:42,202 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:42:42,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:42:42,202 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 42, 42, 202193), 'iat': datetime.datetime(2025, 6, 12, 11, 42, 42, 202199)}
2025-06-12 04:42:42,202 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjE2MiwiaWF0IjoxNzQ5NzI4NTYyfQ.YzcBx1rHVFuHgpdlL_qCmAVp_L7lj263SxqTovVGZIY

2025-06-12 04:42:42,207 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:42:42,207 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:42:42,207 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:42:42,207 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 42, 42, 207129), 'iat': datetime.datetime(2025, 6, 12, 11, 42, 42, 207132)}
2025-06-12 04:42:42,207 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjE2MiwiaWF0IjoxNzQ5NzI4NTYyfQ.YzcBx1rHVFuHgpdlL_qCmAVp_L7lj263SxqTovVGZIY

2025-06-12 04:44:00,975 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:44:00,977 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:44:00,980 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:44:00,981 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:44:05,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:44:05,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:44:05,270 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:44:05,271 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:44:05,306 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:44:05,306 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:44:05,306 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:44:05,306 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 44, 5, 306069), 'iat': datetime.datetime(2025, 6, 12, 11, 44, 5, 306073)}
2025-06-12 04:44:05,307 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjI0NSwiaWF0IjoxNzQ5NzI4NjQ1fQ.Lms-4eP244SfUtmJXtGk1KRyYaAWj0xtma4_b3MJIRk

2025-06-12 04:44:05,327 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:44:05,327 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:44:05,327 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:44:05,327 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 44, 5, 327724), 'iat': datetime.datetime(2025, 6, 12, 11, 44, 5, 327728)}
2025-06-12 04:44:05,328 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjI0NSwiaWF0IjoxNzQ5NzI4NjQ1fQ.Lms-4eP244SfUtmJXtGk1KRyYaAWj0xtma4_b3MJIRk

2025-06-12 04:46:45,255 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:46:45,255 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:46:45,256 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:46:45,256 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 12, 16, 45, 254893), 'iat': datetime.datetime(2025, 6, 12, 11, 46, 45, 254958)}
2025-06-12 04:46:45,257 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo

2025-06-12 04:46:45,258 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMzM2MDUsImlhdCI6MTc0OTcyODgwNX0.Ol8IDAQTipuJJErMb3dlMOVkIvt5X6yQ8JFlw8BOoC0, Expiry (seconds): 604800
2025-06-12 04:46:45,262 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 04:46:46,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:46,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:46,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,818 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:46:46,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:46,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:46,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,820 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:46:46,838 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:46:46,839 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:46,839 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:46,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:46,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:46,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,878 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,878 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:46:46,878 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:46,879 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:46,879 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,879 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,880 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:46:46,899 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:46:46,900 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:46,900 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:46,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:46,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:46,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,917 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:46,917 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:46:47,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:47,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:47,339 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:47,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:47,340 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:46:47,359 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:46:47,359 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:47,623 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:46:47,623 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:46:49,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:46:49,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:46:49,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:49,480 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:46:49,480 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:46:49,510 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:46:49,510 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:47:02,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:47:02,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:47:02,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:02,326 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:47:02,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:47:02,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:02,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:02,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:47:02,367 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:47:02,367 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:47:22,420 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:47:22,422 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:47:31,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:47:31,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:47:31,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:31,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:31,738 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:47:31,741 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:47:31,741 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:47:47,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:47:47,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:47:47,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:47,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:47:47,631 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:47:47,638 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:47:47,639 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:48:49,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:48:49,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:48:49,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:48:49,629 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:48:49,629 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:48:49,632 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:48:49,632 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:48:53,789 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:48:53,789 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:48:53,822 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:48:53,822 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:48:53,822 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:48:53,822 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 48, 53, 822786), 'iat': datetime.datetime(2025, 6, 12, 11, 48, 53, 822788)}
2025-06-12 04:48:53,823 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjUzMywiaWF0IjoxNzQ5NzI4OTMzfQ.3DD7DrqEqFXUwpm0PZOvf4itQqUFc6RTnamigqIJxFs

2025-06-12 04:49:34,307 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:49:34,307 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:49:34,308 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:49:34,308 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:49:36,858 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:49:36,858 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:49:36,886 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:49:36,886 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:49:36,886 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:49:36,886 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 49, 36, 886627), 'iat': datetime.datetime(2025, 6, 12, 11, 49, 36, 886630)}
2025-06-12 04:49:36,887 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjU3NiwiaWF0IjoxNzQ5NzI4OTc2fQ.Pt5iT3xRYf8d2chsHPwiNDzPmNya2UP239GFY6c89W4

2025-06-12 04:49:37,589 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:49:37,589 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:49:37,635 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:49:37,635 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:49:37,635 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:49:37,635 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 49, 37, 635083), 'iat': datetime.datetime(2025, 6, 12, 11, 49, 37, 635086)}
2025-06-12 04:49:37,636 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjU3NywiaWF0IjoxNzQ5NzI4OTc3fQ.RiyjYqTIwKw2TdJKUvdA1t79O8FTqJZAP4AWuY_5PWw

2025-06-12 04:49:38,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:49:38,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:49:38,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:49:38,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:49:38,637 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:49:38,704 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:49:38,704 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:49:57,356 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:49:57,356 - INFO - app.core.security - Redis connection closed.
.
2025-06-12 04:49:57,357 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:49:59,888 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:49:59,888 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:49:59,924 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:49:59,924 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:49:59,925 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:49:59,925 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:49:59,925 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:49:59,925 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 49, 59, 925589), 'iat': datetime.datetime(2025, 6, 12, 11, 49, 59, 925597)}
2025-06-12 04:49:59,926 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjU5OSwiaWF0IjoxNzQ5NzI4OTk5fQ.uy2DF7LDqHoG8r3ieLjCUUFzJS7ZeMMPMC85Y5pPoDU

2025-06-12 04:49:59,964 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:49:59,964 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:49:59,964 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:49:59,964 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 49, 59, 964181), 'iat': datetime.datetime(2025, 6, 12, 11, 49, 59, 964187)}
2025-06-12 04:49:59,964 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjU5OSwiaWF0IjoxNzQ5NzI4OTk5fQ.uy2DF7LDqHoG8r3ieLjCUUFzJS7ZeMMPMC85Y5pPoDU

2025-06-12 04:50:11,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:11,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:11,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:11,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:11,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:11,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:11,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:11,381 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:11,676 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:11,677 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:50:25,121 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:50:25,122 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:50:25,127 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:50:25,139 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:50:30,331 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:50:30,332 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:50:30,365 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:50:30,365 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:50:30,404 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:50:30,404 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:50:30,404 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:50:30,404 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 50, 30, 404030), 'iat': datetime.datetime(2025, 6, 12, 11, 50, 30, 404034)}
2025-06-12 04:50:30,405 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjYzMCwiaWF0IjoxNzQ5NzI5MDMwfQ._QDGXVHhAXt7n9M3nN4zB5WWkLP14K2CiJ1sTEb4G28

2025-06-12 04:50:30,444 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:50:30,444 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:50:30,444 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:50:30,444 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 50, 30, 444683), 'iat': datetime.datetime(2025, 6, 12, 11, 50, 30, 444688)}
2025-06-12 04:50:30,445 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjYzMCwiaWF0IjoxNzQ5NzI5MDMwfQ._QDGXVHhAXt7n9M3nN4zB5WWkLP14K2CiJ1sTEb4G28

2025-06-12 04:50:31,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:31,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:31,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:31,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:31,389 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:31,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:31,398 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:31,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:31,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:31,398 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:31,507 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:31,508 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:50:31,721 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:31,722 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:50:34,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:34,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:34,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:39,404 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:39,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:39,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:39,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:39,409 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:39,435 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:39,436 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:50:48,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:48,312 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:48,312 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:48,312 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:48,312 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:48,348 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:48,349 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:50:56,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:50:56,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:50:56,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:56,580 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:50:56,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:50:56,595 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:50:56,595 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:09,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:09,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:09,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:09,881 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:09,881 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:09,932 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:09,935 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:09,940 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:09,947 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:09,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:09,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:09,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:09,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:09,976 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,005 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,008 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,009 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,015 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,045 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,084 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,084 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,086 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,109 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,124 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,150 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,153 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,158 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,166 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,250 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,251 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,251 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,350 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,358 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,358 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,477 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,491 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,494 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,530 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:10,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:10,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,580 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:10,580 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:10,619 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,620 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,620 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,649 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,649 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,650 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,672 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,897 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,897 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,898 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,900 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,940 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,941 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,942 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,955 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:10,955 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:10,956 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,958 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:10,967 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:13,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:13,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:13,954 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:13,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:13,955 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:14,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:14,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,011 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,019 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:14,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:14,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,066 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:14,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:14,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,129 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:14,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:14,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,171 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,171 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:51:14,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:51:14,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749730605, 'iat': 1749728805}
2025-06-12 04:51:14,232 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:51:14,246 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,246 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,247 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,273 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,273 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,274 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,286 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,286 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,286 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,302 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,303 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,309 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,310 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,312 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,315 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,319 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,379 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,420 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:51:14,421 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:51:14,421 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,443 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,449 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:14,461 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzA2MDUsImlhdCI6MTc0OTcyODgwNX0.3xOeUm0adnV2mHsThQX4a5py9xQokMryYDkp4vOSedo
2025-06-12 04:51:46,797 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:51:46,797 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:51:46,829 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:51:46,829 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:51:46,829 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:51:46,829 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 51, 46, 829103), 'iat': datetime.datetime(2025, 6, 12, 11, 51, 46, 829105)}
2025-06-12 04:51:46,829 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMjcwNiwiaWF0IjoxNzQ5NzI5MTA2fQ.UR9fsBVxy3Vwcr3uga1nYV996MS4rOVHz1cH_OX3_7Y

2025-06-12 04:57:22,290 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:57:22,291 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:57:22,291 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:57:22,291 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 12, 27, 22, 290623), 'iat': datetime.datetime(2025, 6, 12, 11, 57, 22, 290638)}
2025-06-12 04:57:22,300 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzEyNDIsImlhdCI6MTc0OTcyOTQ0Mn0.kSc6u7HtTG8XsvKartBDhZUuEYwp2wZtE4-vAEYKTws

2025-06-12 04:57:22,301 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMzQyNDIsImlhdCI6MTc0OTcyOTQ0Mn0.k6Tf-PtDv0vG4s_y-gx_u9KO0umaPibHKqyrSO2RzgQ, Expiry (seconds): 604800
2025-06-12 04:57:22,308 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 04:57:23,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,378 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,378 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,378 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:57:23,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:57:23,387 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:57:23,387 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:23,387 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:23,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,404 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,404 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:57:23,404 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,405 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,405 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:57:23,410 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:57:23,410 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:23,410 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:23,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,415 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:57:23,423 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:57:23,423 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:23,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:23,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:23,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:23,777 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:57:23,783 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:57:23,783 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:57:24,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:24,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:24,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:24,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:57:24,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:57:24,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:24,208 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749731242, 'iat': 1749729442}
2025-06-12 04:57:24,208 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 04:57:24,214 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 04:57:24,214 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 04:59:03,076 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:03,077 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:03,077 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:03,077 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 3, 76591), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 3, 76610)}
2025-06-12 04:59:03,077 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDMsImlhdCI6MTc0OTcyOTU0M30.TkCJ7MCkuw0G0Ow8xJrP3PGy2QNZuWmxZXVfkpyKe1s

2025-06-12 04:59:03,080 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDMsImlhdCI6MTc0OTcyOTU0M30.DZR6bwSlle1NEvqHNul9_OZ7GGr8mzxhMsdtfqiAdWA, Expiry (seconds): 604800
2025-06-12 04:59:03,606 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:03,607 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:03,607 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:03,608 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 3, 606424), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 3, 606432)}
2025-06-12 04:59:03,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDMsImlhdCI6MTc0OTcyOTU0M30.TkCJ7MCkuw0G0Ow8xJrP3PGy2QNZuWmxZXVfkpyKe1s

2025-06-12 04:59:03,613 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDMsImlhdCI6MTc0OTcyOTU0M30.DZR6bwSlle1NEvqHNul9_OZ7GGr8mzxhMsdtfqiAdWA, Expiry (seconds): 604800
2025-06-12 04:59:04,126 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:04,126 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:04,126 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:04,127 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 4, 125966), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 4, 125981)}
2025-06-12 04:59:04,127 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDQsImlhdCI6MTc0OTcyOTU0NH0.LADyY7j0cH-j5uMzouYR8z28vY21jgjohhA1MXRZey4

2025-06-12 04:59:04,130 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDQsImlhdCI6MTc0OTcyOTU0NH0.eo4T4_vAao34ZoZJbr1Np6o9IVTNUzujViMi3xEDMzM, Expiry (seconds): 604800
2025-06-12 04:59:04,731 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:04,731 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:04,732 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:04,732 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 4, 731599), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 4, 731612)}
2025-06-12 04:59:04,732 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDQsImlhdCI6MTc0OTcyOTU0NH0.LADyY7j0cH-j5uMzouYR8z28vY21jgjohhA1MXRZey4

2025-06-12 04:59:04,733 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDQsImlhdCI6MTc0OTcyOTU0NH0.eo4T4_vAao34ZoZJbr1Np6o9IVTNUzujViMi3xEDMzM, Expiry (seconds): 604800
2025-06-12 04:59:04,772 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:04,783 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:04,801 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:04,833 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:05,586 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:05,586 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:05,586 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:05,586 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 5, 586166), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 5, 586177)}
2025-06-12 04:59:05,587 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDUsImlhdCI6MTc0OTcyOTU0NX0.ChXeKtKg2bUFa2mjnxP6zf3kf6bY87xRgDDgf4DiQH0

2025-06-12 04:59:05,587 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDUsImlhdCI6MTc0OTcyOTU0NX0.xfwyHPtZhHUsO4Y-dEIqjEADoJQ-6ENHqisay56WrzU, Expiry (seconds): 604800
2025-06-12 04:59:06,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:06,023 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:06,023 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:06,024 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 6, 22333), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 6, 22346)}
2025-06-12 04:59:06,024 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDYsImlhdCI6MTc0OTcyOTU0Nn0.KaHLIs1pXeuRsUwl4L1fCv6rT1-2_zGVayCYSTNMYQQ

2025-06-12 04:59:06,025 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDYsImlhdCI6MTc0OTcyOTU0Nn0.tbTmrweubuh7P241ud98PAw-58dpHleXyAxGM5HVlZQ, Expiry (seconds): 604800
2025-06-12 04:59:06,483 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:06,484 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:06,487 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:06,488 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 6, 483912), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 6, 483922)}
2025-06-12 04:59:06,488 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDYsImlhdCI6MTc0OTcyOTU0Nn0.KaHLIs1pXeuRsUwl4L1fCv6rT1-2_zGVayCYSTNMYQQ

2025-06-12 04:59:06,489 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDYsImlhdCI6MTc0OTcyOTU0Nn0.tbTmrweubuh7P241ud98PAw-58dpHleXyAxGM5HVlZQ, Expiry (seconds): 604800
2025-06-12 04:59:06,778 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:06,779 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:06,779 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:06,779 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 29, 6, 778852), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 6, 778862)}
2025-06-12 04:59:06,779 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzEzNDYsImlhdCI6MTc0OTcyOTU0Nn0.KaHLIs1pXeuRsUwl4L1fCv6rT1-2_zGVayCYSTNMYQQ

2025-06-12 04:59:06,779 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzQzNDYsImlhdCI6MTc0OTcyOTU0Nn0.tbTmrweubuh7P241ud98PAw-58dpHleXyAxGM5HVlZQ, Expiry (seconds): 604800
2025-06-12 04:59:06,780 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:06,782 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:06,785 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:06,792 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 04:59:13,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:13,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:13,789 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:13,789 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:13,789 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:59:13,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:13,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:13,790 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:13,790 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:13,790 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:13,799 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:13,799 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:13,799 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:14,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:14,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:14,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:14,283 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:14,283 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 04:59:14,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:14,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:14,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:14,283 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:14,283 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:14,290 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:14,290 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:14,291 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:15,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:15,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:15,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:15,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:15,083 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:15,088 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:15,088 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:15,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:15,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:15,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:15,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:15,565 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:15,577 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:15,577 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:16,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:16,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:16,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:17,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:17,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:17,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:17,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:17,075 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:17,093 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:17,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:31,846 - INFO - app.core.security - Closing Redis connection...
2025-06-12 04:59:31,851 - INFO - app.core.security - Redis connection closed.
2025-06-12 04:59:40,901 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 04:59:40,901 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 04:59:40,975 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 04:59:40,975 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 04:59:40,975 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 04:59:40,975 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 12, 59, 40, 975172), 'iat': datetime.datetime(2025, 6, 12, 11, 59, 40, 975178)}
2025-06-12 04:59:40,977 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczMzE4MCwiaWF0IjoxNzQ5NzI5NTgwfQ.tLfWi4ShqEtli6GFzE7vTPBA8gheoY30abVfm9YjtOI

2025-06-12 04:59:53,857 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:53,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:53,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:53,858 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:53,858 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:53,879 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:53,880 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 04:59:56,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 04:59:56,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 04:59:56,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:56,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 04:59:56,348 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 04:59:56,378 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 04:59:56,378 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:00:00,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:00:00,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:00:00,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:00:00,709 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:00:00,709 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:00:00,757 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:00:00,757 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:00:42,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:00:42,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:00:42,457 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:00:42,457 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:00:42,460 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:00:42,477 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:00:42,477 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:11:44,996 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:11:44,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:11:44,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:15:35,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:15:35,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:15:35,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:15:35,142 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:15:35,143 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:15:35,181 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:15:35,182 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:16:32,326 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:16:32,329 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:16:32,343 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:16:32,350 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:16:37,346 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:16:37,347 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:16:37,408 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:16:37,408 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:16:37,408 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:16:37,408 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 16, 37, 408086), 'iat': datetime.datetime(2025, 6, 12, 12, 16, 37, 408095)}
2025-06-12 05:16:37,409 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDE5NywiaWF0IjoxNzQ5NzMwNTk3fQ.SYWCSspQD6ju9vBWDzHsuzjTqNeRoRo_CNPSv4D9QNQ

2025-06-12 05:16:46,231 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:16:46,232 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:16:50,701 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:16:50,702 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:16:50,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:16:50,735 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:16:50,735 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:16:50,735 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 16, 50, 735313), 'iat': datetime.datetime(2025, 6, 12, 12, 16, 50, 735319)}
2025-06-12 05:16:50,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDIxMCwiaWF0IjoxNzQ5NzMwNjEwfQ.eXl932vQGH7vur2HPgLiZpkfTMM3zlcu3Vwu2X52Sdw

2025-06-12 05:17:57,798 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:17:57,799 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:18:00,730 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:00,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:18:00,737 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:18:00,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:18:00,737 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 18, 0, 736968), 'iat': datetime.datetime(2025, 6, 12, 12, 18, 0, 736971)}
2025-06-12 05:18:00,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDI4MCwiaWF0IjoxNzQ5NzMwNjgwfQ.RKKhmkLBQ3_r25u4ruco9im3PkZj7wnNvJY3Gc8VuIk

2025-06-12 05:18:16,414 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:25,431 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:30,448 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:35,469 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:40,807 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:53,286 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:18:53,295 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:18:53,295 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:18:53,295 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:18:53,295 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 18, 53, 295444), 'iat': datetime.datetime(2025, 6, 12, 12, 18, 53, 295447)}
2025-06-12 05:18:53,295 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDMzMywiaWF0IjoxNzQ5NzMwNzMzfQ.d2wSF-h1AMZju3KEQluofQSlOhzf-CIsqVc1Hx1jz6A

2025-06-12 05:19:36,755 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:19:36,762 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:19:36,762 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:19:36,762 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:19:36,762 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 19, 36, 762793), 'iat': datetime.datetime(2025, 6, 12, 12, 19, 36, 762796)}
2025-06-12 05:19:36,763 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDM3NiwiaWF0IjoxNzQ5NzMwNzc2fQ.7U3RwINlq3fRLCsP1DM77a4_TOy98y8ZgVPvfSrfBTk

2025-06-12 05:20:04,459 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:20:04,467 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:20:04,467 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:20:04,467 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:20:04,467 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 20, 4, 467157), 'iat': datetime.datetime(2025, 6, 12, 12, 20, 4, 467160)}
2025-06-12 05:20:04,467 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDQwNCwiaWF0IjoxNzQ5NzMwODA0fQ.UeUpLHgJCrtatpTBcXSTD_Sw3VwZhY90CdAGxxzwCg0

2025-06-12 05:20:24,924 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:20:24,937 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:20:24,937 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:20:24,937 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:20:24,937 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 20, 24, 937116), 'iat': datetime.datetime(2025, 6, 12, 12, 20, 24, 937118)}
2025-06-12 05:20:24,939 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDQyNCwiaWF0IjoxNzQ5NzMwODI0fQ.nSJVgDbBWgarBm0o_pj4-NuH6AUtyTGLO7xP-R8rX5Q

2025-06-12 05:20:59,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:20:59,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:20:59,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:20:59,942 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:20:59,942 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:20:59,942 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:20:59,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:20:59,943 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:20:59,943 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:20:59,943 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:00,186 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:00,186 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:00,187 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:00,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:00,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:00,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,322 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,322 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:21:00,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:00,323 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:00,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,323 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,323 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:00,332 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:00,332 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:00,332 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:00,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:00,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:00,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:00,394 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:00,511 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:00,511 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:01,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:01,407 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:01,407 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:01,407 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:01,407 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:01,415 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:01,417 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:01,428 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:21:02,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:02,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:02,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:02,015 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:02,015 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:02,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:02,025 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:06,478 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:21:11,502 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:21:11,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:21:11,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:21:11,760 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:11,760 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749731346, 'iat': 1749729546}
2025-06-12 05:21:11,760 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:21:11,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:21:11,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:21:11,768 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:21:26,833 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:21:55,270 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:22:07,253 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:22:07,260 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:07,260 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:07,260 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:07,260 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 7, 260452), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 7, 260454)}
2025-06-12 05:22:07,260 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDUyNywiaWF0IjoxNzQ5NzMwOTI3fQ.ary6FKfSdDCHFq2CoAgP-499rSVsn-Xq6Rs0nP2Y3yA

2025-06-12 05:22:18,661 - ERROR - app.core.security - Error connecting to Redis: name 'Redis' is not defined
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 132, in connect_to_redis
    redis_client = Redis.from_url(
                   ^^^^^
NameError: name 'Redis' is not defined
2025-06-12 05:22:37,563 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:22:37,563 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:22:37,604 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:37,604 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:37,604 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:37,604 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 37, 604006), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 37, 604009)}
2025-06-12 05:22:37,604 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDU1NywiaWF0IjoxNzQ5NzMwOTU3fQ.spqY0Bg2QO8zfxxf8YdXeHBJpa4YpnIQN1HJJvv4PSE

2025-06-12 05:22:37,610 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:22:37,610 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:22:37,653 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:37,653 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:37,653 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:37,653 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 37, 653456), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 37, 653459)}
2025-06-12 05:22:37,654 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDU1NywiaWF0IjoxNzQ5NzMwOTU3fQ.spqY0Bg2QO8zfxxf8YdXeHBJpa4YpnIQN1HJJvv4PSE

2025-06-12 05:22:39,908 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:22:39,908 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:22:39,909 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:22:39,909 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:22:42,151 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:22:42,151 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:22:42,182 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:22:42,182 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:22:42,202 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:42,202 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:42,202 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:42,202 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 42, 202728), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 42, 202732)}
2025-06-12 05:22:42,203 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDU2MiwiaWF0IjoxNzQ5NzMwOTYyfQ.-zMPXVui0yWt8CdVbSYJt2Rua7GOr9ER2HLdWxWu1Jk

2025-06-12 05:22:42,219 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:42,219 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:42,219 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:42,219 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 42, 219144), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 42, 219147)}
2025-06-12 05:22:42,219 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDU2MiwiaWF0IjoxNzQ5NzMwOTYyfQ.-zMPXVui0yWt8CdVbSYJt2Rua7GOr9ER2HLdWxWu1Jk

2025-06-12 05:22:51,485 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:22:51,485 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:22:56,304 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:22:56,304 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:22:56,357 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:22:56,357 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:22:56,357 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:22:56,357 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 22, 56, 357388), 'iat': datetime.datetime(2025, 6, 12, 12, 22, 56, 357391)}
2025-06-12 05:22:56,357 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNDU3NiwiaWF0IjoxNzQ5NzMwOTc2fQ.qJRCbylkLVbXwknn9QIwhFJ1iMq-d5-BZa4XKjoizLU

2025-06-12 05:24:40,088 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:24:40,088 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:24:40,088 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:24:40,088 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 12, 12, 54, 40, 88181), 'iat': datetime.datetime(2025, 6, 12, 12, 24, 40, 88186)}
2025-06-12 05:24:40,088 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk3MzI4ODAsImlhdCI6MTc0OTczMTA4MH0.W9qFqjHmOHZFIXHUZtwmNnKLYHH1fm7fzsa83mxTLxY

2025-06-12 05:24:40,088 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAzMzU4ODAsImlhdCI6MTc0OTczMTA4MH0.ovj9WHnHKBHl6iUjpy8_xrENVcgK7hLJNsx3gruqYxw, Expiry (seconds): 604800
2025-06-12 05:24:40,091 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-12 05:24:41,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,243 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,243 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:24:41,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,243 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:41,248 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:41,249 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,249 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,256 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,256 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,256 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:24:41,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,257 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,257 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:41,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,262 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:41,267 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:41,267 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,267 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,279 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:41,280 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,624 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:41,624 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:41,627 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:41,628 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:41,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:41,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:41,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:42,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:42,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:42,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:42,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:42,126 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:42,132 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:42,132 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:54,116 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:54,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:54,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:54,119 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:54,119 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:24:54,119 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:24:54,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:24:54,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:54,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:24:54,120 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:24:54,244 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:24:54,244 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:24:54,245 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:25:02,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:25:02,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:25:02,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:02,321 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:02,321 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:25:02,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:25:02,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:25:02,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:02,322 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:02,322 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:25:02,346 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:25:02,346 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:25:02,347 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:25:22,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:25:22,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:25:22,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:33,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:25:33,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:25:33,984 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:33,984 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:33,985 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:25:33,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:25:33,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:25:33,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:33,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:25:33,985 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:25:33,991 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:25:33,991 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:25:33,991 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:26:15,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:26:15,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:26:15,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:15,898 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:15,898 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:26:15,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:26:15,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:26:15,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:15,899 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:15,899 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:26:15,909 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:26:15,910 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:26:15,911 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:26:21,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:26:21,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:26:21,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:21,779 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:21,779 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:26:21,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:26:21,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:26:21,780 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:21,780 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:26:21,780 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:26:21,788 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:26:21,788 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:26:21,788 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:28:08,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:28:08,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:28:08,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:28:08,918 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:28:08,919 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:28:08,925 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:28:08,925 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:30:22,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:30:22,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:30:22,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:30:22,470 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749732880, 'iat': 1749731080}
2025-06-12 05:30:22,470 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-12 05:30:22,501 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-12 05:30:22,502 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-12 05:31:40,905 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:31:40,906 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:49:20,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:49:20,791 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:49:20,849 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:49:20,849 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:49:20,849 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:49:20,849 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 49, 20, 849447), 'iat': datetime.datetime(2025, 6, 12, 12, 49, 20, 849452)}
2025-06-12 05:49:20,850 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNjE2MCwiaWF0IjoxNzQ5NzMyNTYwfQ.3wldmUoRD59_9R6eyN2l6IGj_NKEWsLZBT84arpgC7I

2025-06-12 05:54:28,232 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:54:28,232 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:54:28,232 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:54:28,232 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 13, 24, 28, 232406), 'iat': datetime.datetime(2025, 6, 12, 12, 54, 28, 232415)}
2025-06-12 05:54:28,233 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3MzQ2NjgsImlhdCI6MTc0OTczMjg2OH0.fMIqPhHUa-HUb49cZY2MX3q0XYVNlt3B9LS5O31E68w

2025-06-12 05:54:28,233 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzMzc2NjgsImlhdCI6MTc0OTczMjg2OH0.-oyz4aVuI7xDQxK7_M2P_xFsKk6NhAKu4qrnGRbLwFs, Expiry (seconds): 604800
2025-06-12 05:54:28,243 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 05:54:45,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:54:45,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:54:45,339 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:21,422 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:55:21,422 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:55:21,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:21,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:21,422 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:55:21,436 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:55:21,436 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:55:30,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:55:30,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:55:30,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:30,168 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:30,168 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:55:30,176 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:55:30,176 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:55:46,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:55:46,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:55:46,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:46,219 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:46,220 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:55:46,228 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:55:46,228 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:55:53,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:55:53,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:55:53,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:53,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:55:53,582 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:55:53,590 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:55:53,591 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:56:05,859 - INFO - app.core.security - Closing Redis connection...
2025-06-12 05:56:05,860 - INFO - app.core.security - Redis connection closed.
2025-06-12 05:56:46,241 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 05:56:46,241 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 05:56:46,282 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 05:56:46,282 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 05:56:46,282 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 05:56:46,282 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 13, 56, 46, 282209), 'iat': datetime.datetime(2025, 6, 12, 12, 56, 46, 282215)}
2025-06-12 05:56:46,283 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTczNjYwNiwiaWF0IjoxNzQ5NzMzMDA2fQ.BKHFz25qB6wjWifJKsdcaKPYtckvbWTPt04QDrxDoQA

2025-06-12 05:57:19,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:57:19,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:57:19,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:57:45,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:57:45,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:57:45,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:57:45,570 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:57:45,570 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:57:45,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:57:45,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:57:45,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:57:45,572 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:57:45,573 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:57:45,590 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:57:45,590 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:57:45,590 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:58:10,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:58:10,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:58:10,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:10,129 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:10,130 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:58:10,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:58:10,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:58:10,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:10,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:10,131 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:58:10,146 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:58:10,147 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:58:10,148 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:58:20,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:58:20,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:58:20,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:20,915 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:20,915 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 05:58:20,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 05:58:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 05:58:20,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:20,916 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749734668, 'iat': 1749732868}
2025-06-12 05:58:20,916 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 05:58:20,943 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 05:58:20,943 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 05:58:20,943 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 06:05:17,848 - INFO - app.core.security - Closing Redis connection...
2025-06-12 06:05:17,849 - INFO - app.core.security - Redis connection closed.
2025-06-12 09:45:15,746 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 09:45:15,746 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 09:45:17,851 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:45:17,851 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:45:17,851 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:45:17,851 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 17, 45, 17, 851256), 'iat': datetime.datetime(2025, 6, 12, 16, 45, 17, 851261)}
2025-06-12 09:45:17,853 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MDMxNywiaWF0IjoxNzQ5NzQ2NzE3fQ.tb6zihzTNoB2TshyzXZyaeQpzklpt31zNTyXINqWLEE

2025-06-12 09:46:08,838 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 09:46:08,838 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 09:46:08,893 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:46:08,893 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:46:08,893 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:46:08,893 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 17, 46, 8, 893478), 'iat': datetime.datetime(2025, 6, 12, 16, 46, 8, 893484)}
2025-06-12 09:46:08,894 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MDM2OCwiaWF0IjoxNzQ5NzQ2NzY4fQ.Mpf2baO987ZRgqsm5fBC8dqs7qmHfgVeS1r-EldgOn0

2025-06-12 09:48:34,699 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:48:34,699 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:48:34,699 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:48:34,699 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 12, 17, 18, 34, 699625), 'iat': datetime.datetime(2025, 6, 12, 16, 48, 34, 699630)}
2025-06-12 09:48:34,700 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3NDg3MTQsImlhdCI6MTc0OTc0NjkxNH0.BhjSbxkjkDUNV8ws3j0kw1qZXgIIiZ2xmFfmngKYmaI

2025-06-12 09:48:34,700 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzNTE3MTQsImlhdCI6MTc0OTc0NjkxNH0.dOerg0tmGUtSrTxffAFKMbM0WVo-uG6jqbVAsJO_f_8, Expiry (seconds): 604800
2025-06-12 09:48:34,704 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 09:48:46,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 09:48:46,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 09:48:46,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749748714, 'iat': 1749746914}
2025-06-12 09:50:22,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 09:50:22,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 09:50:22,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749748714, 'iat': 1749746914}
2025-06-12 09:50:22,103 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749748714, 'iat': 1749746914}
2025-06-12 09:50:22,103 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 09:50:22,119 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 09:50:22,120 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 09:51:52,611 - INFO - app.core.security - Closing Redis connection...
2025-06-12 09:51:52,612 - INFO - app.core.security - Redis connection closed.
2025-06-12 09:51:55,637 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 09:51:55,637 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 09:51:55,704 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:51:55,704 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:51:55,704 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:51:55,704 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 17, 51, 55, 704353), 'iat': datetime.datetime(2025, 6, 12, 16, 51, 55, 704357)}
2025-06-12 09:51:55,705 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MDcxNSwiaWF0IjoxNzQ5NzQ3MTE1fQ.OI0SKmB24SuKvbnZH7sAY7zKF2AnIQYjQQzufPNXRiI

2025-06-12 09:54:31,848 - INFO - app.core.security - Closing Redis connection...
2025-06-12 09:54:31,849 - INFO - app.core.security - Redis connection closed.
2025-06-12 09:54:34,656 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 09:54:34,656 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 09:54:34,691 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:54:34,691 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:54:34,692 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:54:34,692 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 17, 54, 34, 691933), 'iat': datetime.datetime(2025, 6, 12, 16, 54, 34, 691936)}
2025-06-12 09:54:34,692 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MDg3NCwiaWF0IjoxNzQ5NzQ3Mjc0fQ.PY7DgKx2Si3A2arJuMPb5fvDTge2CtpL2vC95ge3PZE

2025-06-12 09:58:39,454 - INFO - app.core.security - Closing Redis connection...
2025-06-12 09:58:39,456 - INFO - app.core.security - Redis connection closed.
2025-06-12 09:58:42,203 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 09:58:42,204 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 09:58:42,263 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 09:58:42,263 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 09:58:42,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 09:58:42,263 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 17, 58, 42, 263091), 'iat': datetime.datetime(2025, 6, 12, 16, 58, 42, 263098)}
2025-06-12 09:58:42,264 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MTEyMiwiaWF0IjoxNzQ5NzQ3NTIyfQ.DMo_2d0dIwOfjl3dR0pyLzwzG8Cjn-jQJcB9GRQ67Mk

2025-06-12 09:58:52,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 09:58:52,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 09:58:52,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749748714, 'iat': 1749746914}
2025-06-12 09:58:52,237 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749748714, 'iat': 1749746914}
2025-06-12 09:58:52,237 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 09:58:52,253 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 09:58:52,255 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 10:00:04,878 - INFO - app.core.security - Closing Redis connection...
2025-06-12 10:00:04,880 - INFO - app.core.security - Redis connection closed.
2025-06-12 10:00:07,286 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 10:00:07,286 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 10:00:07,352 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 10:00:07,352 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 10:00:07,352 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 10:00:07,352 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 18, 0, 7, 352649), 'iat': datetime.datetime(2025, 6, 12, 17, 0, 7, 352653)}
2025-06-12 10:00:07,353 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MTIwNywiaWF0IjoxNzQ5NzQ3NjA3fQ.PvPNdKpBTVbJ8g_eWf8m0lMPgb_yaDKY9DIb3-rzdbM

2025-06-12 10:10:11,474 - INFO - app.core.security - Closing Redis connection...
2025-06-12 10:10:11,498 - INFO - app.core.security - Redis connection closed.
2025-06-12 10:10:16,015 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 10:10:16,016 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 10:10:16,114 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 10:10:16,114 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 10:10:16,114 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 10:10:16,114 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 12, 18, 10, 16, 114086), 'iat': datetime.datetime(2025, 6, 12, 17, 10, 16, 114089)}
2025-06-12 10:10:16,115 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc1MTgxNiwiaWF0IjoxNzQ5NzQ4MjE2fQ.xYjFhK6QmT4YDjuKq5IS02EDoJe0WF-BUA3F0UGFzJU

2025-06-12 10:12:41,620 - INFO - app.core.security - Closing Redis connection...
2025-06-12 10:12:41,620 - INFO - app.core.security - Redis connection closed.
2025-06-12 21:21:50,934 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 21:21:50,934 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 21:21:53,039 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:21:53,039 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:21:53,039 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:21:53,039 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 5, 21, 53, 39478), 'iat': datetime.datetime(2025, 6, 13, 4, 21, 53, 39481)}
2025-06-12 21:21:53,041 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5MjExMywiaWF0IjoxNzQ5Nzg4NTEzfQ.n4wT1QyV0qCAQyn1lLgsnQchA182X_SjGV324A9ru-M

2025-06-12 21:25:48,011 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 21:25:48,011 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 21:25:48,088 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:25:48,088 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:25:48,088 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:25:48,088 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 5, 25, 48, 88543), 'iat': datetime.datetime(2025, 6, 13, 4, 25, 48, 88546)}
2025-06-12 21:25:48,088 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5MjM0OCwiaWF0IjoxNzQ5Nzg4NzQ4fQ.jUQ9a76G2uN5UX8B2sE_xaAgeHdncbP9Le7CqJZxCgQ

2025-06-12 21:26:13,720 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:26:13,720 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:26:13,720 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:26:13,721 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 4, 56, 13, 720496), 'iat': datetime.datetime(2025, 6, 13, 4, 26, 13, 720507)}
2025-06-12 21:26:13,721 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTA1NzMsImlhdCI6MTc0OTc4ODc3M30.2jBhqivq4ckRK2acwVWHYAWZJclcsB3mDdUcNUi9Z40

2025-06-12 21:26:13,721 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzOTM1NzMsImlhdCI6MTc0OTc4ODc3M30.vl6LDltkJ2xi88IV-NAI_dl8TIA3TvCwr5U87qRUUzQ, Expiry (seconds): 604800
2025-06-12 21:26:13,725 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 21:26:25,857 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 21:26:25,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 21:26:25,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:26:25,860 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:26:25,860 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 21:26:25,872 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 21:26:25,874 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 21:26:58,237 - INFO - app.core.security - Closing Redis connection...
2025-06-12 21:26:58,237 - INFO - app.core.security - Redis connection closed.
2025-06-12 21:31:12,973 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 21:31:12,973 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 21:31:13,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:31:13,022 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:31:13,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:31:13,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 5, 31, 13, 22417), 'iat': datetime.datetime(2025, 6, 13, 4, 31, 13, 22421)}
2025-06-12 21:31:13,023 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5MjY3MywiaWF0IjoxNzQ5Nzg5MDczfQ.D3xNWbI_RYfgnHH9yP2OcwP8LIziSfsqR2OoQgFT-9M

2025-06-12 21:31:17,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 21:31:17,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 21:31:17,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:31:17,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:31:17,493 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 21:31:17,504 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 21:31:17,504 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 21:33:17,316 - INFO - app.core.security - Closing Redis connection...
2025-06-12 21:33:17,317 - INFO - app.core.security - Redis connection closed.
2025-06-12 21:37:06,205 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 21:37:06,206 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 21:37:06,277 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:37:06,277 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:37:06,277 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:37:06,277 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 5, 37, 6, 277305), 'iat': datetime.datetime(2025, 6, 13, 4, 37, 6, 277315)}
2025-06-12 21:37:06,278 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5MzAyNiwiaWF0IjoxNzQ5Nzg5NDI2fQ.Upy29YNEcsvTyrKOMcFqeoINoa92MoA8Onfq9lUol50

2025-06-12 21:37:11,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 21:37:11,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 21:37:11,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:37:11,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:37:11,657 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 21:37:11,705 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 21:37:11,706 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 21:37:28,950 - INFO - app.core.security - Closing Redis connection...
2025-06-12 21:37:28,951 - INFO - app.core.security - Redis connection closed.
2025-06-12 21:55:28,808 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 21:55:28,808 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 21:55:28,940 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 21:55:28,940 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 21:55:28,940 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 21:55:28,940 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 5, 55, 28, 940019), 'iat': datetime.datetime(2025, 6, 13, 4, 55, 28, 940026)}
2025-06-12 21:55:28,946 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDEyOCwiaWF0IjoxNzQ5NzkwNTI4fQ.SgfjnEp_s0VUQOf0emKf_mGm7mZOMYmsVYiADa41YM4

2025-06-12 21:56:10,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 21:56:10,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 21:56:10,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:56:10,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749790573, 'iat': 1749788773}
2025-06-12 21:56:10,453 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 21:56:10,465 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 21:56:10,466 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 21:57:07,211 - INFO - app.core.security - Closing Redis connection...
2025-06-12 21:57:07,212 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:05:34,020 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:05:34,020 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:05:34,104 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:05:34,104 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:05:34,104 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:05:34,104 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 5, 34, 104667), 'iat': datetime.datetime(2025, 6, 13, 5, 5, 34, 104672)}
2025-06-12 22:05:34,107 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDczNCwiaWF0IjoxNzQ5NzkxMTM0fQ.ushCL94cHK5fBSjvdYJwZUXdUNtdVsz5rVrZeKhWado

2025-06-12 22:06:18,479 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:06:18,480 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:06:23,223 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:06:23,223 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:06:23,279 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:06:23,280 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:06:23,280 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:06:23,280 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 6, 23, 279843), 'iat': datetime.datetime(2025, 6, 13, 5, 6, 23, 279857)}
2025-06-12 22:06:23,281 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDc4MywiaWF0IjoxNzQ5NzkxMTgzfQ.Jv3UPPH-s1h3GPVElO_JlHRNxwuK9fEiCoHmLvC0G8A

2025-06-12 22:07:16,317 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:07:16,318 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:07:20,227 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:07:20,227 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:07:20,298 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:07:20,299 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:07:20,299 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:07:20,299 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 7, 20, 298766), 'iat': datetime.datetime(2025, 6, 13, 5, 7, 20, 298777)}
2025-06-12 22:07:20,300 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDg0MCwiaWF0IjoxNzQ5NzkxMjQwfQ.Lxr27aMPISnYyUOU20NbzDA-ovRtP7YUVkaIWbFixA8

2025-06-12 22:07:41,686 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:07:41,686 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:07:46,424 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:07:46,424 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:07:46,471 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:07:46,471 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:07:46,471 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:07:46,471 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 7, 46, 471179), 'iat': datetime.datetime(2025, 6, 13, 5, 7, 46, 471185)}
2025-06-12 22:07:46,471 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDg2NiwiaWF0IjoxNzQ5NzkxMjY2fQ.rH6LkGxNvCK0MYYKeIkYtHT2MG9XoEIOOZReSqa4dnk

2025-06-12 22:08:00,262 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:08:00,262 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:08:04,295 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:08:04,295 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:08:04,347 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:08:04,347 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:08:04,347 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:08:04,347 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 8, 4, 347014), 'iat': datetime.datetime(2025, 6, 13, 5, 8, 4, 347017)}
2025-06-12 22:08:04,347 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDg4NCwiaWF0IjoxNzQ5NzkxMjg0fQ.lc-WgCLW1dPX7D7xxQvRwNhdFbwhacYZ59itSrLQD9Y

2025-06-12 22:08:16,468 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:08:16,469 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:08:24,555 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:08:24,555 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:08:24,644 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:08:24,644 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:08:24,644 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:08:24,644 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 8, 24, 644405), 'iat': datetime.datetime(2025, 6, 13, 5, 8, 24, 644414)}
2025-06-12 22:08:24,645 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDkwNCwiaWF0IjoxNzQ5NzkxMzA0fQ.DhPZcWj7NpEEE4lmPlipx4ohbh_Ucjt5eultII26bxg

2025-06-12 22:08:39,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:08:39,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:08:39,552 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-12 22:08:39,555 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-12 22:08:45,915 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:08:45,916 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:08:45,917 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:08:45,917 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 5, 38, 45, 915017), 'iat': datetime.datetime(2025, 6, 13, 5, 8, 45, 915035)}
2025-06-12 22:08:45,917 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTMxMjUsImlhdCI6MTc0OTc5MTMyNX0.5D-F5w8fv-FGxe-xOf0kz-lfdMn-1g8vtEKg0xQOWKw

2025-06-12 22:08:45,918 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzOTYxMjUsImlhdCI6MTc0OTc5MTMyNX0.x6hax7nLM1Jx77hDFDRSGM9lbPPVgHHy_wEn-cAkvT0, Expiry (seconds): 604800
2025-06-12 22:08:45,924 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 22:08:59,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:08:59,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:08:59,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793125, 'iat': 1749791325}
2025-06-12 22:08:59,220 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793125, 'iat': 1749791325}
2025-06-12 22:08:59,220 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:08:59,242 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:08:59,243 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:09:18,879 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:09:18,879 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:09:23,505 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:09:23,505 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:09:23,583 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:09:23,583 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:09:23,583 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:09:23,583 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 9, 23, 583506), 'iat': datetime.datetime(2025, 6, 13, 5, 9, 23, 583514)}
2025-06-12 22:09:23,584 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NDk2MywiaWF0IjoxNzQ5NzkxMzYzfQ.DkYgBg1NHvjd40xcZt-TI0QSeeznlX-xPJfTEgRVpNg

2025-06-12 22:10:39,904 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:10:39,906 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:13:22,722 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:13:22,722 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:13:22,822 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:13:22,823 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:13:22,823 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:13:22,823 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 13, 22, 822735), 'iat': datetime.datetime(2025, 6, 13, 5, 13, 22, 822745)}
2025-06-12 22:13:22,824 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NTIwMiwiaWF0IjoxNzQ5NzkxNjAyfQ.dTu-KObqAG8zVYiBwhM9QGsIuI3xaGZzrWfYB_9C4cw

2025-06-12 22:13:40,620 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:13:40,620 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:13:40,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:13:40,620 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 5, 43, 40, 620194), 'iat': datetime.datetime(2025, 6, 13, 5, 13, 40, 620204)}
2025-06-12 22:13:40,621 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTM0MjAsImlhdCI6MTc0OTc5MTYyMH0.-yRB07iNuh2GlHrXD5ck_SMA5jZrlTuYa7YZ0Q9t9No

2025-06-12 22:13:40,621 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzOTY0MjAsImlhdCI6MTc0OTc5MTYyMH0.dht0o5NkEYBjRxWUxkCtYZl4zx0nG9jj0U4fX4srorw, Expiry (seconds): 604800
2025-06-12 22:13:40,624 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 22:13:53,735 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:13:53,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:13:53,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793420, 'iat': 1749791620}
2025-06-12 22:13:53,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793420, 'iat': 1749791620}
2025-06-12 22:13:53,738 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:13:53,758 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:13:53,761 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:14:01,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:14:01,486 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:14:01,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793420, 'iat': 1749791620}
2025-06-12 22:14:01,488 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749793420, 'iat': 1749791620}
2025-06-12 22:14:01,488 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:14:01,503 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:14:01,503 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:23:03,116 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:23:03,117 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:23:07,180 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:23:07,180 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:23:07,276 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:23:07,276 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:23:07,276 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:23:07,276 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 23, 7, 276725), 'iat': datetime.datetime(2025, 6, 13, 5, 23, 7, 276732)}
2025-06-12 22:23:07,277 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NTc4NywiaWF0IjoxNzQ5NzkyMTg3fQ._JXIIXHyMT13eLESUpqjb9xsvihjXF4te-rw_fnyNmg

2025-06-12 22:24:13,042 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:24:13,042 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:24:16,156 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:24:16,156 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:24:16,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:24:16,196 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:24:16,196 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:24:16,197 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 24, 16, 196778), 'iat': datetime.datetime(2025, 6, 13, 5, 24, 16, 196786)}
2025-06-12 22:24:16,197 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NTg1NiwiaWF0IjoxNzQ5NzkyMjU2fQ.Vkf60-ZdKerUizVhJA3WImpjrPBHwStOKRG1z-mLTsw

2025-06-12 22:25:22,678 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:25:22,679 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:25:24,972 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:25:24,972 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:25:25,043 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:25:25,043 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:25:25,043 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:25:25,043 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 25, 25, 43242), 'iat': datetime.datetime(2025, 6, 13, 5, 25, 25, 43247)}
2025-06-12 22:25:25,044 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NTkyNSwiaWF0IjoxNzQ5NzkyMzI1fQ.Rt64HNsBofSh_79UiDcEs2DbATwiE0pTASiRb6C1PQQ

2025-06-12 22:25:59,643 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:25:59,644 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:26:34,186 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:26:34,186 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:26:34,219 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:26:34,219 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:26:34,219 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:26:34,219 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 26, 34, 219385), 'iat': datetime.datetime(2025, 6, 13, 5, 26, 34, 219387)}
2025-06-12 22:26:34,219 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NTk5NCwiaWF0IjoxNzQ5NzkyMzk0fQ.KjYcrCOZPpWu2RRqkTiPAkg6rFOC6ied-d5Lf4ZpCc4

2025-06-12 22:26:45,524 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:26:45,525 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:26:48,049 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:26:48,049 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:26:48,088 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:26:48,088 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:26:48,088 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:26:48,088 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 26, 48, 88719), 'iat': datetime.datetime(2025, 6, 13, 5, 26, 48, 88721)}
2025-06-12 22:26:48,089 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjAwOCwiaWF0IjoxNzQ5NzkyNDA4fQ.gFZacmSLZ4zuseHLP9y7raFcoJg7r83BrWHR2jn8Yu8

2025-06-12 22:28:10,508 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:28:10,509 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:29:40,016 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:29:40,016 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:29:40,062 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:29:40,062 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:29:40,062 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:29:40,062 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 29, 40, 62510), 'iat': datetime.datetime(2025, 6, 13, 5, 29, 40, 62513)}
2025-06-12 22:29:40,063 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjE4MCwiaWF0IjoxNzQ5NzkyNTgwfQ.CTTQSo4sE6D6elCpp5ord-fG5Thr3F9n6dro9m5rG8A

2025-06-12 22:30:50,763 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:30:50,764 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:30:52,542 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:30:52,542 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:30:52,562 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:30:52,563 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:30:52,563 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:30:52,563 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 30, 52, 562977), 'iat': datetime.datetime(2025, 6, 13, 5, 30, 52, 562979)}
2025-06-12 22:30:52,563 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjI1MiwiaWF0IjoxNzQ5NzkyNjUyfQ.530OK3D351koVgHHH45NI3wMunvx5kvka900FKQcs3Y

2025-06-12 22:33:06,416 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:33:06,416 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:33:08,438 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:33:08,438 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:33:08,489 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:33:08,489 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:33:08,489 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:33:08,489 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 33, 8, 489421), 'iat': datetime.datetime(2025, 6, 13, 5, 33, 8, 489425)}
2025-06-12 22:33:08,490 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjM4OCwiaWF0IjoxNzQ5NzkyNzg4fQ.XJXVgwtrtaqea_y7ZdybzusDszt9REH_mvr24J5iiX8

2025-06-12 22:33:37,470 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:33:37,470 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:33:37,513 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:33:37,513 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:33:37,513 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:33:37,513 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 33, 37, 513156), 'iat': datetime.datetime(2025, 6, 13, 5, 33, 37, 513162)}
2025-06-12 22:33:37,514 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjQxNywiaWF0IjoxNzQ5NzkyODE3fQ.3X3hyid5HyQu9vu9ZJV1J4o2n7MbhwIiZm6wTKGuXmY

2025-06-12 22:34:03,783 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:34:03,784 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:34:03,791 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:34:03,791 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:34:06,125 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:34:06,125 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:34:06,135 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:34:06,135 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:34:06,154 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:34:06,154 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:34:06,154 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:34:06,154 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 34, 6, 154055), 'iat': datetime.datetime(2025, 6, 13, 5, 34, 6, 154059)}
2025-06-12 22:34:06,154 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjQ0NiwiaWF0IjoxNzQ5NzkyODQ2fQ.rJhE_7tbawGQwTCkG1xC8Giw-IPM-3Isc_-M9fF3ZIg

2025-06-12 22:34:06,158 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:34:06,158 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:34:06,158 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:34:06,158 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 34, 6, 158600), 'iat': datetime.datetime(2025, 6, 13, 5, 34, 6, 158603)}
2025-06-12 22:34:06,159 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjQ0NiwiaWF0IjoxNzQ5NzkyODQ2fQ.rJhE_7tbawGQwTCkG1xC8Giw-IPM-3Isc_-M9fF3ZIg

2025-06-12 22:42:00,629 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:42:00,629 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:42:00,684 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:42:00,684 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:42:00,684 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:42:00,684 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 42, 0, 684215), 'iat': datetime.datetime(2025, 6, 13, 5, 42, 0, 684219)}
2025-06-12 22:42:00,685 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NjkyMCwiaWF0IjoxNzQ5NzkzMzIwfQ.6Eg3DN60mGRkhk7PBBk3UHaNhqtlaPIQ5nEyZWEwTOQ

2025-06-12 22:42:06,519 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:42:06,519 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:42:06,519 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:42:06,520 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 6, 12, 6, 519085), 'iat': datetime.datetime(2025, 6, 13, 5, 42, 6, 519096)}
2025-06-12 22:42:06,520 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTUxMjYsImlhdCI6MTc0OTc5MzMyNn0.d6Y_WjbRKX11ekwP4QRRikglZQ3o9GKzBziRxjU_2H0

2025-06-12 22:42:06,520 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzOTgxMjYsImlhdCI6MTc0OTc5MzMyNn0.EBtAE2mXW78j_7p464L23sViFLSZazGhfJmrgr45y8E, Expiry (seconds): 604800
2025-06-12 22:42:06,525 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 22:44:02,003 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:44:02,004 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:44:27,316 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:44:27,316 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:44:27,316 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:44:27,316 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:44:29,725 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:44:29,725 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:44:29,732 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:44:29,732 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:44:29,762 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:44:29,762 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:44:29,762 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:44:29,762 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:44:29,762 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:44:29,762 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:44:29,762 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 44, 29, 762399), 'iat': datetime.datetime(2025, 6, 13, 5, 44, 29, 762402)}
2025-06-12 22:44:29,762 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 44, 29, 762410), 'iat': datetime.datetime(2025, 6, 13, 5, 44, 29, 762412)}
2025-06-12 22:44:29,762 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzA2OSwiaWF0IjoxNzQ5NzkzNDY5fQ.FtY2YJwndVwZ0Wa8Rlpg2160fxW0bcOWHP9EdfaZbfE

2025-06-12 22:44:29,762 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzA2OSwiaWF0IjoxNzQ5NzkzNDY5fQ.FtY2YJwndVwZ0Wa8Rlpg2160fxW0bcOWHP9EdfaZbfE

2025-06-12 22:44:52,682 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:44:52,682 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:44:52,682 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:44:52,683 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:44:54,700 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:44:54,700 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:44:54,700 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:44:54,700 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:44:54,733 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:44:54,733 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:44:54,733 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:44:54,733 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 44, 54, 733252), 'iat': datetime.datetime(2025, 6, 13, 5, 44, 54, 733254)}
2025-06-12 22:44:54,733 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzA5NCwiaWF0IjoxNzQ5NzkzNDk0fQ.6Z51dz0CwGOB_lIwgsJpBnt85p1w6Txg9nOgRergqvQ

2025-06-12 22:44:54,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:44:54,746 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:44:54,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:44:54,746 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 44, 54, 746761), 'iat': datetime.datetime(2025, 6, 13, 5, 44, 54, 746764)}
2025-06-12 22:44:54,747 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzA5NCwiaWF0IjoxNzQ5NzkzNDk0fQ.6Z51dz0CwGOB_lIwgsJpBnt85p1w6Txg9nOgRergqvQ

2025-06-12 22:45:18,172 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:45:18,173 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:45:18,174 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:45:18,174 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:45:20,211 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:45:20,211 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:45:20,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:45:20,213 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:45:20,240 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:45:20,240 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:45:20,240 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:45:20,240 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:45:20,240 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:45:20,240 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:45:20,241 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 45, 20, 240759), 'iat': datetime.datetime(2025, 6, 13, 5, 45, 20, 240762)}
2025-06-12 22:45:20,241 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 45, 20, 240831), 'iat': datetime.datetime(2025, 6, 13, 5, 45, 20, 240834)}
2025-06-12 22:45:20,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzEyMCwiaWF0IjoxNzQ5NzkzNTIwfQ.RuVUd3vZvuoYJiOCNwkQCzeXcX-gEXchCI8occzBKNM

2025-06-12 22:46:18,184 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:46:18,184 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:46:18,185 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:46:18,185 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:46:20,231 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:20,231 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:20,232 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:20,232 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:20,265 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:20,265 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:20,265 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:20,265 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 20, 265106), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 20, 265109)}
2025-06-12 22:46:20,265 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:20,265 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:20,265 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:20,265 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 20, 265193), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 20, 265195)}
2025-06-12 22:46:20,265 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzE4MCwiaWF0IjoxNzQ5NzkzNTgwfQ.5ZkybTA8cIeqLkK7LDYuy4zVWWcDyWyzZWT_E-Tht9c

2025-06-12 22:46:20,265 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzE4MCwiaWF0IjoxNzQ5NzkzNTgwfQ.5ZkybTA8cIeqLkK7LDYuy4zVWWcDyWyzZWT_E-Tht9c

2025-06-12 22:46:31,516 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:31,516 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:31,548 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:31,548 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:31,548 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:31,548 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 31, 548056), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 31, 548061)}
2025-06-12 22:46:31,549 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzE5MSwiaWF0IjoxNzQ5NzkzNTkxfQ.SPCVcDSZfhquQeTfkYxjvoxtcBU2w6tFQ8XI4UDgdvA

2025-06-12 22:46:52,705 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:46:52,705 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:46:52,706 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:46:52,706 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:46:52,706 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:46:52,706 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:46:55,048 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:55,049 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:55,078 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:55,078 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:55,078 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:55,078 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 55, 78392), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 55, 78399)}
2025-06-12 22:46:55,079 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzIxNSwiaWF0IjoxNzQ5NzkzNjE1fQ.ZY1GnjZ6yoJbWHGVZ-6cf_cXUcH72ZDm0snmz99Fa7I

2025-06-12 22:46:55,095 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:55,095 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:55,100 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:46:55,100 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:46:55,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:55,124 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:55,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:55,124 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 55, 124246), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 55, 124250)}
2025-06-12 22:46:55,124 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzIxNSwiaWF0IjoxNzQ5NzkzNjE1fQ.ZY1GnjZ6yoJbWHGVZ-6cf_cXUcH72ZDm0snmz99Fa7I

2025-06-12 22:46:55,128 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:46:55,128 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:46:55,128 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:46:55,128 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 46, 55, 128483), 'iat': datetime.datetime(2025, 6, 13, 5, 46, 55, 128488)}
2025-06-12 22:46:55,129 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzIxNSwiaWF0IjoxNzQ5NzkzNjE1fQ.ZY1GnjZ6yoJbWHGVZ-6cf_cXUcH72ZDm0snmz99Fa7I

2025-06-12 22:47:45,695 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:45,696 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:45,697 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:45,698 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:45,703 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:45,704 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:48,522 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:48,522 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:48,529 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:48,529 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:48,529 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:48,530 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:48,574 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:48,574 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:48,574 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:48,574 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 48, 574649), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 48, 574652)}
2025-06-12 22:47:48,575 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI2OCwiaWF0IjoxNzQ5NzkzNjY4fQ.wk7ENR8J-wOobf_hybejgc1fIQyfsMMBCDBgk2OsYgs

2025-06-12 22:47:48,579 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:48,579 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:48,579 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:48,579 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 48, 579303), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 48, 579306)}
2025-06-12 22:47:48,579 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI2OCwiaWF0IjoxNzQ5NzkzNjY4fQ.wk7ENR8J-wOobf_hybejgc1fIQyfsMMBCDBgk2OsYgs

2025-06-12 22:47:48,582 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:48,582 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:48,582 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:48,582 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 48, 582085), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 48, 582090)}
2025-06-12 22:47:48,582 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI2OCwiaWF0IjoxNzQ5NzkzNjY4fQ.wk7ENR8J-wOobf_hybejgc1fIQyfsMMBCDBgk2OsYgs

2025-06-12 22:47:50,288 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:50,288 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:50,288 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:50,289 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:50,294 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:47:50,295 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:47:54,171 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:54,173 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:54,270 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:54,270 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:54,271 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:54,271 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 54, 270758), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 54, 270768)}
2025-06-12 22:47:54,272 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI3NCwiaWF0IjoxNzQ5NzkzNjc0fQ.mcQzOas5MFfS1GV-ehJl217RuWGHKUCb21WCynmxzSc

2025-06-12 22:47:54,290 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:54,291 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:54,328 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:47:54,329 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:47:54,388 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:54,388 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:54,388 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:54,388 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 54, 387986), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 54, 387995)}
2025-06-12 22:47:54,389 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI3NCwiaWF0IjoxNzQ5NzkzNjc0fQ.mcQzOas5MFfS1GV-ehJl217RuWGHKUCb21WCynmxzSc

2025-06-12 22:47:54,409 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:47:54,409 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:47:54,409 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:47:54,409 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 47, 54, 409490), 'iat': datetime.datetime(2025, 6, 13, 5, 47, 54, 409502)}
2025-06-12 22:47:54,411 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI3NCwiaWF0IjoxNzQ5NzkzNjc0fQ.mcQzOas5MFfS1GV-ehJl217RuWGHKUCb21WCynmxzSc

2025-06-12 22:48:08,688 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:48:08,689 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:48:08,727 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:48:08,727 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:48:08,727 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:48:08,727 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 48, 8, 727666), 'iat': datetime.datetime(2025, 6, 13, 5, 48, 8, 727670)}
2025-06-12 22:48:08,728 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzI4OCwiaWF0IjoxNzQ5NzkzNjg4fQ.dwkxya402RvCidFuU0s0883XdgdKPxavxdVy75bc4WU

2025-06-12 22:48:50,519 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:48:50,519 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:48:50,523 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:48:50,523 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:48:50,523 - INFO - app.core.security - Closing Redis connection...
2025-06-12 22:48:50,523 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:48:50,523 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:48:50,523 - INFO - app.core.security - Redis connection closed.
2025-06-12 22:48:53,299 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:48:53,300 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:48:53,316 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:48:53,316 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:48:53,334 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:48:53,335 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:48:53,336 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 22:48:53,337 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 22:48:53,340 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:48:53,340 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:48:53,340 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:48:53,340 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 48, 53, 340107), 'iat': datetime.datetime(2025, 6, 13, 5, 48, 53, 340111)}
2025-06-12 22:48:53,340 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzMzMywiaWF0IjoxNzQ5NzkzNzMzfQ.U7pzx70CUw0TrDnA0e8xL8aHlVDQo_Q0pcfChn1Oe9Y

2025-06-12 22:48:53,351 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:48:53,351 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:48:53,352 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:48:53,352 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 48, 53, 351838), 'iat': datetime.datetime(2025, 6, 13, 5, 48, 53, 351844)}
2025-06-12 22:48:53,352 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzMzMywiaWF0IjoxNzQ5NzkzNzMzfQ.U7pzx70CUw0TrDnA0e8xL8aHlVDQo_Q0pcfChn1Oe9Y

2025-06-12 22:48:53,385 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:48:53,385 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:48:53,386 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
X3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:48:53,386 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:48:53,386 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 48, 53, 385628), 'iat': datetime.datetime(2025, 6, 13, 5, 48, 53, 385638)}
2025-06-12 22:48:53,386 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 6, 48, 53, 385664), 'iat': datetime.datetime(2025, 6, 13, 5, 48, 53, 385671)}
2025-06-12 22:48:53,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzMzMywiaWF0IjoxNzQ5NzkzNzMzfQ.U7pzx70CUw0TrDnA0e8xL8aHlVDQo_Q0pcfChn1Oe9Y

2025-06-12 22:48:53,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5NzMzMywiaWF0IjoxNzQ5NzkzNzMzfQ.U7pzx70CUw0TrDnA0e8xL8aHlVDQo_Q0pcfChn1Oe9Y

2025-06-12 22:51:48,000 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 22:51:48,000 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 22:51:48,000 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 22:51:48,000 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 6, 21, 48, 30), 'iat': datetime.datetime(2025, 6, 13, 5, 51, 48, 38)}
2025-06-12 22:51:48,000 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTU3MDgsImlhdCI6MTc0OTc5MzkwOH0.BbnC1DASB1RU-pH5aQVXQBTKd7n_6YjjGyukLMIUUI4

2025-06-12 22:51:48,001 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAzOTg3MDgsImlhdCI6MTc0OTc5MzkwOH0.Hd64cN4N4aABL5tc1Pu8VH6kQ2rJeO5cFHQ5nxMxl_s, Expiry (seconds): 604800
2025-06-12 22:51:48,003 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 22:51:58,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:51:58,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:51:58,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:52:41,417 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:52:41,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:52:41,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:52:41,418 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:52:41,418 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:52:41,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:52:41,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:52:41,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:52:41,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:52:41,419 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:52:41,425 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:52:41,426 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:52:41,426 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:10,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:10,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:10,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:10,627 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:10,627 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:10,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:10,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:10,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:10,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:10,628 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:10,633 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:10,633 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:10,634 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:32,264 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:32,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:32,265 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:32,265 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:32,265 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:32,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:32,265 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:32,265 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:32,265 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:32,265 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:32,269 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:32,269 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:32,269 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:34,729 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:34,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:34,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:34,730 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:34,730 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:34,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:34,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:34,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:34,730 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:34,730 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:34,734 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:34,734 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:34,735 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:44,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:44,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:44,260 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:44,260 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:44,260 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:44,260 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:44,260 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:44,261 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:44,261 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:44,261 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:44,265 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:44,265 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:44,265 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:50,416 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:50,416 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:50,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:50,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:50,416 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:50,419 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:50,420 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:50,420 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:55,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:55,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:55,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:55,807 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:55,807 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:53:55,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:53:55,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:53:55,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:55,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:53:55,808 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:53:55,811 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:53:55,811 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:53:55,812 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:54:01,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:54:01,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:54:01,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:54:01,594 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:54:01,594 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 22:54:01,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:54:01,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:54:01,594 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:54:01,594 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:54:01,594 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:54:01,598 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:54:01,598 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:54:01,599 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:56:16,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:56:16,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:56:16,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:16,384 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:16,384 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:56:16,393 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:56:16,393 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:56:28,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:56:28,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:56:28,652 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:28,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:28,653 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:56:28,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:56:28,662 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:56:41,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:56:41,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:56:41,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:41,022 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:41,022 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:56:41,026 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:56:41,026 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:56:52,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:56:52,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:56:52,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:52,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:56:52,300 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:56:52,311 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:56:52,312 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 22:57:09,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:57:09,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:57:09,371 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-12 22:57:09,374 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-12 22:57:17,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 22:57:17,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 22:57:17,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:57:17,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749795708, 'iat': 1749793908}
2025-06-12 22:57:17,617 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 22:57:17,622 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 22:57:17,622 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:29:49,609 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:29:49,609 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:29:49,706 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:29:49,706 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:29:49,706 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:29:49,706 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 29, 49, 706075), 'iat': datetime.datetime(2025, 6, 13, 6, 29, 49, 706081)}
2025-06-12 23:29:49,708 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5OTc4OSwiaWF0IjoxNzQ5Nzk2MTg5fQ.m0OFsswYQP9yoB67SC7DGaumMZmBr8CsYNzFo-dr6J8

2025-06-12 23:31:27,642 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:31:27,643 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:31:27,678 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:31:27,679 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:31:27,679 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:31:27,684 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:31:27,689 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:31:27,689 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:31:27,690 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:31:27,700 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:31:31,920 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:31:31,920 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:31:32,017 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:31:32,017 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:32,017 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:32,017 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 31, 32, 17002), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 32, 17009)}
2025-06-12 23:31:32,018 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5OTg5MiwiaWF0IjoxNzQ5Nzk2MjkyfQ.1bGgm3DPTNFO_ykTnWHsRM5_pD0onivEl7a0herss_g

2025-06-12 23:31:33,080 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:31:33,080 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:31:33,080 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:31:33,081 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:31:33,081 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:31:33,081 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:31:33,121 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:31:33,121 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:31:33,122 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 31, 33, 121961), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 33, 121964)}
2025-06-12 23:31:33,122 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 31, 33, 121979), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 33, 121982)}
2025-06-12 23:31:33,122 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 31, 33, 121961), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 33, 121964)}
2025-06-12 23:31:33,122 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:31:33,122 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:33,122 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 31, 33, 122140), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 33, 122142)}
2025-06-12 23:31:33,123 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTc5OTg5MywiaWF0IjoxNzQ5Nzk2MjkzfQ.QpIThhRgXYrW__abKFsmyx6FCNaJc5sEnBHczFzcosA

2025-06-12 23:31:34,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:31:34,600 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:31:34,600 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:31:34,600 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 7, 1, 34, 599955), 'iat': datetime.datetime(2025, 6, 13, 6, 31, 34, 599960)}
2025-06-12 23:31:34,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTgwOTQsImlhdCI6MTc0OTc5NjI5NH0.ZCeUG45AMcRc8k-Dzgt_hzUX3_Yr_a-RjQm35g6C6ZA

2025-06-12 23:31:34,600 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MDEwOTQsImlhdCI6MTc0OTc5NjI5NH0.BdYupWVzR04qBN-uj-dcZUmPejQ9dQTaXzMfaa2ZUmo, Expiry (seconds): 604800
2025-06-12 23:31:34,605 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 23:31:35,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:35,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:35,876 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,876 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,876 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:31:35,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:35,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:35,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,877 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:35,903 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:35,903 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:35,903 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:35,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:35,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:35,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,919 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,919 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:31:35,920 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:35,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:35,920 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,920 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:35,934 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:35,934 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:35,935 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:35,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:35,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:35,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,942 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:35,942 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:35,950 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:35,950 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:36,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:36,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:36,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:36,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:36,445 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:36,455 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:36,455 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:36,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:36,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:36,467 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:37,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:37,338 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:37,339 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:37,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:37,340 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:37,349 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:37,349 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:38,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:38,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:38,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:38,518 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:38,518 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:38,543 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:38,543 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:45,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:45,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:45,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:45,516 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:45,516 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:45,544 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:45,544 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:48,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:48,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:48,723 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:48,723 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:48,723 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:48,759 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:48,759 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:31:57,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:31:57,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:31:57,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:57,698 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:31:57,698 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:31:57,718 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:31:57,718 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:01,161 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:01,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:01,162 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:32:01,162 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:32:01,162 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:01,169 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:01,170 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:14,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:14,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:14,840 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:32:14,841 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798094, 'iat': 1749796294}
2025-06-12 23:32:14,841 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:14,848 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:14,848 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:14,849 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTgwOTQsImlhdCI6MTc0OTc5NjI5NH0.ZCeUG45AMcRc8k-Dzgt_hzUX3_Yr_a-RjQm35g6C6ZA
2025-06-12 23:32:14,851 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTgwOTQsImlhdCI6MTc0OTc5NjI5NH0.ZCeUG45AMcRc8k-Dzgt_hzUX3_Yr_a-RjQm35g6C6ZA
2025-06-12 23:32:32,702 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:32:32,703 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:32:32,703 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:32:32,703 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 7, 2, 32, 702819), 'iat': datetime.datetime(2025, 6, 13, 6, 32, 32, 702829)}
2025-06-12 23:32:32,703 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk3OTgxNTIsImlhdCI6MTc0OTc5NjM1Mn0.f2iXmQBcKjV2QWQbSpN8fCzqhXhO7s80xNDgBMIP8ws

2025-06-12 23:32:32,704 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MDExNTIsImlhdCI6MTc0OTc5NjM1Mn0.2TJRdaWMnvo7oOfxDehRtFp6m63e6cxKJ6NMSdZYf2o, Expiry (seconds): 604800
2025-06-12 23:32:32,715 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-12 23:32:33,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:33,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:33,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,891 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,891 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:32:33,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:33,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:33,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,891 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,891 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:33,906 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:33,907 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:33,907 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:33,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:33,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:33,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,923 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,923 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:32:33,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:33,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:33,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,923 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:33,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:33,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:33,940 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,940 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:33,940 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:33,957 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:33,957 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:33,958 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:33,972 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:33,972 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:34,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:34,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:34,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:34,044 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:34,044 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:34,066 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:34,066 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:34,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:34,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:34,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:34,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:34,732 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:34,738 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:34,739 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:34,838 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:34,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:34,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:35,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:35,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:35,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:35,959 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:35,960 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:35,980 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:35,980 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:32:39,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:32:39,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:32:39,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:39,867 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:32:39,867 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:32:39,929 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:32:39,929 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:18,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:18,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:18,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:18,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:18,432 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:18,436 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:18,437 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:34,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:34,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:34,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:34,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:34,051 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:34,058 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:34,058 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,780 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,780 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:58,786 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:58,786 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,791 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,791 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:33:58,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,792 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,792 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:58,805 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:58,805 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,805 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,811 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,811 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:33:58,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,812 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,812 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:58,816 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:58,816 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,816 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:58,977 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:58,977 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:58,978 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,978 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:58,978 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:58,982 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:58,983 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:59,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:59,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:59,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:59,223 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:59,223 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:59,226 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:59,226 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:33:59,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:59,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:59,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:59,560 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:33:59,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:33:59,561 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:59,561 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:33:59,561 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:33:59,566 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:33:59,566 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:34:58,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:34:58,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:34:58,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:34:58,784 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:34:58,785 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:34:58,800 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:34:58,800 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:35:58,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:35:58,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:35:58,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:35:58,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:35:58,786 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:35:58,799 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:35:58,799 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:36:20,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:36:20,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:36:20,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:36:20,764 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:36:20,764 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:36:20,782 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:36:20,782 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:36:58,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:36:58,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:36:58,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:36:58,786 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:36:58,786 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:36:58,789 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:36:58,789 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:38:01,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:38:01,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:38:01,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:38:01,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:38:01,877 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:38:01,881 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:38:01,881 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:38:04,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:38:04,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:38:04,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:38:04,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:38:04,912 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:38:04,921 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:38:04,921 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:40:19,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:40:19,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:40:19,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:40:19,180 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:40:19,180 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:40:19,200 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:40:19,201 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:42:48,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:42:48,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:42:48,638 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:42:48,638 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:42:48,638 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:42:48,644 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:42:48,644 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:43:37,553 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:43:37,560 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:45:42,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:45:42,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:45:42,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:46:59,213 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:46:59,214 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:46:59,288 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:46:59,288 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:46:59,288 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:46:59,288 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 46, 59, 288617), 'iat': datetime.datetime(2025, 6, 13, 6, 46, 59, 288622)}
2025-06-12 23:46:59,289 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDgxOSwiaWF0IjoxNzQ5Nzk3MjE5fQ.GWeBmX35iC-ZCbCorEUnMQWNYVwfWP4pbKmhjbYFAQw

2025-06-12 23:47:09,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:47:09,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:47:09,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:47:09,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:47:09,160 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:47:09,168 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:47:09,168 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:47:27,827 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:47:27,828 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:47:27,889 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:47:27,890 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:47:27,895 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:47:27,895 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:47:27,900 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:47:27,903 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:47:27,908 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:47:27,910 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:47:31,606 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:47:31,606 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:47:31,649 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:47:31,649 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:47:31,649 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:47:31,649 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 31, 649206), 'iat': datetime.datetime(2025, 6, 13, 6, 47, 31, 649210)}
2025-06-12 23:47:31,649 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg1MSwiaWF0IjoxNzQ5Nzk3MjUxfQ.ShhXexaMIBum7rBMwsK7G01dRwOAywQ376p3_wCt_HY

2025-06-12 23:47:31,680 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:47:31,681 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:47:31,695 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:47:31,695 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:47:31,705 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:47:31,705 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:47:31,716 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:47:31,716 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:47:31,716 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:47:31,716 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 31, 716795), 'iat': datetime.datetime(2025, 6, 13, 6, 47, 31, 716798)}
2025-06-12 23:47:31,717 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg1MSwiaWF0IjoxNzQ5Nzk3MjUxfQ.ShhXexaMIBum7rBMwsK7G01dRwOAywQ376p3_wCt_HY

2025-06-12 23:47:31,728 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:47:31,728 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:47:31,728 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:47:31,728 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 31, 728385), 'iat': datetime.datetime(2025, 6, 13, 6, 47, 31, 728389)}
2025-06-12 23:47:31,728 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg1MSwiaWF0IjoxNzQ5Nzk3MjUxfQ.ShhXexaMIBum7rBMwsK7G01dRwOAywQ376p3_wCt_HY

2025-06-12 23:47:31,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:47:31,736 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:47:31,736 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:47:31,736 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 31, 736114), 'iat': datetime.datetime(2025, 6, 13, 6, 47, 31, 736123)}
2025-06-12 23:47:31,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg1MSwiaWF0IjoxNzQ5Nzk3MjUxfQ.ShhXexaMIBum7rBMwsK7G01dRwOAywQ376p3_wCt_HY

2025-06-12 23:47:31,758 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:47:31,759 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:47:31,782 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:47:31,782 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:47:31,782 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:47:31,782 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 31, 782429), 'iat': datetime.datetime(2025, 6, 13, 6, 47, 31, 782432)}
2025-06-12 23:47:31,782 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg1MSwiaWF0IjoxNzQ5Nzk3MjUxfQ.ShhXexaMIBum7rBMwsK7G01dRwOAywQ376p3_wCt_HY

2025-06-12 23:48:04,686 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:04,687 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:04,687 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:04,687 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:04,687 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:04,688 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:04,688 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:04,688 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:04,697 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:04,698 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:08,796 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:48:08,796 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:48:08,800 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:48:08,800 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:48:08,802 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:48:08,802 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:48:08,815 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:48:08,816 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:48:08,836 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:48:08,836 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:48:08,836 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:48:08,836 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:48:08,836 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:48:08,836 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 48, 8, 836481), 'iat': datetime.datetime(2025, 6, 13, 6, 48, 8, 836485)}
2025-06-12 23:48:08,836 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:48:08,836 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 48, 8, 836555), 'iat': datetime.datetime(2025, 6, 13, 6, 48, 8, 836560)}
2025-06-12 23:48:08,837 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg4OCwiaWF0IjoxNzQ5Nzk3Mjg4fQ.2kyLNbE2yB2DT9QJHvcnxsiz7WxufowPkPF_5bPhIWo

2025-06-12 23:48:08,837 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg4OCwiaWF0IjoxNzQ5Nzk3Mjg4fQ.2kyLNbE2yB2DT9QJHvcnxsiz7WxufowPkPF_5bPhIWo

2025-06-12 23:48:08,837 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:48:08,838 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:48:08,838 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:48:08,838 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 48, 8, 837940), 'iat': datetime.datetime(2025, 6, 13, 6, 48, 8, 837945)}
2025-06-12 23:48:08,838 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg4OCwiaWF0IjoxNzQ5Nzk3Mjg4fQ.2kyLNbE2yB2DT9QJHvcnxsiz7WxufowPkPF_5bPhIWo

2025-06-12 23:48:08,893 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:48:08,893 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:48:08,893 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:48:08,893 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 48, 8, 893263), 'iat': datetime.datetime(2025, 6, 13, 6, 48, 8, 893269)}
2025-06-12 23:48:08,894 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg4OCwiaWF0IjoxNzQ5Nzk3Mjg4fQ.2kyLNbE2yB2DT9QJHvcnxsiz7WxufowPkPF_5bPhIWo

2025-06-12 23:48:08,912 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:48:08,912 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:48:08,945 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:48:08,945 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:48:08,945 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:48:08,945 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 48, 8, 945199), 'iat': datetime.datetime(2025, 6, 13, 6, 48, 8, 945202)}
2025-06-12 23:48:08,945 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDg4OCwiaWF0IjoxNzQ5Nzk3Mjg4fQ.2kyLNbE2yB2DT9QJHvcnxsiz7WxufowPkPF_5bPhIWo

2025-06-12 23:48:57,469 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:57,470 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:57,470 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:57,471 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:57,471 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:57,472 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:57,472 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:48:57,472 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:57,472 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:48:57,473 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:49:01,125 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:01,125 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:01,144 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:01,145 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:01,152 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:01,152 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:01,159 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:01,159 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:01,160 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:01,160 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 1, 159746), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 1, 159752)}
2025-06-12 23:49:01,161 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk0MSwiaWF0IjoxNzQ5Nzk3MzQxfQ.k7Y7DOWuqMGGmoBrfpQlm8JdQuslBjaxKT-epnmjCwc

2025-06-12 23:49:01,173 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:01,175 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:01,176 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:01,176 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:01,176 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:01,176 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 1, 176753), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 1, 176758)}
2025-06-12 23:49:01,177 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk0MSwiaWF0IjoxNzQ5Nzk3MzQxfQ.k7Y7DOWuqMGGmoBrfpQlm8JdQuslBjaxKT-epnmjCwc

2025-06-12 23:49:01,201 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:01,201 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:01,201 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:01,201 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 1, 201032), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 1, 201044)}
2025-06-12 23:49:01,202 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk0MSwiaWF0IjoxNzQ5Nzk3MzQxfQ.k7Y7DOWuqMGGmoBrfpQlm8JdQuslBjaxKT-epnmjCwc

2025-06-12 23:49:01,231 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:01,231 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:01,231 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:01,231 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 1, 231005), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 1, 231007)}
2025-06-12 23:49:01,231 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk0MSwiaWF0IjoxNzQ5Nzk3MzQxfQ.k7Y7DOWuqMGGmoBrfpQlm8JdQuslBjaxKT-epnmjCwc

2025-06-12 23:49:01,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:01,252 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:01,287 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:01,287 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:01,287 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:01,287 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 1, 287742), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 1, 287746)}
2025-06-12 23:49:01,288 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk0MSwiaWF0IjoxNzQ5Nzk3MzQxfQ.k7Y7DOWuqMGGmoBrfpQlm8JdQuslBjaxKT-epnmjCwc

2025-06-12 23:49:23,022 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:49:23,023 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:49:23,023 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:49:23,023 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:49:23,023 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:49:23,023 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:49:23,024 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:49:23,024 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:49:23,024 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:49:28,085 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:28,085 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:28,118 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:28,118 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:28,122 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:28,122 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:28,124 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:28,124 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:28,186 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:28,187 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:28,187 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:28,187 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 28, 185580), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 28, 185593)}
2025-06-12 23:49:28,189 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk2OCwiaWF0IjoxNzQ5Nzk3MzY4fQ.1x4dlfWvaXg-A9YxR97pCGmeQjtRYdixyVxSrlMa9_4

2025-06-12 23:49:28,194 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:28,194 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:28,194 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:28,194 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 28, 194024), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 28, 194028)}
2025-06-12 23:49:28,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:28,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
Dq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:28,196 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:28,196 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:28,196 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 28, 196163), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 28, 196168)}
2025-06-12 23:49:28,196 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk2OCwiaWF0IjoxNzQ5Nzk3MzY4fQ.1x4dlfWvaXg-A9YxR97pCGmeQjtRYdixyVxSrlMa9_4

2025-06-12 23:49:28,196 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:28,197 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 28, 196356), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 28, 196366)}
2025-06-12 23:49:28,197 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk2OCwiaWF0IjoxNzQ5Nzk3MzY4fQ.1x4dlfWvaXg-A9YxR97pCGmeQjtRYdixyVxSrlMa9_4

2025-06-12 23:49:28,198 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk2OCwiaWF0IjoxNzQ5Nzk3MzY4fQ.1x4dlfWvaXg-A9YxR97pCGmeQjtRYdixyVxSrlMa9_4

2025-06-12 23:49:28,293 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:28,293 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:28,335 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:28,335 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:28,335 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:28,335 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 28, 335714), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 28, 335717)}
2025-06-12 23:49:28,336 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk2OCwiaWF0IjoxNzQ5Nzk3MzY4fQ.1x4dlfWvaXg-A9YxR97pCGmeQjtRYdixyVxSrlMa9_4

2025-06-12 23:49:39,542 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:49:39,543 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:49:39,612 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:49:39,612 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:49:39,612 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:49:39,612 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 49, 39, 612124), 'iat': datetime.datetime(2025, 6, 13, 6, 49, 39, 612129)}
2025-06-12 23:49:39,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMDk3OSwiaWF0IjoxNzQ5Nzk3Mzc5fQ.4B5141LLjvFujkQFVkneBEuzkq2W3WSQQRlV_de4Tp4

2025-06-12 23:50:32,243 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,244 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,244 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:50:32,245 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:50:32,246 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,246 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,246 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,246 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:50:32,246 - INFO - app.core.security - Closing Redis connection...
2025-06-12 23:50:32,247 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:50:32,247 - INFO - app.core.security - Redis connection closed.
2025-06-12 23:50:38,266 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,266 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,268 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,268 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,269 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,269 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,316 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,316 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,343 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,343 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,388 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-12 23:50:38,388 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-12 23:50:38,397 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:50:38,397 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 397470), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 397473)}
2025-06-12 23:50:38,397 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:50:38,397 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 397470), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 397473)}
2025-06-12 23:50:38,397 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,397 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 397578), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 397580)}
2025-06-12 23:50:38,398 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMTAzOCwiaWF0IjoxNzQ5Nzk3NDM4fQ._s9pc__OXpeXSjEPzoGK47qJhkiOfvFMovmgY7FVpeM

2025-06-12 23:50:38,398 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMTAzOCwiaWF0IjoxNzQ5Nzk3NDM4fQ._s9pc__OXpeXSjEPzoGK47qJhkiOfvFMovmgY7FVpeM

2025-06-12 23:50:38,445 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:50:38,445 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,445 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,445 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 445234), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 445240)}
2025-06-12 23:50:38,446 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMTAzOCwiaWF0IjoxNzQ5Nzk3NDM4fQ._s9pc__OXpeXSjEPzoGK47qJhkiOfvFMovmgY7FVpeM

2025-06-12 23:50:38,457 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:50:38,458 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,458 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,458 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 457940), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 457943)}
2025-06-12 23:50:38,458 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMTAzOCwiaWF0IjoxNzQ5Nzk3NDM4fQ._s9pc__OXpeXSjEPzoGK47qJhkiOfvFMovmgY7FVpeM

2025-06-12 23:50:38,526 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-12 23:50:38,526 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-12 23:50:38,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-12 23:50:38,526 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 7, 50, 38, 526129), 'iat': datetime.datetime(2025, 6, 13, 6, 50, 38, 526138)}
2025-06-12 23:50:38,528 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMTAzOCwiaWF0IjoxNzQ5Nzk3NDM4fQ._s9pc__OXpeXSjEPzoGK47qJhkiOfvFMovmgY7FVpeM

2025-06-12 23:50:39,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,459 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,459 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,462 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,462 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,465 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,465 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:50:39,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,465 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,557 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,557 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,644 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,644 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,653 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,653 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,653 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,667 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,667 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:50:39,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,667 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,673 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,673 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,673 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,676 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,989 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,990 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:39,994 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:39,994 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:39,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:39,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:39,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,997 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:50:39,997 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:50:40,006 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:50:40,006 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:50:40,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:50:40,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:50:40,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:37,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:51:37,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:51:37,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:37,722 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:37,722 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:51:37,730 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:51:37,730 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:51:50,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:51:50,956 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:51:50,957 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:50,957 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:50,957 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:51:51,020 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:51:51,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:51:54,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:51:54,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:51:54,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:54,816 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:51:54,816 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:51:54,827 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:51:54,827 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:52:08,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:52:08,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:52:08,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:52:08,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:52:08,270 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:52:08,280 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:52:08,280 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:52:37,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:52:37,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:52:37,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:52:37,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:52:37,734 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:52:37,755 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:52:37,755 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:53:37,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:53:37,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:53:37,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:53:37,742 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:53:37,742 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:53:37,750 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:53:37,750 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:54:38,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:54:38,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:54:38,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:54:38,626 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:54:38,626 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:54:38,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:54:38,662 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:55:37,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:55:37,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:55:37,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:55:37,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:55:37,715 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:55:37,900 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:55:37,900 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:57:09,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:57:09,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:57:09,103 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:57:09,104 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:57:09,104 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:57:09,128 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:57:09,129 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:58:47,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:58:47,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:58:47,548 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:58:47,549 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:58:47,549 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:58:47,712 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:58:47,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:32,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:32,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:32,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,303 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,304 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:59:32,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:32,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:32,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,305 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,305 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:32,317 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:32,317 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:32,317 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:32,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:32,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:32,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,346 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,346 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-12 23:59:32,347 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:32,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:32,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,348 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,348 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:32,362 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:32,362 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:32,363 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:32,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:32,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:32,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:32,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:32,395 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:32,396 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:33,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:33,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:33,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:33,819 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:33,837 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:33,837 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:33,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:33,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:33,866 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:35,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:35,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:35,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:35,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:35,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:35,251 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:35,252 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-12 23:59:36,829 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-12 23:59:36,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-12 23:59:36,830 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:36,830 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-12 23:59:36,831 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-12 23:59:36,861 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-12 23:59:36,861 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 00:00:39,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:00:39,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:00:39,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:00:39,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:00:39,165 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 00:00:39,172 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 00:00:39,172 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 00:01:35,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:01:35,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:01:35,334 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:01:35,334 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:01:35,334 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 00:01:35,565 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 00:01:35,565 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 00:02:00,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:02:00,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:02:00,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:02:00,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749798152, 'iat': 1749796352}
2025-06-13 00:02:00,037 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 00:02:00,057 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 00:02:00,057 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 00:02:35,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:02:35,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:02:35,365 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:02:35,389 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:03:31,987 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:03:31,988 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:03:31,988 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:03:31,988 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 7, 33, 31, 987302), 'iat': datetime.datetime(2025, 6, 13, 7, 3, 31, 987408)}
2025-06-13 00:03:31,991 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDAwMTEsImlhdCI6MTc0OTc5ODIxMX0._ycofhTCsdR8WQKnhugRp3Ys9JZQCMWTkQXW76zk-oc

2025-06-13 00:03:31,993 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MDMwMTEsImlhdCI6MTc0OTc5ODIxMX0.3UpynoHNVMtIA6GLZIooZWV27plpPq5OBqTDaJwjjoE, Expiry (seconds): 604800
2025-06-13 00:03:31,999 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 00:03:50,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:03:50,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:03:50,857 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:03:50,860 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:03:53,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:03:53,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:03:53,603 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749800011, 'iat': 1749798211}
2025-06-13 00:06:26,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:06:26,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:06:26,008 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:06:26,013 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:08:17,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:08:17,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:08:17,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749800011, 'iat': 1749798211}
2025-06-13 00:10:37,088 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:10:37,088 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:10:37,089 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:10:37,089 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 7, 40, 37, 88519), 'iat': datetime.datetime(2025, 6, 13, 7, 10, 37, 88530)}
2025-06-13 00:10:37,089 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDA0MzcsImlhdCI6MTc0OTc5ODYzN30.NStz8Ttbp5-0hHhDYm_hkqy4NgE4S1J83IHUMJS_j2w

2025-06-13 00:10:37,090 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MDM0MzcsImlhdCI6MTc0OTc5ODYzN30.3hH9I1hL7pcki0eEOuxSdJcLttOWxUn2hVt-Y9zN-YI, Expiry (seconds): 604800
2025-06-13 00:10:37,094 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 00:10:50,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:10:50,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:10:50,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749800437, 'iat': 1749798637}
2025-06-13 00:14:20,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:14:20,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:14:20,275 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:14:20,279 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:14:56,764 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:14:56,767 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:14:56,769 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:14:56,769 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:14:56,776 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:14:56,777 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:14:56,781 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:14:56,782 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:14:56,783 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:04,979 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:04,980 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:04,982 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:04,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:05,000 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:05,000 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:05,006 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:05,009 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:05,025 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:05,026 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:05,071 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:05,071 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:05,071 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:05,071 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:05,071 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:05,071 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:05,071 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:05,071 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 2025-06-13 00:15:05,071 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
t': datetime.datetime(2025, 6, 13, 7, 15, 5, 71057)}
2025-06-13 00:15:05,071 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 5, 71128), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 5, 71132)}
2025-06-13 00:15:05,073 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 5, 71117), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 5, 71124)}
2025-06-13 00:15:05,074 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjUwNSwiaWF0IjoxNzQ5Nzk4OTA1fQ.sHFJCZRppL_PGTDpPIHVEwQdUNlS3N9QjjkFIYnJGg4

2025-06-13 00:15:05,074 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjUwNSwiaWF0IjoxNzQ5Nzk4OTA1fQ.sHFJCZRppL_PGTDpPIHVEwQdUNlS3N9QjjkFIYnJGg4

2025-06-13 00:15:05,074 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjUwNSwiaWF0IjoxNzQ5Nzk4OTA1fQ.sHFJCZRppL_PGTDpPIHVEwQdUNlS3N9QjjkFIYnJGg4

2025-06-13 00:15:05,080 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:05,080 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:05,080 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:05,080 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 5, 80362), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 5, 80368)}
2025-06-13 00:15:05,081 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjUwNSwiaWF0IjoxNzQ5Nzk4OTA1fQ.sHFJCZRppL_PGTDpPIHVEwQdUNlS3N9QjjkFIYnJGg4

2025-06-13 00:15:05,094 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:05,094 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:05,095 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:05,095 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 5, 94477), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 5, 94491)}
2025-06-13 00:15:05,096 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjUwNSwiaWF0IjoxNzQ5Nzk4OTA1fQ.sHFJCZRppL_PGTDpPIHVEwQdUNlS3N9QjjkFIYnJGg4

2025-06-13 00:15:39,760 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:15:39,763 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:15:39,763 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:15:39,760 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:15:39,767 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:39,767 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:15:39,768 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:39,771 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:39,772 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:39,773 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:15:51,727 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:51,728 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:51,743 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:51,744 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:52,056 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:52,057 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:52,363 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:52,363 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:52,364 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:52,364 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 52, 363331), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 52, 363348)}
2025-06-13 00:15:52,375 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU1MiwiaWF0IjoxNzQ5Nzk4OTUyfQ.5Ohq3ktWKN50C0KU930Fsam9zgeMIJn9YY48oCy9Q2E

2025-06-13 00:15:52,381 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:52,381 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:52,381 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:52,395 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 52, 380927), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 52, 380943)}
2025-06-13 00:15:52,397 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU1MiwiaWF0IjoxNzQ5Nzk4OTUyfQ.5Ohq3ktWKN50C0KU930Fsam9zgeMIJn9YY48oCy9Q2E

2025-06-13 00:15:52,675 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:52,680 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:52,709 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:52,709 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:52,709 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:52,709 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 52, 709254), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 52, 709267)}
2025-06-13 00:15:52,720 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU1MiwiaWF0IjoxNzQ5Nzk4OTUyfQ.5Ohq3ktWKN50C0KU930Fsam9zgeMIJn9YY48oCy9Q2E

2025-06-13 00:15:52,806 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:15:52,809 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:15:53,163 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:53,163 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:53,163 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:53,164 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 53, 163378), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 53, 163390)}
2025-06-13 00:15:53,164 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU1MywiaWF0IjoxNzQ5Nzk4OTUzfQ.hWeN24Ci4saIvqilLpSinbl_JevqqrzXxO71ezf7z2k

2025-06-13 00:15:53,286 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:15:53,286 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:15:53,286 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:15:53,287 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 15, 53, 285978), 'iat': datetime.datetime(2025, 6, 13, 7, 15, 53, 285990)}
2025-06-13 00:15:53,288 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU1MywiaWF0IjoxNzQ5Nzk4OTUzfQ.hWeN24Ci4saIvqilLpSinbl_JevqqrzXxO71ezf7z2k

2025-06-13 00:15:53,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:15:53,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:15:53,768 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:15:53,891 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:16:23,390 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:16:23,401 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:16:23,404 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:16:23,406 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:16:23,413 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:16:23,407 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:16:23,418 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:16:23,411 - INFO - app.core.security - Closing Redis connection...
2025-06-13 00:16:23,424 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:16:23,421 - INFO - app.core.security - Redis connection closed.
2025-06-13 00:16:33,792 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:33,793 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:33,798 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:33,798 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:33,798 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:33,799 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:33,848 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:33,848 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:33,876 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:33,876 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:34,086 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:16:34,087 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:34,087 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:34,087 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 34, 86848), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 34, 86853)}
2025-06-13 00:16:34,088 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5NCwiaWF0IjoxNzQ5Nzk4OTk0fQ.pYIRbKgvqPg60JLWC3WP-STgCBIpgadYFxWJq_THo3A

2025-06-13 00:16:34,089 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:16:34,089 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:34,089 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:34,089 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:34,089 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 34, 89556), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 34, 89563)}
2025-06-13 00:16:34,090 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:34,090 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 34, 89384), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 34, 89392)}
2025-06-13 00:16:34,090 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5NCwiaWF0IjoxNzQ5Nzk4OTk0fQ.pYIRbKgvqPg60JLWC3WP-STgCBIpgadYFxWJq_THo3A

2025-06-13 00:16:34,091 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5NCwiaWF0IjoxNzQ5Nzk4OTk0fQ.pYIRbKgvqPg60JLWC3WP-STgCBIpgadYFxWJq_THo3A

2025-06-13 00:16:34,092 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:16:34,092 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:34,092 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:34,092 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 34, 92169), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 34, 92174)}
2025-06-13 00:16:34,093 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5NCwiaWF0IjoxNzQ5Nzk4OTk0fQ.pYIRbKgvqPg60JLWC3WP-STgCBIpgadYFxWJq_THo3A

2025-06-13 00:16:34,157 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:16:34,157 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:34,158 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:34,158 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 34, 157791), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 34, 157798)}
2025-06-13 00:16:34,158 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5NCwiaWF0IjoxNzQ5Nzk4OTk0fQ.pYIRbKgvqPg60JLWC3WP-STgCBIpgadYFxWJq_THo3A

2025-06-13 00:16:35,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:35,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:35,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:35,680 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:16:35,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:35,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:35,844 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:35,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:35,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:35,972 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:35,985 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:16:39,087 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 00:16:39,088 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 00:16:39,072 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:39,090 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:39,092 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:39,132 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:16:39,413 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:16:39,413 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:16:39,414 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:16:39,414 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 8, 16, 39, 413586), 'iat': datetime.datetime(2025, 6, 13, 7, 16, 39, 413597)}
2025-06-13 00:16:39,416 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwMjU5OSwiaWF0IjoxNzQ5Nzk4OTk5fQ.OGUU0DMYU04PIurrLQU6GPRKDyFfrU3KiufmpFMuqLI

2025-06-13 00:16:40,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:40,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:40,918 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:45,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:45,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:45,974 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:49,025 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:16:49,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:16:49,026 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 00:16:49,033 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 00:17:02,020 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 00:17:02,021 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 00:17:02,021 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 00:17:02,021 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 13, 7, 47, 2, 20338), 'iat': datetime.datetime(2025, 6, 13, 7, 17, 2, 20355)}
2025-06-13 00:17:02,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MDA4MjIsImlhdCI6MTc0OTc5OTAyMn0.PgVWwns4gnsP4VTBX-zpvADhQ8yJc8R2vSIzzLZl0yo

2025-06-13 00:17:02,022 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA0MDM4MjIsImlhdCI6MTc0OTc5OTAyMn0.r9ju3qTDs0JZZJXCxMCeYmm06hs-4oEH8af9oQWdZPg, Expiry (seconds): 604800
2025-06-13 00:17:02,027 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-13 00:17:03,277 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,279 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,279 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 00:17:03,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,280 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:03,320 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:03,320 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:03,321 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:03,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,341 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,341 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 00:17:03,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,343 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:03,362 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:03,363 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:03,363 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:03,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,373 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:03,402 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:03,402 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:03,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:03,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:03,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:03,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:03,668 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:03,669 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:04,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:04,305 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:04,306 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:04,306 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:04,307 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:04,317 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:04,317 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:04,348 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:04,348 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:04,349 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:06,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:06,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:06,421 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:06,421 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:06,422 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:06,445 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:06,446 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:17:26,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:17:26,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:17:26,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:26,993 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:17:26,993 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:17:27,055 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:17:27,055 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:18:03,644 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:18:03,644 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:18:03,645 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:18:03,645 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:18:03,645 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:18:03,673 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:18:03,673 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:19:03,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:19:03,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:19:03,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:19:03,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:19:03,649 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:19:03,658 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:19:03,658 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:20:03,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:20:03,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:20:03,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:20:03,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:20:03,637 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:20:03,678 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:20:03,678 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:21:03,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:21:03,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:21:03,638 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:21:03,638 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:21:03,638 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:21:03,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:21:03,662 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 00:22:09,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 00:22:09,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 00:22:09,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:22:09,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749800822, 'iat': 1749799022}
2025-06-13 00:22:09,289 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 00:22:09,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 00:22:09,307 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 01:20:08,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:20:08,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:20:08,090 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:20:08,102 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:23:42,565 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 01:23:42,566 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 01:23:42,618 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 01:23:42,618 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 01:23:42,618 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 01:23:42,618 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 9, 23, 42, 618221), 'iat': datetime.datetime(2025, 6, 13, 8, 23, 42, 618223)}
2025-06-13 01:23:42,618 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwNjYyMiwiaWF0IjoxNzQ5ODAzMDIyfQ.ZcOZjlVu6FVHeGlubQe6BQAue32Y-tvDvJFqOijw0-I

2025-06-13 01:23:47,642 - INFO - app.core.security - Closing Redis connection...
2025-06-13 01:23:47,643 - INFO - app.core.security - Redis connection closed.
2025-06-13 01:44:32,360 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 01:44:32,360 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 01:44:32,410 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 01:44:32,410 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 01:44:32,410 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 01:44:32,410 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 9, 44, 32, 410251), 'iat': datetime.datetime(2025, 6, 13, 8, 44, 32, 410254)}
2025-06-13 01:44:32,410 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwNzg3MiwiaWF0IjoxNzQ5ODA0MjcyfQ.Yo--QhYaWNh3Zjb-ruIUnv93tiTeq6L1024y6OcfI90

2025-06-13 01:44:33,825 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:33,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:33,826 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:33,828 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:33,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:33,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:33,841 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,155 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,156 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,808 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,809 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,823 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,826 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,835 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,836 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,847 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,850 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,858 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,860 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,867 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,869 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,876 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,878 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,886 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,887 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,893 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,894 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,899 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:38,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:38,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:38,906 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:38,907 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:39,809 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:39,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:39,810 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:43,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:43,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:43,815 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:43,817 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:44:44,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:44,821 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:44,821 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:46,755 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:44:46,756 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:44:46,756 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 01:44:46,758 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 01:57:23,577 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 01:57:23,577 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 01:57:23,578 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 01:57:23,578 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 9, 27, 23, 577351), 'iat': datetime.datetime(2025, 6, 13, 8, 57, 23, 577365)}
2025-06-13 01:57:23,580 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDY4NDMsImlhdCI6MTc0OTgwNTA0M30.VIEXoxuKruEYh-yFD5V3uTVT5f9mkFH5VdCotn7Q1yM

2025-06-13 01:57:23,580 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MDk4NDMsImlhdCI6MTc0OTgwNTA0M30.X8Z5zQpYfPbjK5lb-dA-RtkgLoSNAo3Fxi4nJtVp898, Expiry (seconds): 604800
2025-06-13 01:57:23,589 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 01:57:24,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:24,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:24,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,667 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,667 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 01:57:24,667 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:24,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:24,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,667 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:24,682 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:24,687 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:24,687 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:24,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:24,721 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:24,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,722 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,722 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 01:57:24,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:24,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:24,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:24,749 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:24,750 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:24,750 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:24,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:24,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:24,760 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:24,761 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:24,802 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:24,802 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:25,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:25,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:25,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:25,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:25,444 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:25,457 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:25,457 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:25,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:25,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:25,469 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:27,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:27,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:27,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:27,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:27,012 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:27,052 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:27,052 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:27,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 01:57:27,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 01:57:27,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:27,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 01:57:27,394 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 01:57:27,441 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 01:57:27,442 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 01:57:51,721 - INFO - app.core.security - Closing Redis connection...
2025-06-13 01:57:51,721 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:09:57,748 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:09:57,748 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:09:57,827 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:09:57,827 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:09:57,828 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:09:57,830 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 9, 57, 827365), 'iat': datetime.datetime(2025, 6, 13, 9, 9, 57, 827671)}
2025-06-13 02:09:57,831 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgwOTM5NywiaWF0IjoxNzQ5ODA1Nzk3fQ.t8ZA6NHXBFgAtwo37yE5mqng-RNATNOCCv0iEUMUA_8

2025-06-13 02:10:41,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:10:41,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:10:41,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:10:41,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:10:41,713 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:10:41,730 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:10:41,730 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:10:41,758 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:10:41,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:10:41,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:10:41,759 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:10:41,759 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:10:41,764 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:10:41,764 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:10:59,331 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:10:59,332 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:10:59,332 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:10:59,332 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 13, 9, 40, 59, 331826), 'iat': datetime.datetime(2025, 6, 13, 9, 10, 59, 331837)}
2025-06-13 02:10:59,333 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MDc2NTksImlhdCI6MTc0OTgwNTg1OX0.jIcJJa1XdVI-8wm-qIPbdZBF_bXDFx0smrhPcUbQoHA

2025-06-13 02:10:59,333 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA0MTA2NTksImlhdCI6MTc0OTgwNTg1OX0.6PthIC_B8mwvuCzLEdWxx8485mAwgabE-mL2UqhJBWg, Expiry (seconds): 604800
2025-06-13 02:10:59,367 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-13 02:11:10,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:11:10,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:11:10,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749807659, 'iat': 1749805859}
2025-06-13 02:12:34,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,562 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,562 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 02:12:34,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,563 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:34,572 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:34,572 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:34,573 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:34,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,582 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,582 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 02:12:34,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,582 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:34,589 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:34,590 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:34,590 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:34,592 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,593 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,593 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,593 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:34,601 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:34,602 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:34,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:34,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:34,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:34,821 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:34,834 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:34,835 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:35,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:35,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:35,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:35,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:35,052 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:35,058 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:35,059 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:12:35,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:35,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:35,278 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:35,577 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:12:35,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:12:35,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:35,578 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:12:35,578 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:12:35,590 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:12:35,590 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:13:34,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:13:34,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:13:34,829 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:34,830 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:34,830 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:13:34,841 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:13:34,841 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:13:55,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:13:55,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:13:55,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:55,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:55,439 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:13:55,451 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:13:55,452 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:13:59,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:13:59,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:13:59,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:59,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:13:59,344 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:13:59,352 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:13:59,353 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:14:02,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:14:02,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:14:02,699 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:02,699 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:02,699 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:14:02,710 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:14:02,711 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:14:05,474 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:14:05,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:14:05,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:05,476 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:05,476 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:14:05,496 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:14:05,496 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:14:35,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:14:35,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:14:35,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:35,811 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:14:35,811 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:14:35,816 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:14:35,816 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:16:05,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:16:05,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:16:05,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:16:05,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:16:05,612 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:16:05,619 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:16:05,619 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:18:16,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:18:16,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:18:16,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:18:16,189 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:18:16,189 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:18:16,197 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:18:16,198 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:21:50,344 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:21:50,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:21:50,345 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:21:50,345 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:21:50,345 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:21:50,352 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:21:50,353 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:24:01,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:24:01,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:24:01,195 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749806843, 'iat': 1749805043}
2025-06-13 02:28:01,877 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:28:01,880 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:28:05,429 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:28:05,429 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:28:05,485 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:28:05,485 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:28:05,485 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:28:05,485 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 28, 5, 485843), 'iat': datetime.datetime(2025, 6, 13, 9, 28, 5, 485846)}
2025-06-13 02:28:05,486 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMDQ4NSwiaWF0IjoxNzQ5ODA2ODg1fQ.Rx8WUqkTUS3SPPAzV-9S2mMBIbHACfaleWZ-kx2jYsQ

2025-06-13 02:29:04,270 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:29:04,271 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:29:06,539 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:29:06,540 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:29:06,591 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:29:06,591 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:29:06,591 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:29:06,591 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 29, 6, 591278), 'iat': datetime.datetime(2025, 6, 13, 9, 29, 6, 591281)}
2025-06-13 02:29:06,591 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMDU0NiwiaWF0IjoxNzQ5ODA2OTQ2fQ.5B3X2CIx1pNzqNSh0-8alt9TvpncbGrdL0xiXfCjgA0

2025-06-13 02:30:15,638 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:30:15,640 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:30:17,753 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:30:17,754 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:30:17,779 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:30:17,779 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:30:17,779 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:30:17,779 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 30, 17, 779705), 'iat': datetime.datetime(2025, 6, 13, 9, 30, 17, 779708)}
2025-06-13 02:30:17,780 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMDYxNywiaWF0IjoxNzQ5ODA3MDE3fQ.Pml3ucrYN4ofA9XmguOVmjuSC2fVETNEwC4u2bIIcVo

2025-06-13 02:31:31,933 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:31:31,934 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:31:34,239 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:31:34,239 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:31:34,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:31:34,303 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:31:34,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:31:34,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 31, 34, 303115), 'iat': datetime.datetime(2025, 6, 13, 9, 31, 34, 303120)}
2025-06-13 02:31:34,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMDY5NCwiaWF0IjoxNzQ5ODA3MDk0fQ.QhswPlDjJkCzms5KLvY_RBIUBsmQj8Trvkoa5HS8G5g

2025-06-13 02:33:09,479 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:33:09,479 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:33:09,479 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:33:09,480 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 10, 3, 9, 479610), 'iat': datetime.datetime(2025, 6, 13, 9, 33, 9, 479617)}
2025-06-13 02:33:09,480 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDg5ODksImlhdCI6MTc0OTgwNzE4OX0.I5JU3EPzr_mF77wBmmujcqoTtQBxtNwdedCu53cnQyA

2025-06-13 02:33:09,480 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTE5ODksImlhdCI6MTc0OTgwNzE4OX0.r4fOmfSV4JW_CZlsWWF9iJv3cQSIALdad_8yY0vSO3s, Expiry (seconds): 604800
2025-06-13 02:33:09,483 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 02:33:22,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:33:22,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:33:22,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749808989, 'iat': 1749807189}
2025-06-13 02:34:20,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:20,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:20,061 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:20,065 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 02:34:20,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:20,490 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:20,490 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:20,492 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 02:34:25,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:25,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:25,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:30,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:30,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:30,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:34,825 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:34,825 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:34,825 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:34,826 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 02:34:35,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:35,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:35,257 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:40,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:40,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:40,823 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:46,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:46,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:46,825 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:52,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:52,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:52,816 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:34:58,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:34:58,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:34:58,835 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:04,824 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:04,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:04,825 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:10,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:10,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:10,821 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:16,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:16,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:16,813 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:20,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:20,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:20,812 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:20,814 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 02:35:22,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:22,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:22,829 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:28,867 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:28,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:28,868 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:34,821 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:34,821 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:34,822 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:34,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:34,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:34,834 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:34,839 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 02:35:40,842 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:40,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:40,843 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:46,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:46,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:46,837 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:52,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:52,832 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:52,832 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:35:59,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:35:59,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:35:59,734 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:36:05,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:36:05,821 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:36:05,821 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:36:11,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:36:11,859 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:36:11,860 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:36:16,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:36:16,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:36:16,893 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 02:37:02,703 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:37:02,703 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:37:02,703 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:37:02,704 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 10, 7, 2, 703345), 'iat': datetime.datetime(2025, 6, 13, 9, 37, 2, 703366)}
2025-06-13 02:37:02,704 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MDkyMjIsImlhdCI6MTc0OTgwNzQyMn0.YfLYD6Vmel0PS7CkjBr_8UeKeDKYIJckF_V9qIc1fvw

2025-06-13 02:37:02,704 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTIyMjIsImlhdCI6MTc0OTgwNzQyMn0.TZBEkPnOjkcocuSCDBHZySG6aXzw8jTEL3iNsnVoldk, Expiry (seconds): 604800
2025-06-13 02:37:02,707 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 02:39:20,671 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:39:20,672 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:44:13,591 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:44:13,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:44:13,665 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:44:13,665 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:44:13,665 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:44:13,666 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 44, 13, 665764), 'iat': datetime.datetime(2025, 6, 13, 9, 44, 13, 665771)}
2025-06-13 02:44:13,666 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMTQ1MywiaWF0IjoxNzQ5ODA3ODUzfQ.IMO8YNnsucmSVAwF2Nn4iUYNsPvpHPOQ8HtDuDI3BVQ

2025-06-13 02:44:23,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:44:23,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:44:23,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749808989, 'iat': 1749807189}
2025-06-13 02:45:05,896 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:45:05,896 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:49:39,297 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:49:39,298 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:49:39,403 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:49:39,403 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:49:39,404 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:49:39,404 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 49, 39, 403904), 'iat': datetime.datetime(2025, 6, 13, 9, 49, 39, 403908)}
2025-06-13 02:49:39,406 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMTc3OSwiaWF0IjoxNzQ5ODA4MTc5fQ.ScR0Adm488Lh9uSRvDQWt9I925NcEIfvrOmidZ8ey_k

2025-06-13 02:50:36,436 - INFO - app.core.security - Closing Redis connection...
2025-06-13 02:50:36,437 - INFO - app.core.security - Redis connection closed.
2025-06-13 02:50:39,015 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:50:39,015 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:50:39,078 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:50:39,078 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:50:39,078 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:50:39,078 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 50, 39, 78594), 'iat': datetime.datetime(2025, 6, 13, 9, 50, 39, 78604)}
2025-06-13 02:50:39,080 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMTgzOSwiaWF0IjoxNzQ5ODA4MjM5fQ.fDpWhS9DLPZzCmyTvAuE_aybIOmOqprVOG49aJmfQZc

2025-06-13 02:50:45,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:50:45,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:50:45,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749808989, 'iat': 1749807189}
2025-06-13 02:53:47,874 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:53:47,875 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:53:47,875 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:53:47,875 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 10, 23, 47, 874753), 'iat': datetime.datetime(2025, 6, 13, 9, 53, 47, 874763)}
2025-06-13 02:53:47,875 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTAyMjcsImlhdCI6MTc0OTgwODQyN30.7OTAH2dv48Py8nS9PcxQu38oiIt_eyA3x7Byw6hIUO4

2025-06-13 02:53:47,876 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTMyMjcsImlhdCI6MTc0OTgwODQyN30.8GoitU_Qr6iai56GUAevlruMOp5cmG0OA8znh4MYlu8, Expiry (seconds): 604800
2025-06-13 02:53:47,879 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 02:53:54,431 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:53:54,431 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:53:54,431 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:53:54,431 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 10, 23, 54, 431035), 'iat': datetime.datetime(2025, 6, 13, 9, 53, 54, 431054)}
2025-06-13 02:53:54,432 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTAyMzQsImlhdCI6MTc0OTgwODQzNH0.kQHxvVNTboqGUjFdrh2MMP_cb2NrsypqJEapPLDm-x0

2025-06-13 02:53:54,433 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTMyMzQsImlhdCI6MTc0OTgwODQzNH0.T4P4RUroy7UA0P18keB93ruvI3Gn4d8MA7yvretifRM, Expiry (seconds): 604800
2025-06-13 02:53:54,440 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 02:54:16,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:54:16,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:54:16,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:54:16,004 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:54:16,004 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:54:16,014 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:54:16,015 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:55:10,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:55:10,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:55:10,038 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:55:10,038 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:55:10,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:55:10,046 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:55:10,046 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:55:27,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 02:55:27,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 02:55:27,755 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:55:27,755 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 02:55:27,755 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 02:55:27,764 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 02:55:27,764 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 02:56:59,242 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 02:56:59,242 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 02:56:59,290 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 02:56:59,290 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 02:56:59,290 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 02:56:59,290 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 10, 56, 59, 290268), 'iat': datetime.datetime(2025, 6, 13, 9, 56, 59, 290270)}
2025-06-13 02:56:59,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjIxOSwiaWF0IjoxNzQ5ODA4NjE5fQ.Nk3RQ9H6FAIU0DyrG1brqwMxgxR5CiAhinLLI-ygP_4

2025-06-13 02:58:13,617 - WARNING - app.core.security - Access token is missing.
2025-06-13 02:58:38,110 - WARNING - app.core.security - Access token is missing.
2025-06-13 02:58:39,461 - WARNING - app.core.security - Access token is missing.
2025-06-13 03:00:30,279 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:00:30,280 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:00:30,280 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:00:30,284 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:00:33,124 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:00:33,124 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:00:33,125 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:00:33,125 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:00:33,177 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:00:33,178 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:00:33,178 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:00:33,178 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 0, 33, 177972), 'iat': datetime.datetime(2025, 6, 13, 10, 0, 33, 177975)}
2025-06-13 03:00:33,178 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:00:33,178 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:00:33,178 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:00:33,178 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 0, 33, 178090), 'iat': datetime.datetime(2025, 6, 13, 10, 0, 33, 178093)}
2025-06-13 03:00:33,178 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjQzMywiaWF0IjoxNzQ5ODA4ODMzfQ.fmBuYBRkEAhFvYh24KJ7umIoDVbDbn3NsvCxuNw952Y

2025-06-13 03:00:33,178 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjQzMywiaWF0IjoxNzQ5ODA4ODMzfQ.fmBuYBRkEAhFvYh24KJ7umIoDVbDbn3NsvCxuNw952Y

2025-06-13 03:01:04,649 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:01:04,650 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:01:04,651 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:01:04,653 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:01:08,241 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:01:08,241 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:01:08,244 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:01:08,244 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:01:08,274 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:01:08,275 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:01:08,275 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:01:08,275 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 1, 8, 274839), 'iat': datetime.datetime(2025, 6, 13, 10, 1, 8, 274843)}
2025-06-13 03:01:08,275 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:01:08,275 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:01:08,275 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:01:08,275 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 1, 8, 275474), 'iat': datetime.datetime(2025, 6, 13, 10, 1, 8, 275478)}
2025-06-13 03:01:08,275 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjQ2OCwiaWF0IjoxNzQ5ODA4ODY4fQ.xctKf3TZSGj-NPwrhTaSuX1EFNmNN8b6igQvb7SplTs

2025-06-13 03:01:08,275 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjQ2OCwiaWF0IjoxNzQ5ODA4ODY4fQ.xctKf3TZSGj-NPwrhTaSuX1EFNmNN8b6igQvb7SplTs

2025-06-13 03:01:27,510 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:01:27,511 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:01:27,512 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:01:27,515 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:01:30,273 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:01:30,273 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:01:30,275 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:01:30,275 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:01:30,302 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:01:30,302 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:01:30,302 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:01:30,302 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:01:30,302 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 1, 30, 302792), 'iat': datetime.datetime(2025, 6, 13, 10, 1, 30, 302795)}
2025-06-13 03:01:30,302 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:01:30,302 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:01:30,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 1, 30, 302869), 'iat': datetime.datetime(2025, 6, 13, 10, 1, 30, 302871)}
2025-06-13 03:01:30,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjQ5MCwiaWF0IjoxNzQ5ODA4ODkwfQ.pgVeM2rZRNRl7lFl5YmB3H41X_bK2pbW4Bo2TK1rWDA

2025-06-13 03:03:36,302 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:03:36,302 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:03:36,303 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:03:36,304 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:05:33,123 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:05:33,123 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:05:33,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:05:33,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:05:33,160 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:05:33,160 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:05:33,160 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:05:33,160 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:05:33,160 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 5, 33, 160715), 'iat': datetime.datetime(2025, 6, 13, 10, 5, 33, 160722)}
2025-06-13 03:05:33,161 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:05:33,161 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:05:33,161 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 5, 33, 160932), 'iat': datetime.datetime(2025, 6, 13, 10, 5, 33, 160938)}
2025-06-13 03:05:33,161 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjczMywiaWF0IjoxNzQ5ODA5MTMzfQ.6vNeszsyZ6e-gTtHi9YclhOrIgx1tly_CnaW7JngTpc

2025-06-13 03:05:33,161 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjczMywiaWF0IjoxNzQ5ODA5MTMzfQ.6vNeszsyZ6e-gTtHi9YclhOrIgx1tly_CnaW7JngTpc

2025-06-13 03:07:47,735 - WARNING - app.core.security - Access token is missing.
2025-06-13 03:08:52,279 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:08:52,279 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:08:52,280 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:08:52,283 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:08:55,100 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:08:55,100 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:08:55,100 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:08:55,101 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:08:55,123 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:08:55,123 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:08:55,123 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:08:55,123 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:08:55,123 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:08:55,123 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 8, 55, 123383), 'iat': datetime.datetime(2025, 6, 13, 10, 8, 55, 123385)}
2025-06-13 03:08:55,123 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:08:55,123 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 8, 55, 123502), 'iat': datetime.datetime(2025, 6, 13, 10, 8, 55, 123505)}
2025-06-13 03:08:55,123 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjkzNSwiaWF0IjoxNzQ5ODA5MzM1fQ.EA0JKA9UGhXcEL-YQxOs-hFPtmnhonbCbPCk6CTbJpY

2025-06-13 03:09:49,471 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:09:49,471 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:09:49,518 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:09:49,518 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:09:49,518 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:09:49,518 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 9, 49, 518582), 'iat': datetime.datetime(2025, 6, 13, 10, 9, 49, 518584)}
2025-06-13 03:09:49,519 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMjk4OSwiaWF0IjoxNzQ5ODA5Mzg5fQ.JXx0ocNvBuY6ImRxWDkRnaUbQMtFI4O-RV-Do6e8RlQ

2025-06-13 03:15:09,862 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:15:09,863 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:15:12,245 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:15:12,246 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:15:12,279 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:15:12,279 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:15:12,279 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:15:12,279 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 15, 12, 279464), 'iat': datetime.datetime(2025, 6, 13, 10, 15, 12, 279467)}
2025-06-13 03:15:12,280 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxMzMxMiwiaWF0IjoxNzQ5ODA5NzEyfQ.geQgI1IC55IaMonTsoFHQY0obeEP2_rFA4T-O0GO9ww

2025-06-13 03:16:33,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:16:33,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:16:33,319 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 03:16:33,322 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 03:16:45,309 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:16:45,309 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:16:45,309 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:16:45,309 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 10, 46, 45, 309281), 'iat': datetime.datetime(2025, 6, 13, 10, 16, 45, 309290)}
2025-06-13 03:16:45,310 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTE2MDUsImlhdCI6MTc0OTgwOTgwNX0.gcT9W8uXF3av9wyYcNt4CK8u14iuv-c5-4Gfitvo05o

2025-06-13 03:16:45,311 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTQ2MDUsImlhdCI6MTc0OTgwOTgwNX0.Qekur7B8D91Fcz6LyeGj2fcQeapFDhYHMzXgNMJvfKs, Expiry (seconds): 604800
2025-06-13 03:16:45,315 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 03:16:57,059 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:16:57,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:16:57,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:16:57,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:16:57,060 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 03:16:57,071 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 03:16:57,071 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 03:17:03,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:17:03,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:17:03,695 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 03:17:12,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:17:12,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:17:12,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:19:26,989 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:19:26,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:19:26,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 03:19:26,990 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749810234, 'iat': 1749808434}
2025-06-13 03:19:26,990 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 03:19:27,012 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 03:19:27,012 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 03:20:56,937 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:20:56,938 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:32:32,713 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:32:32,713 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:32:32,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:32:32,746 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:32:32,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:32:32,746 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 32, 32, 746138), 'iat': datetime.datetime(2025, 6, 13, 10, 32, 32, 746141)}
2025-06-13 03:32:32,746 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxNDM1MiwiaWF0IjoxNzQ5ODEwNzUyfQ.w8-4Z-RtLQopRKtKKkwuJRdvu23aQi6KdogWiTHO4Js

2025-06-13 03:33:16,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:33:16,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:33:16,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:33:41,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:33:41,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:33:41,643 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:33:41,644 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749811605, 'iat': 1749809805}
2025-06-13 03:33:41,644 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 03:33:41,656 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 03:33:41,656 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 03:33:58,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:33:58,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:33:58,860 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-13 03:33:58,863 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-13 03:34:09,792 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:34:09,792 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:34:09,793 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:34:09,793 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 11, 4, 9, 792569), 'iat': datetime.datetime(2025, 6, 13, 10, 34, 9, 792580)}
2025-06-13 03:34:09,793 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MTI2NDksImlhdCI6MTc0OTgxMDg0OX0.HJ-_ZvhKyHpTkokcp4WD_9wzgpWNbBnAlN-Q2Hqxm_Q

2025-06-13 03:34:09,794 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MTU2NDksImlhdCI6MTc0OTgxMDg0OX0.9q_qePLS7CgJbOc6SdnnYns0nBShCPwEM4YSFQmEvs4, Expiry (seconds): 604800
2025-06-13 03:34:09,796 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 03:34:21,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:34:21,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:34:21,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749812649, 'iat': 1749810849}
2025-06-13 03:34:21,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749812649, 'iat': 1749810849}
2025-06-13 03:34:21,526 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 03:34:21,533 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 03:34:21,534 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 03:34:49,779 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:34:49,779 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:37:41,944 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:37:41,944 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:37:41,978 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:37:41,978 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:37:41,978 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:37:41,978 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 37, 41, 978549), 'iat': datetime.datetime(2025, 6, 13, 10, 37, 41, 978552)}
2025-06-13 03:37:41,978 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxNDY2MSwiaWF0IjoxNzQ5ODExMDYxfQ.If7u3D95rawxVN3obUlYHdKhti0lXrN_9nqRghjHgOw

2025-06-13 03:38:08,506 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:38:08,506 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:38:08,506 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:38:08,506 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 13, 11, 8, 8, 506139), 'iat': datetime.datetime(2025, 6, 13, 10, 38, 8, 506149)}
2025-06-13 03:38:08,506 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MTI4ODgsImlhdCI6MTc0OTgxMTA4OH0.iXXee4XqwDX4NQVjnqDbgHnFDc9hKEtSXc9IVIaI1bg

2025-06-13 03:38:08,506 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA0MTU4ODgsImlhdCI6MTc0OTgxMTA4OH0.Y1zKHyqHovo2nOYARma7rVSUkNch7Nx2xFA-HusHEt4, Expiry (seconds): 604800
2025-06-13 03:38:08,520 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-13 03:38:23,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:38:23,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:38:23,226 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749812888, 'iat': 1749811088}
2025-06-13 03:38:23,226 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749812888, 'iat': 1749811088}
2025-06-13 03:38:23,226 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 03:38:23,233 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 03:38:23,233 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:38:59,016 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:38:59,017 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:55:31,910 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:55:31,910 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:55:31,960 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:55:31,960 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:55:31,960 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:55:31,960 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 55, 31, 960564), 'iat': datetime.datetime(2025, 6, 13, 10, 55, 31, 960567)}
2025-06-13 03:55:31,961 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxNTczMSwiaWF0IjoxNzQ5ODEyMTMxfQ.3VZXehJYx0pXqTmxc2sfGD770HfLT63bbyKtG2XSWjo

2025-06-13 03:55:34,350 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:55:34,350 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:55:34,350 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:55:34,350 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 13, 11, 25, 34, 350323), 'iat': datetime.datetime(2025, 6, 13, 10, 55, 34, 350328)}
2025-06-13 03:55:34,350 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4MTM5MzQsImlhdCI6MTc0OTgxMjEzNH0.XQ2hWv06p3R6bRfTETSyHtb9RB1WszcaPSFfP7lyZyA

2025-06-13 03:55:34,350 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA0MTY5MzQsImlhdCI6MTc0OTgxMjEzNH0.vIKR_QJM2Yr61PjPmgcPiCK4JYLV_oJC-FbQcl77ews, Expiry (seconds): 604800
2025-06-13 03:55:34,352 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-13 03:55:45,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:55:45,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:55:45,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:45,939 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:45,939 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 03:55:45,939 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:55:45,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:55:45,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:45,941 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:45,941 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 03:55:45,953 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 03:55:45,954 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:55:45,954 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:55:57,831 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:55:57,832 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:55:57,832 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:57,832 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:57,832 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 03:55:57,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:55:57,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:55:57,833 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:57,833 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:55:57,833 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 03:55:57,839 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 03:55:57,839 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:55:57,839 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:56:16,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:56:16,878 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:56:16,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749812888, 'iat': 1749811088}
2025-06-13 03:56:16,879 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749812888, 'iat': 1749811088}
2025-06-13 03:56:16,879 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 03:56:16,887 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 03:56:16,888 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:56:16,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:56:16,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:56:16,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749812888, 'iat': 1749811088}
2025-06-13 03:56:29,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:56:29,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:56:29,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:56:29,342 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:56:29,342 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 03:56:29,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 03:56:29,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 03:56:29,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:56:29,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749813934, 'iat': 1749812134}
2025-06-13 03:56:29,343 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-13 03:56:29,350 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-13 03:56:29,350 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:56:29,351 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-13 03:59:30,438 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:59:30,439 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:59:32,560 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:59:32,560 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:59:32,583 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:59:32,583 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:59:32,583 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:59:32,583 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 59, 32, 583878), 'iat': datetime.datetime(2025, 6, 13, 10, 59, 32, 583880)}
2025-06-13 03:59:32,584 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxNTk3MiwiaWF0IjoxNzQ5ODEyMzcyfQ._iy0GbA7D6SzHj8sKWHyJN85Vvx-J6g61yrREbrUCSY

2025-06-13 03:59:33,371 - INFO - app.core.security - Closing Redis connection...
2025-06-13 03:59:33,372 - INFO - app.core.security - Redis connection closed.
2025-06-13 03:59:35,391 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 03:59:35,391 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 03:59:35,433 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 03:59:35,433 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 03:59:35,433 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 03:59:35,433 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 11, 59, 35, 433017), 'iat': datetime.datetime(2025, 6, 13, 10, 59, 35, 433022)}
2025-06-13 03:59:35,433 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgxNTk3NSwiaWF0IjoxNzQ5ODEyMzc1fQ.JNQDdSD0XBhxLfr25C-HMhOAVH054Y1JuVeGU8XV-io

2025-06-13 05:44:59,627 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 05:44:59,627 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 05:44:59,720 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 05:44:59,720 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 05:44:59,720 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 05:44:59,720 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 13, 44, 59, 720410), 'iat': datetime.datetime(2025, 6, 13, 12, 44, 59, 720413)}
2025-06-13 05:44:59,721 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyMjI5OSwiaWF0IjoxNzQ5ODE4Njk5fQ.slHx6G-N-Ajem-GYjJMUm9cB4LZMqfpg7NRCcDYsxFw

2025-06-13 05:45:48,535 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 05:45:48,535 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 05:45:48,536 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 05:45:48,536 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 13, 15, 48, 535601), 'iat': datetime.datetime(2025, 6, 13, 12, 45, 48, 535611)}
2025-06-13 05:45:48,536 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjA1NDgsImlhdCI6MTc0OTgxODc0OH0.PMWT_7HQl5OW9q2oiYWD4NirY8XLAcgd1Gk-pi-B1bs

2025-06-13 05:45:48,537 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MjM1NDgsImlhdCI6MTc0OTgxODc0OH0.F60RHhFmp_zrWD7imZ2VClT3v5_9qv3dD64n62HL9u0, Expiry (seconds): 604800
2025-06-13 05:45:48,545 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 05:46:57,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 05:46:57,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 05:46:57,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:47:45,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 05:47:45,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 05:47:45,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:47:45,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:47:45,774 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 05:47:45,787 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 05:47:45,788 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 05:49:05,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 05:49:05,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 05:49:05,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:49:05,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:49:05,670 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 05:49:05,679 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 05:49:05,680 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 05:50:31,737 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 05:50:31,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 05:50:31,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:50:31,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749820548, 'iat': 1749818748}
2025-06-13 05:50:31,739 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 05:50:31,778 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 05:50:31,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 05:51:18,576 - INFO - app.core.security - Closing Redis connection...
2025-06-13 05:51:18,578 - INFO - app.core.security - Redis connection closed.
2025-06-13 05:55:02,047 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 05:55:02,047 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 05:55:02,098 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 05:55:02,098 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 05:55:02,098 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 05:55:02,098 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 13, 55, 2, 98284), 'iat': datetime.datetime(2025, 6, 13, 12, 55, 2, 98287)}
2025-06-13 05:55:02,098 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyMjkwMiwiaWF0IjoxNzQ5ODE5MzAyfQ.Yvo1qDtVCvXNiSqJ3BHlssW3EbP8jOCxIBSBbkBlgZU

2025-06-13 06:03:11,478 - INFO - app.core.security - Closing Redis connection...
2025-06-13 06:03:11,478 - INFO - app.core.security - Redis connection closed.
2025-06-13 06:09:28,917 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 06:09:28,917 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 06:09:29,008 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:09:29,008 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:09:29,009 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:09:29,009 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 14, 9, 29, 8861), 'iat': datetime.datetime(2025, 6, 13, 13, 9, 29, 8866)}
2025-06-13 06:09:29,010 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyMzc2OSwiaWF0IjoxNzQ5ODIwMTY5fQ.58wXXZJlLxkkPfnuoJynCnmwkJ4_aKAXPuhKnbw35ag

2025-06-13 06:09:41,919 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:09:41,919 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:09:41,919 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:09:41,919 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 13, 39, 41, 918963), 'iat': datetime.datetime(2025, 6, 13, 13, 9, 41, 918973)}
2025-06-13 06:09:41,919 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjE5ODEsImlhdCI6MTc0OTgyMDE4MX0.Lww6l75UoVKq55N1mNo8mUWG41det5YLQrMDlE4eryU

2025-06-13 06:09:41,920 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MjQ5ODEsImlhdCI6MTc0OTgyMDE4MX0.YUJe5aOg1kguJLc6YU46c5HHXL-XzjYTHfzNVqJMZqI, Expiry (seconds): 604800
2025-06-13 06:09:41,925 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 06:09:43,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,024 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,024 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:09:43,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,025 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:43,036 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:43,036 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:43,036 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:43,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,058 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,059 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:09:43,059 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,060 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:43,083 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:43,083 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:43,083 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:43,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,090 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,091 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:43,127 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:43,129 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:43,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:43,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:43,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:43,318 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:43,344 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:43,345 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:44,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:44,119 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:44,119 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:44,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:44,119 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:44,131 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:44,131 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:09:44,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:44,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:44,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:46,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:09:46,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:09:46,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:46,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:09:46,067 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:09:46,081 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:09:46,081 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:10:12,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:10:12,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:10:12,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:10:12,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:10:12,486 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:10:12,512 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:10:12,513 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:10:40,461 - INFO - app.core.security - Closing Redis connection...
2025-06-13 06:10:40,462 - INFO - app.core.security - Redis connection closed.
2025-06-13 06:14:51,633 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 06:14:51,633 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 06:14:51,708 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:14:51,708 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:14:51,709 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:14:51,709 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 14, 14, 51, 708823), 'iat': datetime.datetime(2025, 6, 13, 13, 14, 51, 708829)}
2025-06-13 06:14:51,710 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyNDA5MSwiaWF0IjoxNzQ5ODIwNDkxfQ.NrzGDzZYtvVBnp96m1qEzyK6WJGCAg9oIAwagidHJF4

2025-06-13 06:14:54,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:54,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:54,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:54,906 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:54,906 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:55,057 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:55,058 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,350 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,350 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,351 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,351 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:56,403 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:56,403 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,470 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,470 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:14:56,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,471 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:56,479 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:56,480 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,480 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,508 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,509 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,509 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:14:56,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,510 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:56,518 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:56,519 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,519 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:56,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:56,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:56,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,878 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:56,878 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:56,885 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:56,885 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:57,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:57,648 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:57,651 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:57,651 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:57,651 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:57,668 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:57,668 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:14:57,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:57,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:57,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:58,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:14:58,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:14:58,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:58,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:14:58,521 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:14:58,529 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:14:58,529 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:15:10,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:15:10,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:15:10,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:10,613 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:10,614 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:15:10,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:15:10,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:15:10,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:10,618 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:10,618 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:15:10,685 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:15:10,685 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:15:10,686 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:15:56,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:15:56,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:15:56,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:56,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:15:56,818 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:15:56,825 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:15:56,825 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:15:59,466 - INFO - app.core.security - Closing Redis connection...
2025-06-13 06:15:59,467 - INFO - app.core.security - Redis connection closed.
2025-06-13 06:21:19,556 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 06:21:19,556 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 06:21:19,640 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:21:19,640 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:21:19,640 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:21:19,640 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 14, 21, 19, 640179), 'iat': datetime.datetime(2025, 6, 13, 13, 21, 19, 640183)}
2025-06-13 06:21:19,641 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyNDQ3OSwiaWF0IjoxNzQ5ODIwODc5fQ.gfrfFfMw7WzQb38-6bK7a95RKkH0hC-zNv0lfmjT98Q

2025-06-13 06:22:38,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:38,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:38,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:38,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:38,936 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:38,973 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:38,973 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:41,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:41,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:41,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:41,055 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:41,055 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:41,062 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:41,062 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:45,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:45,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:45,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:45,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:45,068 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:45,075 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:45,075 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:47,425 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:47,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:47,426 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:55,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:55,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:55,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:55,337 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:55,337 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:55,348 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:55,349 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:56,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:56,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:56,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:56,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:56,357 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:56,363 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:56,364 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,178 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,178 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:22:58,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,179 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:58,192 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:58,192 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,192 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,235 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,235 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,235 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:22:58,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,235 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,236 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,236 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:58,282 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:58,282 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,282 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,294 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:58,320 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:58,320 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:58,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:58,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:58,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:58,396 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:58,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:58,482 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:59,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:59,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:59,856 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:59,856 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:22:59,857 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:22:59,877 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:22:59,878 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:22:59,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:22:59,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:22:59,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:23:01,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:01,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:01,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:23:01,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:23:01,814 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:01,845 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:01,845 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:06,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:06,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:06,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:23:06,548 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749821981, 'iat': 1749820181}
2025-06-13 06:23:06,548 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:06,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:06,582 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:06,582 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjE5ODEsImlhdCI6MTc0OTgyMDE4MX0.Lww6l75UoVKq55N1mNo8mUWG41det5YLQrMDlE4eryU
2025-06-13 06:23:06,615 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjE5ODEsImlhdCI6MTc0OTgyMDE4MX0.Lww6l75UoVKq55N1mNo8mUWG41det5YLQrMDlE4eryU
2025-06-13 06:23:20,017 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:23:20,017 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:23:20,017 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:23:20,017 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 13, 13, 53, 20, 17194), 'iat': datetime.datetime(2025, 6, 13, 13, 23, 20, 17204)}
2025-06-13 06:23:20,018 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4MjI4MDAsImlhdCI6MTc0OTgyMTAwMH0.So5MSO-KFpGiQc9NovjyD00mzFHIrnx08q3-xSASuh8

2025-06-13 06:23:20,018 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0MjU4MDAsImlhdCI6MTc0OTgyMTAwMH0.90I4unEpLQCWts6rNEPZJ-dZUA9qseDi11iGVs3OMUE, Expiry (seconds): 604800
2025-06-13 06:23:20,023 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-13 06:23:21,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:21,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:21,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,135 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,135 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:23:21,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:21,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:21,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,137 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:21,147 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:21,147 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:21,147 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:21,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:21,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:21,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,171 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,171 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-13 06:23:21,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:21,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:21,173 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,173 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,173 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:21,184 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:21,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:21,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,185 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:21,185 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:21,202 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:21,203 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:21,203 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:21,210 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:21,210 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:22,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:22,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:22,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:22,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:22,423 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:22,441 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:22,442 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:22,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:22,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:22,464 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:23,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:23,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:23,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:23,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:23,510 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:23,613 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:23,614 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:23:25,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:23:25,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:23:25,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:25,323 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:23:25,323 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:23:25,342 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:23:25,343 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:24:23,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:24:23,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:24:23,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:23,369 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:23,369 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:24:23,377 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:24:23,378 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:24:26,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:24:26,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:24:26,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:26,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:26,012 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:24:26,022 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:24:26,023 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:24:35,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:24:35,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:24:35,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:35,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:35,153 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:24:35,167 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:24:35,170 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:24:53,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:24:53,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:24:53,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:53,467 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:24:53,467 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:24:53,478 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:24:53,479 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:25:24,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:25:24,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:25:24,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:25:24,154 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:25:24,154 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:25:24,161 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:25:24,162 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:26:10,663 - INFO - app.core.security - Closing Redis connection...
2025-06-13 06:26:10,664 - INFO - app.core.security - Redis connection closed.
2025-06-13 06:26:14,059 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-13 06:26:14,059 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-13 06:26:14,102 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-13 06:26:14,102 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-13 06:26:14,102 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-13 06:26:14,102 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 13, 14, 26, 14, 102516), 'iat': datetime.datetime(2025, 6, 13, 13, 26, 14, 102520)}
2025-06-13 06:26:14,103 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTgyNDc3NCwiaWF0IjoxNzQ5ODIxMTc0fQ.Fvwy3R5ml0pekYl9r7h5yBpz-VhvJZapp1YBzHWHRn8

2025-06-13 06:26:18,596 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:26:18,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:26:18,597 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:26:34,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:26:34,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:26:34,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:26:34,055 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:26:34,055 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:26:34,125 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:26:34,125 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:26:39,483 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:26:39,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:26:39,483 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:26:39,484 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:26:39,484 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:26:39,490 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:26:39,491 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:27:30,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-13 06:27:30,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-13 06:27:30,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:27:30,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749822800, 'iat': 1749821000}
2025-06-13 06:27:30,070 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-13 06:27:30,077 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-13 06:27:30,077 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-13 06:29:57,700 - INFO - app.core.security - Closing Redis connection...
2025-06-13 06:29:57,701 - INFO - app.core.security - Redis connection closed.
2025-06-14 01:10:10,568 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 01:10:10,568 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 01:10:12,662 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:10:12,662 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:10:12,663 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:10:12,663 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 14, 9, 10, 12, 662929), 'iat': datetime.datetime(2025, 6, 14, 8, 10, 12, 662933)}
2025-06-14 01:10:12,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTg5MjIxMiwiaWF0IjoxNzQ5ODg4NjEyfQ.LdTQ176hre68ZstkJTiIKL-uKAIy4ZlrX_t47UKNZdw

2025-06-14 01:15:16,933 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 01:15:16,933 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 01:15:16,989 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:15:16,989 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:15:16,989 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:15:16,989 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 14, 9, 15, 16, 989172), 'iat': datetime.datetime(2025, 6, 14, 8, 15, 16, 989174)}
2025-06-14 01:15:16,989 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTg5MjUxNiwiaWF0IjoxNzQ5ODg4OTE2fQ.kYiLSIrqc2BkfLUIpw5gHzH7PdYrUX3jGWp7kKRdErA

2025-06-14 01:16:48,684 - INFO - app.core.security - Closing Redis connection...
2025-06-14 01:16:48,686 - INFO - app.core.security - Redis connection closed.
2025-06-14 01:16:51,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 01:16:51,254 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 01:16:51,360 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:16:51,360 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:16:51,360 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:16:51,360 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 14, 9, 16, 51, 360088), 'iat': datetime.datetime(2025, 6, 14, 8, 16, 51, 360095)}
2025-06-14 01:16:51,361 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTg5MjYxMSwiaWF0IjoxNzQ5ODg5MDExfQ.mh4fPzNlwori9ZBKABIhfExq4Rn44F3NjRcYljoUpRs

2025-06-14 01:19:43,068 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:19:43,069 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:19:43,069 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:19:43,069 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 14, 8, 49, 43, 68726), 'iat': datetime.datetime(2025, 6, 14, 8, 19, 43, 68736)}
2025-06-14 01:19:43,069 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4OTA5ODMsImlhdCI6MTc0OTg4OTE4M30.1DIJ72P6ThSpbwqj4SIrIwRX9TQqOH4moR01ykom2vE

2025-06-14 01:19:43,071 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0OTM5ODMsImlhdCI6MTc0OTg4OTE4M30.a8-HVZbpp84LCYSNdrWzz-QojSZs7aA5Q5ss9_3pH_c, Expiry (seconds): 604800
2025-06-14 01:19:43,076 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-14 01:20:09,048 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:20:09,048 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:20:09,048 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:20:09,048 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 14, 8, 50, 9, 48474), 'iat': datetime.datetime(2025, 6, 14, 8, 20, 9, 48480)}
2025-06-14 01:20:09,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NDk4OTEwMDksImlhdCI6MTc0OTg4OTIwOX0.ZDCBqwaWJAe1D1eiotUAZ8tuOG1I2F4Lcl5TdQ6KolE

2025-06-14 01:20:09,049 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA0OTQwMDksImlhdCI6MTc0OTg4OTIwOX0.LNtQbdfYL101b2HcVym394QlWwDZsNR5fjr3J2T3rdc, Expiry (seconds): 604800
2025-06-14 01:20:09,052 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-14 01:20:56,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:20:56,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:20:56,895 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:20:56,895 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:20:56,896 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:20:56,908 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:20:56,909 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:22:54,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:22:54,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:22:54,160 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:22:54,164 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:03,042 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:03,042 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:03,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:23:03,043 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:23:03,043 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:23:03,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:03,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:03,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:23:03,044 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:23:03,044 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:23:03,054 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:23:03,054 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:23:03,054 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:23:55,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:23:55,602 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:55,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,613 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:23:55,615 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:55,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:23:55,626 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:55,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,637 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:23:55,638 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:55,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,649 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:23:55,651 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 01:23:55,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:23:55,667 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:23:55,668 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 01:24:08,142 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:24:08,142 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:24:08,142 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:24:08,142 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 14, 8, 54, 8, 142067), 'iat': datetime.datetime(2025, 6, 14, 8, 24, 8, 142075)}
2025-06-14 01:24:08,142 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4OTEyNDgsImlhdCI6MTc0OTg4OTQ0OH0.49SN7eqfvRh-WgnFgSwpbaFjqUnua2qjYzBzYTqrlsw

2025-06-14 01:24:08,143 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0OTQyNDgsImlhdCI6MTc0OTg4OTQ0OH0.no5O3-MikxeZwIuYs2yY3cgFDWeY4AV6LqQGQsdWuBw, Expiry (seconds): 604800
2025-06-14 01:24:08,146 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-14 01:24:09,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,258 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,258 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:24:09,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,259 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,259 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:09,264 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:09,264 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,265 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,280 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,280 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:24:09,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,280 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:09,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,291 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:09,296 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:09,296 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,296 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,313 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:09,313 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,642 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,643 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:09,648 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:09,648 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:09,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:09,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:09,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,702 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:09,702 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:09,780 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:09,780 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:10,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:10,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:10,636 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:10,636 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:10,636 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:10,643 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:10,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:57,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:24:57,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:24:57,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:57,619 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891248, 'iat': 1749889448}
2025-06-14 01:24:57,619 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:24:57,626 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:24:57,626 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:24:57,627 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4OTEyNDgsImlhdCI6MTc0OTg4OTQ0OH0.49SN7eqfvRh-WgnFgSwpbaFjqUnua2qjYzBzYTqrlsw
2025-06-14 01:24:57,631 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4OTEyNDgsImlhdCI6MTc0OTg4OTQ0OH0.49SN7eqfvRh-WgnFgSwpbaFjqUnua2qjYzBzYTqrlsw
2025-06-14 01:25:12,871 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:25:12,872 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:25:12,872 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:25:12,872 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 14, 8, 55, 12, 871689), 'iat': datetime.datetime(2025, 6, 14, 8, 25, 12, 871698)}
2025-06-14 01:25:12,872 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NDk4OTEzMTIsImlhdCI6MTc0OTg4OTUxMn0.HY4qJLICBuMgbidD6N6aQcIRldXixXqD5GrFxinVGfQ

2025-06-14 01:25:12,873 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA0OTQzMTIsImlhdCI6MTc0OTg4OTUxMn0.puTyWK8MfL8Pvye8aK9JtCWkVynYudiCZZew1ldoN-Y, Expiry (seconds): 604800
2025-06-14 01:25:12,876 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-14 01:25:14,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,035 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,035 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:25:14,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,036 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:14,043 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:14,044 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,044 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,055 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,055 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:25:14,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,055 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,055 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,055 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:14,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,066 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:14,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:14,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,077 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,093 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:14,094 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,838 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,839 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,839 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,839 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:14,839 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:14,853 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:14,853 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:14,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:14,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:14,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:15,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:15,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:15,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:15,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:15,568 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:15,575 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:15,576 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:25:16,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:25:16,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:25:16,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:16,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:25:16,441 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:25:16,456 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:25:16,456 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:26:17,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:26:17,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:26:17,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:26:17,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:26:17,389 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:26:17,398 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:26:17,399 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:27:17,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:27:17,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:27:17,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:27:17,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:27:17,390 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:27:17,405 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:27:17,406 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:28:15,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:28:15,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:28:15,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:28:15,414 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:28:15,414 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:28:15,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:28:15,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:28:15,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:28:15,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:28:15,416 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:28:15,472 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:28:15,473 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:28:15,473 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:28:17,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:28:17,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:28:17,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:28:17,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:28:17,386 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:28:17,399 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:28:17,400 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:29:22,615 - INFO - app.core.security - Closing Redis connection...
2025-06-14 01:29:22,617 - INFO - app.core.security - Redis connection closed.
2025-06-14 01:32:41,052 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 01:32:41,053 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 01:32:41,158 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:32:41,158 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:32:41,158 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:32:41,158 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 14, 9, 32, 41, 158738), 'iat': datetime.datetime(2025, 6, 14, 8, 32, 41, 158743)}
2025-06-14 01:32:41,160 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTg5MzU2MSwiaWF0IjoxNzQ5ODg5OTYxfQ.GQXUwciojnns1bjdvvfIjxZBBNjvwHhwt9izNovG1zI

2025-06-14 01:32:46,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:32:46,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:32:46,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:32:47,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:32:47,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:32:47,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:32:47,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1749891312, 'iat': 1749889512}
2025-06-14 01:32:47,401 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-14 01:32:47,447 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-14 01:32:47,447 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-14 01:32:59,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:32:59,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:32:59,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:32:59,574 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:32:59,574 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:32:59,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:32:59,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:32:59,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:32:59,576 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:32:59,576 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:32:59,622 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:32:59,622 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:32:59,623 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:34:12,412 - INFO - app.core.security - Closing Redis connection...
2025-06-14 01:34:12,413 - INFO - app.core.security - Redis connection closed.
2025-06-14 01:35:33,828 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 01:35:33,829 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 01:35:33,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 01:35:33,923 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 01:35:33,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 01:35:33,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 14, 9, 35, 33, 923295), 'iat': datetime.datetime(2025, 6, 14, 8, 35, 33, 923301)}
2025-06-14 01:35:33,924 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTg5MzczMywiaWF0IjoxNzQ5ODkwMTMzfQ._XCOJW0z-0EswaPyNZIwK2l547rEk88xXNBVhdAVK2c

2025-06-14 01:35:37,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:35:37,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:35:37,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:35:37,512 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:35:37,513 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:35:37,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:35:37,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:35:37,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:35:37,514 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:35:37,514 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:35:37,538 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:35:37,538 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:35:37,539 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:36:50,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:36:50,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:36:50,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:36:50,137 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:36:50,138 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 01:36:50,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 01:36:50,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 01:36:50,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:36:50,140 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1749891009, 'iat': 1749889209}
2025-06-14 01:36:50,140 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-14 01:36:50,157 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-14 01:36:50,158 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-14 01:36:50,159 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-14 23:18:18,508 - INFO - app.core.security - Closing Redis connection...
2025-06-14 23:18:18,508 - INFO - app.core.security - Redis connection closed.
2025-06-14 23:18:25,356 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-14 23:18:25,356 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-14 23:18:25,462 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 23:18:25,462 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 23:18:25,462 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 23:18:25,462 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 15, 7, 18, 25, 462493), 'iat': datetime.datetime(2025, 6, 15, 6, 18, 25, 462500)}
2025-06-14 23:18:25,463 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc0OTk3MTkwNSwiaWF0IjoxNzQ5OTY4MzA1fQ.vlXbc-LhmKypVQ6TptJfNJddnUzRePu4cBLbnqhuINA

2025-06-14 23:18:33,487 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:18:33,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:18:33,487 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 23:18:33,490 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 23:18:33,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:18:33,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:18:33,510 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 23:18:33,513 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 23:18:33,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:18:33,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:18:33,538 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 23:18:33,540 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 23:18:33,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:18:33,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:18:33,579 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-14 23:18:33,580 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-14 23:24:45,175 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-14 23:24:45,176 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-14 23:24:45,176 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-14 23:24:45,176 - DEBUG - app.core.security - Payload to encode: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': datetime.datetime(2025, 6, 15, 6, 54, 45, 175374), 'iat': datetime.datetime(2025, 6, 15, 6, 24, 45, 175392)}
2025-06-14 23:24:45,177 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNDlDME4iLCJleHAiOjE3NDk5NzA0ODUsImlhdCI6MTc0OTk2ODY4NX0.Fn6OCQqn_YuABg-OnIvG7NaiKO1M0LCCOAJVj-ZPwbQ

2025-06-14 23:24:45,178 - INFO - app.core.security - Storing refresh token for user ID 5 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI1IiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNDlDME4iLCJleHAiOjE3NTA1NzM0ODUsImlhdCI6MTc0OTk2ODY4NX0.nfROPW6Fmv9TNQVZy_kPmcqcCfhTw8PQMtvkCSvWKgc, Expiry (seconds): 604800
2025-06-14 23:24:45,185 - INFO - app.core.security - Refresh token stored successfully for user ID: 5
2025-06-14 23:24:46,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,401 - INFO - app.core.security - Token payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,401 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 23:24:46,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,403 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,403 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:46,421 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:46,421 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,421 - INFO - app.core.security - Authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,450 - INFO - app.core.security - Token payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,450 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-14 23:24:46,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,452 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,452 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:46,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,480 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,480 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:46,491 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:46,491 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,491 - INFO - app.core.security - Authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,539 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:46,539 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,564 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,565 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:46,587 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:46,587 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:46,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:46,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:46,688 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,688 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:46,689 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:46,765 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:46,767 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-14 23:24:47,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-14 23:24:47,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-14 23:24:47,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:47,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '5', 'user_type': 'demo', 'account_number': '49C0N', 'exp': 1749970485, 'iat': 1749968685}
2025-06-14 23:24:47,386 - INFO - app.core.security - Looking up demo user with ID: 5
2025-06-14 23:24:47,396 - INFO - app.core.security - Found demo user - ID: 5, Type: demo
2025-06-14 23:24:47,396 - INFO - app.core.security - Successfully authenticated user - ID: 5, Type: demo, Class: DemoUser
2025-06-15 21:18:57,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:18:57,212 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:18:59,331 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:18:59,331 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:18:59,332 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:18:59,332 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 18, 59, 331799), 'iat': datetime.datetime(2025, 6, 16, 4, 18, 59, 331803)}
2025-06-15 21:18:59,333 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTEzOSwiaWF0IjoxNzUwMDQ3NTM5fQ.2lwDw97Op_5YwWLOpi0Czr00wicxm8kRF8n3_nJsiQQ

2025-06-15 21:19:45,952 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:19:45,952 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:19:46,002 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:19:46,002 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:19:46,002 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:19:46,002 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 19, 46, 2644), 'iat': datetime.datetime(2025, 6, 16, 4, 19, 46, 2648)}
2025-06-15 21:19:46,003 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTE4NiwiaWF0IjoxNzUwMDQ3NTg2fQ.Q9IS_6cRHauefdE5BLqGvfGPFq5rjAGVaeeUngJ2Xbg

2025-06-15 21:21:12,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,145 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,153 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 21:21:12,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,178 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,180 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 21:21:12,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,196 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,203 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 21:21:12,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,222 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 21:21:12,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,244 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:12,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:12,269 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 21:21:12,278 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 21:21:25,141 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:21:25,141 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:21:25,141 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:21:25,141 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 4, 51, 25, 141168), 'iat': datetime.datetime(2025, 6, 16, 4, 21, 25, 141177)}
2025-06-15 21:21:25,142 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNDk0ODUsImlhdCI6MTc1MDA0NzY4NX0.uMk0Yeb15j5Z6O-DGMdUCNgoakhpa440Va6qcvZoMtE

2025-06-15 21:21:25,143 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTI0ODUsImlhdCI6MTc1MDA0NzY4NX0.1wRK83AysG4AqyXZO2ZeYvRFuqkyQIZWtnm-4fj_jgw, Expiry (seconds): 604800
2025-06-15 21:21:25,148 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,243 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,243 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,244 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,244 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:26,253 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:26,253 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:26,253 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:26,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,265 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,266 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,266 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:21:26,266 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,267 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,267 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,267 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:26,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,277 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,278 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,278 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:26,285 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:26,285 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:26,285 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:26,333 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:26,333 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:26,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:26,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:26,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:26,375 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:26,390 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:26,390 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:27,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:27,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:27,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:27,022 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:27,022 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:27,026 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:27,027 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:27,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:27,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:27,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:27,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:27,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:27,869 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:27,869 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:27,869 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:27,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:27,880 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:39,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:39,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:39,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:39,099 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:39,099 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:21:39,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:39,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:39,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:39,099 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:39,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:39,106 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:39,106 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:39,106 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:44,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:44,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:44,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:44,443 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:44,443 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:21:44,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:21:44,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:21:44,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:44,444 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:21:44,444 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:21:44,454 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:21:44,454 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:21:44,455 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:22:26,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:22:26,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:22:26,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:22:26,849 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:22:26,850 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:22:26,862 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:22:26,866 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:23:31,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:23:31,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:23:31,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:23:31,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:23:31,390 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:23:31,397 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:23:31,397 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:24:56,269 - ERROR - app.core.security - Unexpected error in decode_token: TypeError - 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable
2025-06-15 21:24:56,270 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials due to unexpected error
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 105, in decode_token
    raise JWTError("Could not validate credentials due to unexpected error")
jose.exceptions.JWTError: Could not validate credentials due to unexpected error
2025-06-15 21:25:04,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:25:04,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:25:04,051 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:25:04,051 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:25:04,051 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:25:04,055 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:25:04,055 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:25:44,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:25:44,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:25:44,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781583920, 'iat': 1750047920}
2025-06-15 21:25:44,791 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781583920, 'iat': 1750047920}
2025-06-15 21:25:44,791 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:25:44,791 - WARNING - app.core.security - Service account request missing or invalid target user_id/user_type. user_id: None, target_user_type: None
2025-06-15 21:26:09,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:26:09,131 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:26:09,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781583920, 'iat': 1750047920}
2025-06-15 21:26:09,131 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781583920, 'iat': 1750047920}
2025-06-15 21:26:09,131 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:26:09,131 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:26:09,139 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:27:55,176 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:27:55,180 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:27:59,390 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:27:59,391 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:27:59,431 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:27:59,431 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:27:59,431 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:27:59,431 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 27, 59, 431768), 'iat': datetime.datetime(2025, 6, 16, 4, 27, 59, 431771)}
2025-06-15 21:27:59,433 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTY3OSwiaWF0IjoxNzUwMDQ4MDc5fQ.DyxnpzpxyMK6n3_DiQBQO3V8faysyxriho-JMWpj3y8

2025-06-15 21:28:20,725 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:28:20,726 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:28:23,233 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:28:23,233 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:28:23,266 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:28:23,266 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:28:23,266 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:28:23,266 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 28, 23, 266115), 'iat': datetime.datetime(2025, 6, 16, 4, 28, 23, 266118)}
2025-06-15 21:28:23,266 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTcwMywiaWF0IjoxNzUwMDQ4MTAzfQ._cF074rtIAvBK_vhBqLVi5wGGN9vtqlJVzwnPaR-gQA

2025-06-15 21:28:34,113 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:28:34,114 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:28:34,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:28:34,114 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:28:34,114 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:28:34,126 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:28:34,126 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:28:40,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:28:40,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:28:40,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781584108, 'iat': 1750048108}
2025-06-15 21:28:40,864 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1781584108, 'iat': 1750048108}
2025-06-15 21:28:40,864 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:28:40,864 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:28:40,870 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:32:30,269 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:32:30,270 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:32:33,387 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:32:33,387 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:32:33,429 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:32:33,429 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:32:33,429 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:32:33,429 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 32, 33, 429204), 'iat': datetime.datetime(2025, 6, 16, 4, 32, 33, 429207)}
2025-06-15 21:32:33,429 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTk1MywiaWF0IjoxNzUwMDQ4MzUzfQ.oa-3iTCmMb9AkRnjEXa1k3NEydM--ByBP3FCeKUscRA

2025-06-15 21:32:57,763 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:32:57,763 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:33:00,362 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:33:00,363 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:33:00,387 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:33:00,387 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:33:00,387 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:33:00,387 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 33, 0, 387049), 'iat': datetime.datetime(2025, 6, 16, 4, 33, 0, 387051)}
2025-06-15 21:33:00,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MTk4MCwiaWF0IjoxNzUwMDQ4MzgwfQ.iMTLrswo3Jqrb0qw0O825nwbt3rwThDVgpj8b3i4-4I

2025-06-15 21:33:01,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:33:01,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:33:01,935 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:33:01,935 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:33:01,935 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:33:02,080 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:33:02,080 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:33:05,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:33:05,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:33:05,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:33:16,227 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:33:16,227 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:34:51,347 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:34:51,347 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:34:51,370 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:34:51,370 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:34:51,370 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:34:51,370 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'python_bridge', 'exp': datetime.datetime(2025, 6, 16, 5, 34, 51, 370392), 'iat': datetime.datetime(2025, 6, 16, 4, 34, 51, 370397)}
2025-06-15 21:34:51,370 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoicHl0aG9uX2JyaWRnZSIsImV4cCI6MTc1MDA1MjA5MSwiaWF0IjoxNzUwMDQ4NDkxfQ.9bl7MhOSFUnFXC4GVgBvCsW54ugBo-ZH_DN8Xzs_zXA

2025-06-15 21:35:13,969 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:35:13,970 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:36:44,375 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:36:44,375 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:36:44,396 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:36:44,396 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:36:44,396 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:36:44,396 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 11, 44, 396166), 'iat': datetime.datetime(2025, 6, 16, 4, 36, 44, 396169)}
2025-06-15 21:36:44,396 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MDcwNCwiaWF0IjoxNzUwMDQ4NjA0fQ.NyiWUnyoSPt3bMshFj95Pt7qzHeZOMXU_oXEg5cAPpA

2025-06-15 21:36:46,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:36:46,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:36:46,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:36:46,311 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750049485, 'iat': 1750047685}
2025-06-15 21:36:46,311 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:36:46,328 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:36:46,329 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:36:46,329 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNDk0ODUsImlhdCI6MTc1MDA0NzY4NX0.uMk0Yeb15j5Z6O-DGMdUCNgoakhpa440Va6qcvZoMtE
2025-06-15 21:36:46,335 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNDk0ODUsImlhdCI6MTc1MDA0NzY4NX0.uMk0Yeb15j5Z6O-DGMdUCNgoakhpa440Va6qcvZoMtE
2025-06-15 21:37:00,669 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:37:00,669 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:37:00,669 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:37:00,669 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 5, 7, 0, 669738), 'iat': datetime.datetime(2025, 6, 16, 4, 37, 0, 669741)}
2025-06-15 21:37:00,670 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTA0MjAsImlhdCI6MTc1MDA0ODYyMH0.lnd7ealrUDnUlshcixRl2DXWi7LnQwryy7v_MEzsqeU

2025-06-15 21:37:00,670 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTM0MjAsImlhdCI6MTc1MDA0ODYyMH0.kOEZvVB7tfNpxwRWs30XJ01YFvtgT8kNLEmJ1S5YbOQ, Expiry (seconds): 604800
2025-06-15 21:37:00,672 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 21:37:01,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:01,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:01,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,872 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,872 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:37:01,872 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:01,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:01,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,872 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:01,878 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:01,878 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:01,878 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:01,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:01,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:01,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,890 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,890 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:37:01,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:01,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:01,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,890 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:01,896 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:01,896 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:01,896 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:01,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:01,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:01,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,898 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:01,898 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:01,910 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:01,910 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:02,104 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:02,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:02,104 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,104 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,104 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:02,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:02,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:02,108 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,111 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:02,111 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:02,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:02,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:02,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,140 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:02,173 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:02,173 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:02,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:02,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:02,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:02,634 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:02,639 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:02,639 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:11,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:11,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:11,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:11,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:11,123 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:11,125 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:11,126 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:37:29,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:37:29,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:37:29,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:29,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:37:29,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:37:29,667 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:37:29,667 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:38:03,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:38:03,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:38:03,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:38:03,618 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:38:03,618 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:38:03,622 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:38:03,622 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:38:27,953 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:38:27,954 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:38:33,304 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:38:33,304 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:38:33,345 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:38:33,345 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:38:33,345 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:38:33,345 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 13, 33, 345778), 'iat': datetime.datetime(2025, 6, 16, 4, 38, 33, 345781)}
2025-06-15 21:38:33,346 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MDgxMywiaWF0IjoxNzUwMDQ4NzEzfQ.v4I9EtNmfVlxEGPshVQFwHms5owoDyL7tfl0EAgZdW4

2025-06-15 21:38:37,163 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:38:37,164 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:39:05,310 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:39:05,310 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:39:05,340 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:39:05,340 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:39:05,340 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:39:05,340 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 14, 5, 340840), 'iat': datetime.datetime(2025, 6, 16, 4, 39, 5, 340843)}
2025-06-15 21:39:05,341 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MDg0NSwiaWF0IjoxNzUwMDQ4NzQ1fQ.xgzJ7l9yQ9Wne6aAJqzpIh_nM4hfFRpHLE4D69nAtvU

2025-06-15 21:39:11,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:39:11,859 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:39:11,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750050420, 'iat': 1750048620}
2025-06-15 21:39:16,336 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:39:16,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:39:16,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:39:16,337 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:39:16,337 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:39:16,337 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:39:16,343 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:39:27,831 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:39:27,832 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:41:53,059 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:41:53,059 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:41:53,098 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:41:53,098 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:41:53,098 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:41:53,098 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 16, 53, 98766), 'iat': datetime.datetime(2025, 6, 16, 4, 41, 53, 98769)}
2025-06-15 21:41:53,099 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MTAxMywiaWF0IjoxNzUwMDQ4OTEzfQ.3n7SCMHfWJYIvJjZgL0f_skMibISshgnr0q3WGOSSyk

2025-06-15 21:42:02,672 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:42:02,672 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:42:05,108 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:42:05,108 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:42:05,145 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:42:05,145 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:42:05,145 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:42:05,145 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 17, 5, 145607), 'iat': datetime.datetime(2025, 6, 16, 4, 42, 5, 145612)}
2025-06-15 21:42:05,146 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MTAyNSwiaWF0IjoxNzUwMDQ4OTI1fQ.7he7BNCFutp9l_OyTqpnzndUqEnJwMfBN780QtkPqek

2025-06-15 21:42:07,276 - INFO - app.core.security - Closing Redis connection...
2025-06-15 21:42:07,276 - INFO - app.core.security - Redis connection closed.
2025-06-15 21:43:27,950 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 21:43:27,950 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 21:43:27,977 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:43:27,977 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:43:27,977 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:43:27,977 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 18, 27, 977142), 'iat': datetime.datetime(2025, 6, 16, 4, 43, 27, 977145)}
2025-06-15 21:43:27,977 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MTEwNywiaWF0IjoxNzUwMDQ5MDA3fQ.J9KPSIS9cu3hWz7XzIDhdst34EnmyGi5vHJ-cH_6M8w

2025-06-15 21:43:42,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:43:42,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:43:42,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:43:42,748 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:43:42,748 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:43:42,748 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:43:42,766 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:44:06,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:44:06,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:44:06,561 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:44:06,561 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:44:06,561 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:44:06,562 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:44:06,570 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:46:15,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:46:15,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:46:15,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:46:15,634 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:46:15,634 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:46:15,635 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:46:15,640 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:48:42,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:48:42,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:48:42,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:48:42,761 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:48:42,761 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:48:42,761 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:48:42,770 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:50:11,967 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:50:11,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:50:11,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:11,967 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:11,967 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:50:11,967 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:50:11,974 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:50:23,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:50:23,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:50:23,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:23,916 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:23,916 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:50:23,916 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:50:23,921 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:50:32,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:50:32,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:50:32,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:32,121 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750051107, 'iat': 1750049007}
2025-06-15 21:50:32,121 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:50:32,121 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:50:32,128 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:52:09,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:52:09,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:52:09,285 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:52:09,285 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:52:09,285 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:52:09,285 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:52:09,293 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:52:27,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:52:27,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:52:27,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:52:27,274 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:52:27,274 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:52:27,274 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:52:27,280 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:54:01,736 - ERROR - app.core.security - Unexpected error in decode_token: TypeError - 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable
2025-06-15 21:54:01,737 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials due to unexpected error
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 105, in decode_token
    raise JWTError("Could not validate credentials due to unexpected error")
jose.exceptions.JWTError: Could not validate credentials due to unexpected error
2025-06-15 21:54:27,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:54:27,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:54:27,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:54:27,848 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:54:27,848 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:54:27,848 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:54:27,856 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:54:58,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:54:58,950 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:54:58,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:54:58,950 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:54:58,950 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:54:58,951 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:54:58,960 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:56:51,712 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 21:56:51,713 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 21:56:51,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 21:56:51,713 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 5, 26, 51, 712758), 'iat': datetime.datetime(2025, 6, 16, 4, 56, 51, 712793)}
2025-06-15 21:56:51,713 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTE2MTEsImlhdCI6MTc1MDA0OTgxMX0.ayW6MZMmHxuwVeKo9CWI3ZRyfbKdk54muAnBmiY8Wvg

2025-06-15 21:56:51,713 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTQ2MTEsImlhdCI6MTc1MDA0OTgxMX0.-HMgLDIQImBzU5YpmV88KQ9_xvf4jWG6WYogo4RVVZ8, Expiry (seconds): 604800
2025-06-15 21:56:51,718 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 21:56:52,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:52,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:52,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,826 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,827 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:56:52,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:52,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:52,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,827 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:52,835 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:52,836 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:52,836 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:52,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:52,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:52,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,847 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,847 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 21:56:52,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:52,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:52,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,848 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:52,856 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:52,856 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:52,856 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:52,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:52,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:52,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,860 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:52,861 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:52,883 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:52,884 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:53,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:53,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:53,480 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:53,480 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:53,480 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:53,492 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:53,492 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:53,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:53,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:53,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:54,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:54,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:54,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:54,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:54,422 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:54,434 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:54,434 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:56:55,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:56:55,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:56:55,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:55,393 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:56:55,393 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:56:55,406 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:56:55,406 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:57:55,407 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:57:55,408 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:57:55,408 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:57:55,409 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:57:55,409 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:57:55,423 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:57:55,424 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 21:59:06,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:59:06,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:59:06,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:59:06,767 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750050845, 'iat': 1750048745}
2025-06-15 21:59:06,767 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 21:59:06,767 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 21:59:06,772 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 21:59:14,523 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 21:59:14,523 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 21:59:14,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:59:14,524 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 21:59:14,524 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 21:59:14,532 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 21:59:14,532 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:00:26,393 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:00:26,397 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:13:03,467 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:13:03,467 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:13:03,520 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:13:03,520 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:13:03,520 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:13:03,520 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 48, 3, 520754), 'iat': datetime.datetime(2025, 6, 16, 5, 13, 3, 520756)}
2025-06-15 22:13:03,521 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1Mjg4MywiaWF0IjoxNzUwMDUwNzgzfQ.m1ZI1oC_TslmXJIAnoIxu939fZb_wcSAkPDlO6nC2nA

2025-06-15 22:13:05,336 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:13:05,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:13:05,336 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:13:39,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:13:39,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:13:39,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:13:39,859 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:13:39,859 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:13:39,869 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:13:39,870 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:14:39,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:14:39,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:14:39,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:14:39,857 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:14:39,857 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:14:39,864 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:14:39,864 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:15:39,866 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:15:39,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:15:39,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:15:39,867 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:15:39,867 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:15:39,876 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:15:39,876 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:16:35,213 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:16:35,214 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:16:37,472 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:16:37,472 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:16:37,495 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:16:37,495 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:16:37,495 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:16:37,495 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 51, 37, 495150), 'iat': datetime.datetime(2025, 6, 16, 5, 16, 37, 495152)}
2025-06-15 22:16:37,495 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MzA5NywiaWF0IjoxNzUwMDUwOTk3fQ.BR4DZF1Whjg8j7KIY2K6NXPqkemDKXdTKONrX5vnzAk

2025-06-15 22:16:39,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:16:39,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:16:39,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:16:39,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:16:39,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:16:39,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:16:39,851 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:16:39,851 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:16:39,855 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:16:39,855 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:17:39,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:17:39,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:17:39,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:17:39,862 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:17:39,863 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:17:39,868 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:17:39,868 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:17:56,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:17:56,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:17:56,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 22:17:56,906 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 22:18:33,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:18:33,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:18:33,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053097, 'iat': 1750050997}
2025-06-15 22:18:33,780 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053097, 'iat': 1750050997}
2025-06-15 22:18:33,780 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 22:18:33,780 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 22:18:33,786 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 22:18:39,867 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:18:39,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:18:39,867 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:18:39,868 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:18:39,868 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:18:39,877 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:18:39,877 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:19:39,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:19:39,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:19:39,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:19:39,862 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:19:39,862 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:19:39,866 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:19:39,866 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:20:09,041 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:20:09,041 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:21:20,962 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:21:20,962 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:21:20,992 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:21:20,992 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:21:20,992 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:21:20,992 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 56, 20, 992379), 'iat': datetime.datetime(2025, 6, 16, 5, 21, 20, 992383)}
2025-06-15 22:21:20,993 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MzM4MCwiaWF0IjoxNzUwMDUxMjgwfQ.dOKy9IhBW2V40zzQpQS9H7yeJyst5dYtuwjZZhLcgAM

2025-06-15 22:21:26,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:21:26,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:21:26,876 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:21:30,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:21:30,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:21:30,360 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:21:30,360 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750051611, 'iat': 1750049811}
2025-06-15 22:21:30,360 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:21:30,368 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:21:30,368 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:21:53,572 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:21:53,573 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:23:55,222 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:23:55,222 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:23:55,261 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:23:55,261 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:23:55,261 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:23:55,261 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 5, 58, 55, 261252), 'iat': datetime.datetime(2025, 6, 16, 5, 23, 55, 261255)}
2025-06-15 22:23:55,261 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1MzUzNSwiaWF0IjoxNzUwMDUxNDM1fQ.ifb2t5PFHFHbx6kE8n7QztF-5wLK84ezwfciVOJ6r50

2025-06-15 22:24:28,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:24:28,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:24:28,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053535, 'iat': 1750051435}
2025-06-15 22:24:28,420 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053535, 'iat': 1750051435}
2025-06-15 22:24:28,420 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 22:24:28,420 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 22:24:28,431 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 22:24:57,168 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:24:57,168 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:28:02,974 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:28:02,974 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:28:02,999 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:28:02,999 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:28:02,999 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:28:02,999 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 3, 2, 999860), 'iat': datetime.datetime(2025, 6, 16, 5, 28, 2, 999863)}
2025-06-15 22:28:03,000 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1Mzc4MiwiaWF0IjoxNzUwMDUxNjgyfQ.3HLUeXzJMldNTlBrZpN19zSr-8XPCj83nnbQBcFGgUw

2025-06-15 22:28:29,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:28:29,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:28:29,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053535, 'iat': 1750051435}
2025-06-15 22:28:29,913 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750053535, 'iat': 1750051435}
2025-06-15 22:28:29,913 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 22:28:29,913 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 22:28:29,930 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 22:29:04,866 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:29:04,867 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:32:08,951 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:32:08,951 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:32:08,982 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:32:08,982 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:32:08,982 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:32:08,982 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 7, 8, 982590), 'iat': datetime.datetime(2025, 6, 16, 5, 32, 8, 982594)}
2025-06-15 22:32:08,983 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NDAyOCwiaWF0IjoxNzUwMDUxOTI4fQ.Pj_C8iLM79gpI88AHxDsCkMeSla2buJuXDL1Tokzn34

2025-06-15 22:33:05,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:33:05,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:33:05,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750054028, 'iat': 1750051928}
2025-06-15 22:33:05,497 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750054028, 'iat': 1750051928}
2025-06-15 22:33:05,497 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 22:33:05,497 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 22:33:05,502 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 22:35:10,740 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:35:10,741 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:35:48,136 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:35:48,137 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:35:48,168 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:35:48,168 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:35:48,169 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:35:48,169 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 10, 48, 168916), 'iat': datetime.datetime(2025, 6, 16, 5, 35, 48, 168919)}
2025-06-15 22:35:48,169 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NDI0OCwiaWF0IjoxNzUwMDUyMTQ4fQ.STgCw8_KznhkLmuBFh4ONNIG27j87BD6zHsGyzXdJGQ

2025-06-15 22:35:55,950 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:35:55,950 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:35:55,950 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:35:55,951 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 6, 5, 55, 950246), 'iat': datetime.datetime(2025, 6, 16, 5, 35, 55, 950259)}
2025-06-15 22:35:55,951 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTM5NTUsImlhdCI6MTc1MDA1MjE1NX0.xaDsTmwswTskRlHHR-rJsZbOWVzDaOjPOyCY7bG5__Y

2025-06-15 22:35:55,952 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTY5NTUsImlhdCI6MTc1MDA1MjE1NX0.OnC55bUr8OK4O6iS76lG2JFOvc2I9CQtcZoSAxW1T14, Expiry (seconds): 604800
2025-06-15 22:35:55,955 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 22:35:57,031 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,032 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,033 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:35:57,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,035 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:35:57,046 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:35:57,047 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,047 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,064 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,064 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:35:57,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,065 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:35:57,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:35:57,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,078 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,085 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:35:57,110 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:35:57,110 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:57,752 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:35:57,760 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:35:57,760 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:35:57,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:57,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:57,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:59,402 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:35:59,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:35:59,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:59,403 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:35:59,403 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:35:59,422 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:35:59,422 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:28,852 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:28,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:28,853 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:28,854 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:28,854 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:28,863 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:28,863 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:30,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:30,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:30,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:30,037 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:30,037 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:30,043 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:30,043 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:35,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:35,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:35,790 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:35,790 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:35,790 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:35,805 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:35,806 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:49,857 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:49,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:49,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,858 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,858 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:36:49,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:49,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:49,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,858 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,858 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:49,862 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:49,862 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:49,862 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,870 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,870 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:49,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,871 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:49,877 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:49,877 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:49,878 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:49,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:49,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:49,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:49,887 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:49,894 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:49,894 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:50,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:50,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:50,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:50,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:50,136 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:50,141 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:50,141 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:50,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:50,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:50,146 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:50,425 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:50,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:50,425 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:50,426 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:50,426 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:50,430 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:50,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,342 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,342 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,342 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,342 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:51,346 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:51,346 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,346 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,353 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,353 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:36:51,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,353 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,353 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:51,358 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:51,358 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,358 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,364 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,364 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:51,369 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:51,370 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,595 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,595 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,595 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:51,598 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:51,598 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:36:51,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:36:51,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:36:51,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,902 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:36:51,902 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:36:51,907 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:36:51,907 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:37:14,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:37:14,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:37:14,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:37:14,521 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750053955, 'iat': 1750052155}
2025-06-15 22:37:14,521 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:37:14,529 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:37:14,529 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:37:14,529 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTM5NTUsImlhdCI6MTc1MDA1MjE1NX0.xaDsTmwswTskRlHHR-rJsZbOWVzDaOjPOyCY7bG5__Y
2025-06-15 22:37:14,533 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTM5NTUsImlhdCI6MTc1MDA1MjE1NX0.xaDsTmwswTskRlHHR-rJsZbOWVzDaOjPOyCY7bG5__Y
2025-06-15 22:37:46,391 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:37:46,391 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:37:46,391 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:37:46,391 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 6, 7, 46, 391369), 'iat': datetime.datetime(2025, 6, 16, 5, 37, 46, 391372)}
2025-06-15 22:37:46,391 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTQwNjYsImlhdCI6MTc1MDA1MjI2Nn0.JQyrGk8XQQgCpC2LJ1CifUaGkiQy2G1cqQ03N_8jPyo

2025-06-15 22:37:46,391 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTcwNjYsImlhdCI6MTc1MDA1MjI2Nn0.N_TsBTwb7eFnRooyf3OZObW7HoaxN7s06D9ndEuBHdw, Expiry (seconds): 604800
2025-06-15 22:37:46,395 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 22:37:58,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:37:58,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:37:58,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750054066, 'iat': 1750052266}
2025-06-15 22:38:50,080 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:38:50,081 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:42:45,693 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:42:45,693 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:42:45,719 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:42:45,719 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:42:45,719 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:42:45,719 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 17, 45, 719010), 'iat': datetime.datetime(2025, 6, 16, 5, 42, 45, 719013)}
2025-06-15 22:42:45,719 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NDY2NSwiaWF0IjoxNzUwMDUyNTY1fQ.0OY5UAqytPhZEswMXXktC3Dr0FCvmuuDe3-pV-WDloc

2025-06-15 22:42:50,127 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:42:50,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:42:50,128 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750054066, 'iat': 1750052266}
2025-06-15 22:43:17,540 - INFO - app.core.security - Closing Redis connection...
2025-06-15 22:43:17,541 - INFO - app.core.security - Redis connection closed.
2025-06-15 22:55:51,735 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 22:55:51,735 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 22:55:51,773 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:55:51,773 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:55:51,773 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:55:51,773 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 30, 51, 773238), 'iat': datetime.datetime(2025, 6, 16, 5, 55, 51, 773240)}
2025-06-15 22:55:51,773 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NTQ1MSwiaWF0IjoxNzUwMDUzMzUxfQ.XYonXy7XIvgRNVQWvHBl2deMgXJdeZgsL1TCMvgM0xQ

2025-06-15 22:56:33,872 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:56:33,873 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:56:33,873 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:56:33,873 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 6, 26, 33, 872808), 'iat': datetime.datetime(2025, 6, 16, 5, 56, 33, 872814)}
2025-06-15 22:56:33,873 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTUxOTMsImlhdCI6MTc1MDA1MzM5M30.x0MILGhQdMDbM7E1NUgTZkAGdBr2JLaZwhrJ71A1KBY

2025-06-15 22:56:33,873 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTgxOTMsImlhdCI6MTc1MDA1MzM5M30.VWm1vdKmKZRQfdjoy-k8URHP6xVSgKqYPhFYawBmosw, Expiry (seconds): 604800
2025-06-15 22:56:33,876 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 22:56:46,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:56:46,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:56:46,614 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055193, 'iat': 1750053393}
2025-06-15 22:57:30,264 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 22:57:30,264 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 22:57:30,265 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 22:57:30,265 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 6, 27, 30, 264592), 'iat': datetime.datetime(2025, 6, 16, 5, 57, 30, 264602)}
2025-06-15 22:57:30,265 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTUyNTAsImlhdCI6MTc1MDA1MzQ1MH0.EFxqfb26HQ-kQc1Py5cAzsiR5fpPFDZh7Ta5Oy_YUrI

2025-06-15 22:57:30,265 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NTgyNTAsImlhdCI6MTc1MDA1MzQ1MH0.jRDLPeeu5a9A23z7pZxe2SGAfeaMUT78e6jrl70uTF8, Expiry (seconds): 604800
2025-06-15 22:57:30,268 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 22:57:31,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:31,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:31,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,398 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,398 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:31,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:31,398 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:31,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,399 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,399 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:31,404 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:31,404 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:31,404 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:31,410 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:31,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:31,412 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,412 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,412 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:31,412 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:31,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:31,413 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,413 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,413 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:31,466 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:31,467 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:31,467 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:31,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:31,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:31,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,497 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:31,497 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:31,576 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:31,576 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:32,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:32,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:32,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:32,239 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:32,239 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:32,244 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:32,245 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:32,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:32,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:32,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:33,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:33,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:33,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:33,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:33,435 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:33,452 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:33,452 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:47,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:47,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:47,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:47,147 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:47,147 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:47,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:47,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:47,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:47,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:47,171 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:47,179 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:47,179 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:47,179 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:49,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:49,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:49,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:49,622 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:49,623 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:49,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:49,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:49,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:49,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:49,623 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:49,629 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:49,630 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:49,630 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:51,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:51,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:51,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:51,682 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:51,685 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:51,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:51,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:51,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:51,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:51,688 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:51,704 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:51,704 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:51,704 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:55,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:55,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:55,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:55,188 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:55,188 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:57:55,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:57:55,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:57:55,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:55,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:57:55,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:57:55,196 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:57:55,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:57:55,196 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:10,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:10,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:10,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 22:59:10,214 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 22:59:10,215 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 22:59:10,215 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 22:59:10,223 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 22:59:33,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:33,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:33,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:33,018 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:33,018 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:59:33,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:33,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:33,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:33,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:33,018 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:59:33,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:59:33,025 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:33,025 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:41,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:41,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:41,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,545 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,545 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:59:41,545 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:41,545 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:41,546 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,546 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,546 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:59:41,553 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:59:41,553 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:41,554 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:41,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:41,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:41,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,949 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,949 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 22:59:41,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 22:59:41,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 22:59:41,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 22:59:41,949 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 22:59:41,958 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 22:59:41,958 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 22:59:41,959 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:00:06,476 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:00:06,476 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:00:06,476 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:06,476 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:06,476 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:00:06,477 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:00:06,480 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:00:19,167 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:00:19,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:00:19,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:19,168 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:19,168 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:00:19,168 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:00:19,171 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:00:31,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:00:31,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:00:31,169 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:31,169 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:00:31,169 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:00:31,169 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:00:31,173 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:01:00,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:01:00,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:01:00,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:01:00,145 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:01:00,145 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:01:00,145 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:01:00,151 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:01:21,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:01:21,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:01:21,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:01:21,904 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:01:21,904 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:01:21,904 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:01:21,909 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:01:42,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:01:42,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:01:42,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:42,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:42,465 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:01:42,468 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:01:42,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:01:48,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:01:48,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:01:48,513 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:48,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:48,513 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:01:48,519 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:01:48,519 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:01:52,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:01:52,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:01:52,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:52,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:01:52,085 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:01:52,091 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:01:52,092 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:02:34,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:02:34,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:02:34,328 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:02:34,328 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:02:34,328 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:02:34,328 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:02:34,331 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:02:58,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:02:58,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:02:58,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:02:58,066 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:02:58,066 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:02:58,066 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:02:58,069 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:03:05,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:03:05,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:03:05,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:03:05,202 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:03:05,202 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:03:05,202 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:03:05,206 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:03:08,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:03:08,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:03:08,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:03:08,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:03:08,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:03:08,525 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:03:08,525 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:03:24,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:03:24,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:03:24,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:03:24,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:03:24,439 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:03:24,443 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:03:24,443 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:03:45,924 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:03:45,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:03:45,925 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:03:45,925 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:03:45,925 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:03:45,925 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:03:45,928 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:07:10,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:07:10,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:07:10,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:07:10,402 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:07:10,402 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:07:10,405 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:07:10,406 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:07:42,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:07:42,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:07:42,338 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:07:42,338 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:07:42,338 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:07:42,338 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:07:42,342 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:08:20,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:08:20,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:08:20,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:08:20,882 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:08:20,882 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:08:20,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:08:20,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:08:20,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:08:20,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:08:20,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:08:20,886 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:08:20,886 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:08:20,886 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:08:51,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:08:51,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:08:51,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:08:51,059 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:08:51,059 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:08:51,059 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:08:51,062 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:09:26,481 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:09:26,481 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:16:57,945 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:16:57,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:16:57,972 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:16:57,972 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:16:57,972 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:16:57,972 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 6, 51, 57, 971994), 'iat': datetime.datetime(2025, 6, 16, 6, 16, 57, 971999)}
2025-06-15 23:16:57,973 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NjcxNywiaWF0IjoxNzUwMDU0NjE3fQ.FgH6CQXiHZiODDCb0sqyiRZOhe8tjfxS53etUohqUwI

2025-06-15 23:17:01,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:17:01,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:17:01,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:17:53,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:17:53,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:17:53,880 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:17:53,880 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:17:53,880 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:17:53,880 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:17:53,887 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:18:32,734 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:18:32,734 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:18:32,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:18:32,734 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:18:32,735 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:18:32,738 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:18:32,738 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:18:32,738 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:19:01,400 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:19:01,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:19:01,400 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:19:01,400 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:19:01,400 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:19:01,400 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:19:01,404 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:20:06,107 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:20:06,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:20:06,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:20:06,108 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:20:06,108 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:20:06,108 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:20:06,113 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:20:34,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:20:34,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:20:34,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:20:34,244 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:20:34,244 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:20:34,244 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:20:34,247 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:20:59,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:20:59,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:20:59,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:20:59,206 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:20:59,206 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:20:59,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:20:59,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:20:59,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:20:59,206 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750055250, 'iat': 1750053450}
2025-06-15 23:20:59,206 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:20:59,213 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:20:59,214 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:20:59,214 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:21:32,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:21:32,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:21:32,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:21:32,238 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:21:32,239 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:21:32,239 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:21:32,246 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:22:22,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:22:22,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:22:22,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:22:22,251 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750055451, 'iat': 1750053351}
2025-06-15 23:22:22,251 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:22:22,251 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:22:22,255 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:22:42,326 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:22:42,326 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:33:33,749 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:33:33,749 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:33:33,792 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:33:33,792 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:33:33,792 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:33:33,792 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 8, 33, 792097), 'iat': datetime.datetime(2025, 6, 16, 6, 33, 33, 792099)}
2025-06-15 23:33:33,793 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1NzcxMywiaWF0IjoxNzUwMDU1NjEzfQ.wkS_o0bxzjM39wfApFtzHXI9fkQA52eGnHTHVfvNtS0

2025-06-15 23:33:35,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:33:35,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:33:35,511 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:33:45,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:33:45,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:33:45,510 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:33:54,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:33:54,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:33:54,002 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:34:02,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:34:02,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:34:02,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:34:08,197 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:34:08,197 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:37:30,278 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:37:30,278 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:37:30,322 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:37:30,322 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:37:30,322 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:37:30,322 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 12, 30, 322374), 'iat': datetime.datetime(2025, 6, 16, 6, 37, 30, 322384)}
2025-06-15 23:37:30,323 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1Nzk1MCwiaWF0IjoxNzUwMDU1ODUwfQ.hHjbOqdQgpTcc0o6K1PXniH2z3oPdK1IuoRCad_nFU8

2025-06-15 23:38:10,166 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:38:10,167 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:38:12,453 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:38:12,453 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:38:12,485 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:38:12,485 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:38:12,485 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:38:12,485 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 13, 12, 485230), 'iat': datetime.datetime(2025, 6, 16, 6, 38, 12, 485236)}
2025-06-15 23:38:12,486 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1Nzk5MiwiaWF0IjoxNzUwMDU1ODkyfQ.7akQsazKEYqy00SINzkgYeRicLtIPbjjQTEY7O5I7W8

2025-06-15 23:39:02,375 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:39:02,375 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:39:02,375 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:39:02,375 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 7, 9, 2, 375126), 'iat': datetime.datetime(2025, 6, 16, 6, 39, 2, 375134)}
2025-06-15 23:39:02,376 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTc3NDIsImlhdCI6MTc1MDA1NTk0Mn0.F22LlMdNIZAWQ2CUd5YGQRW4WhBoRG_hUAvYj-vmdqQ

2025-06-15 23:39:02,376 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NjA3NDIsImlhdCI6MTc1MDA1NTk0Mn0.Dkw52BhH8QmxY9LW1wDmCx2AXFprOCnuOECwebce9GM, Expiry (seconds): 604800
2025-06-15 23:39:02,380 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 23:39:03,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:03,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:03,580 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,580 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,581 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:39:03,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:03,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:03,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:03,596 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:03,596 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:03,596 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:03,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:03,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:03,610 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,610 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,610 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:39:03,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:03,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:03,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:03,619 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:03,619 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:03,620 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:03,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:03,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:03,626 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,626 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:03,626 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:03,651 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:03,651 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:04,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:04,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:04,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:04,096 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:04,096 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:04,101 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:04,102 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:04,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:04,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:04,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:05,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:05,125 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:05,125 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:05,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:05,126 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:05,183 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:05,183 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:10,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:10,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:10,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:10,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:10,292 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:10,309 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:10,310 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:22,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:22,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:22,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:22,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:39:22,294 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:39:22,312 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:39:22,312 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:39:59,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:39:59,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:39:59,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:39:59,204 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 23:40:17,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:40:17,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:40:17,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:40:17,284 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:40:17,284 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:40:17,285 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:40:17,294 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:40:37,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:40:37,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:40:37,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:40:37,779 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:40:37,779 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:40:37,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:40:37,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:40:37,780 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:40:37,780 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:40:37,780 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:40:37,796 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:40:37,797 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:40:37,797 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:41:20,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:41:20,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:41:20,087 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-15 23:41:20,088 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-15 23:41:31,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:41:31,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:41:31,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:41:31,266 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:41:31,266 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:41:31,266 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:41:31,272 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:41:49,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:41:49,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:41:49,597 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:41:49,598 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:41:49,598 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:41:49,598 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:41:49,601 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:41:57,175 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:41:57,176 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:45:09,254 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:45:09,254 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:45:09,276 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:45:09,276 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:45:09,276 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:45:09,276 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 20, 9, 276459), 'iat': datetime.datetime(2025, 6, 16, 6, 45, 9, 276464)}
2025-06-15 23:45:09,276 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1ODQwOSwiaWF0IjoxNzUwMDU2MzA5fQ.ac9H9QWrOk8AZ9skYMhRxoVrCykQ4opizsPGjSfX3pg

2025-06-15 23:45:14,851 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:45:14,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:45:14,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:45:23,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:45:23,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:45:23,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:45:23,663 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:45:23,663 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:45:23,663 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:45:23,682 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:46:16,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:46:16,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:46:16,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:46:16,153 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:46:16,153 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:46:16,154 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:46:16,160 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:46:20,033 - INFO - app.core.security - Closing Redis connection...
2025-06-15 23:46:20,034 - INFO - app.core.security - Redis connection closed.
2025-06-15 23:50:03,241 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-15 23:50:03,241 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-15 23:50:03,271 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:50:03,271 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:50:03,271 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:50:03,271 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 25, 3, 271561), 'iat': datetime.datetime(2025, 6, 16, 6, 50, 3, 271564)}
2025-06-15 23:50:03,272 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA1ODcwMywiaWF0IjoxNzUwMDU2NjAzfQ.C5FjXge2fMMzQqIR1f5FcVPvLrLZp1m9P2nKLqYKR6s

2025-06-15 23:51:27,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:51:27,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:51:27,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:51:27,888 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:51:27,888 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:51:27,889 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:51:27,900 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:52:47,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,419 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,419 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:52:47,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:52:47,436 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:52:47,437 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,437 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,463 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,463 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:52:47,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,463 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:52:47,477 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:52:47,477 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,477 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,483 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,484 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,484 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,484 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:52:47,502 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:52:47,503 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,976 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,977 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,977 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,977 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:47,977 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:52:47,988 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:52:47,988 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:47,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:47,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:47,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:49,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:52:49,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:52:49,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:49,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750057742, 'iat': 1750055942}
2025-06-15 23:52:49,417 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:52:49,482 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:52:49,482 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:52:49,483 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTc3NDIsImlhdCI6MTc1MDA1NTk0Mn0.F22LlMdNIZAWQ2CUd5YGQRW4WhBoRG_hUAvYj-vmdqQ
2025-06-15 23:52:49,493 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTc3NDIsImlhdCI6MTc1MDA1NTk0Mn0.F22LlMdNIZAWQ2CUd5YGQRW4WhBoRG_hUAvYj-vmdqQ
2025-06-15 23:53:00,041 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-15 23:53:00,041 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-15 23:53:00,042 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-15 23:53:00,042 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 7, 23, 0, 41632), 'iat': datetime.datetime(2025, 6, 16, 6, 53, 0, 41643)}
2025-06-15 23:53:00,042 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNTg1ODAsImlhdCI6MTc1MDA1Njc4MH0.g6CCRAX8f4Zo-PnU4hW5RWuCOGwgKLVxcG9UjDYmjHU

2025-06-15 23:53:00,042 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NjE1ODAsImlhdCI6MTc1MDA1Njc4MH0.wRuQsNMp_Do2HkUX2olmVDpGIzSHTUAZR7I5IhddGRY, Expiry (seconds): 604800
2025-06-15 23:53:00,047 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-15 23:53:01,117 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,117 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,117 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:53:01,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,118 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,118 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:01,123 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:01,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,123 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,130 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,130 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,130 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:53:01,131 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,131 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,131 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,131 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,131 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:01,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,141 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:01,147 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:01,147 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,148 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,151 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:01,151 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,714 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:01,714 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:01,721 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:01,721 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:01,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:01,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:01,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:03,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:03,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:03,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:03,053 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:03,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:03,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:03,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:25,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:25,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:25,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:25,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:25,318 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:25,327 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:25,327 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:27,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:27,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:27,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:27,842 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:27,842 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:27,849 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:27,849 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:53:39,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:53:39,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:53:39,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:39,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:53:39,675 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:53:39,685 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:53:39,686 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:54:19,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:54:19,988 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:54:19,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:54:19,988 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:54:19,988 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:54:19,988 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:54:19,992 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:54:50,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:54:50,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:54:50,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:54:50,220 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:54:50,220 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-15 23:54:50,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:54:50,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:54:50,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:54:50,220 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:54:50,220 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:54:50,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:54:50,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:54:50,224 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:55:15,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:55:15,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:55:15,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:55:15,022 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:55:15,022 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:55:15,022 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:55:15,026 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:55:33,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:55:33,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:55:33,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:55:33,726 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:55:33,727 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:55:33,745 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:55:33,745 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:55:36,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:55:36,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:55:36,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:55:36,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:55:36,522 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:55:36,527 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:55:36,527 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:56:27,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:56:27,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:56:27,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:56:27,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:56:27,694 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:56:27,697 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:56:27,697 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:56:50,792 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:56:50,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:56:50,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:56:50,793 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:56:50,793 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:56:50,793 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:56:50,798 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:57:12,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:57:12,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:57:12,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:57:12,541 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:57:12,541 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:57:12,541 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:57:12,545 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:58:03,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:58:03,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:58:03,975 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:58:03,975 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:58:03,975 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:58:03,975 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:58:03,979 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-15 23:58:20,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:58:20,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:58:20,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:58:20,362 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-15 23:58:20,362 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-15 23:58:20,365 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-15 23:58:20,365 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-15 23:58:48,883 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-15 23:58:48,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-15 23:58:48,884 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:58:48,884 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-15 23:58:48,884 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-15 23:58:48,884 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-15 23:58:48,889 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:00:25,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:00:25,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:00:25,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:25,911 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:25,911 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:00:25,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:00:25,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:00:25,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:25,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:25,912 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:00:25,917 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:00:25,917 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:00:25,917 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:00:28,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:00:28,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:00:28,288 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:28,288 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:28,288 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:00:28,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:00:28,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:00:28,288 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:28,288 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:00:28,288 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:00:28,294 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:00:28,294 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:00:28,294 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:00:54,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:00:54,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:00:54,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:00:54,657 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:00:54,657 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:00:54,657 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:00:54,661 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:01:16,803 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:16,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:16,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:01:16,804 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:01:16,804 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:01:16,804 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:01:16,808 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:01:41,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:41,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:41,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:41,936 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:41,936 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:01:41,936 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:41,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:41,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:41,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:41,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:01:41,941 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:01:41,942 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:01:41,942 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:42,495 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:42,495 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:42,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:42,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:01:42,495 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:01:42,498 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:01:42,498 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:01:42,498 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:01:57,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:01:57,957 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:01:57,957 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:01:57,957 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:01:57,957 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:01:57,957 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:01:57,961 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:02:22,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:02:22,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:02:22,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:02:22,056 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:02:22,057 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:02:22,057 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:02:22,065 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:02:52,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:02:52,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:02:52,295 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:02:52,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:02:52,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:02:52,299 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:02:52,299 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:03:24,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:03:24,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:03:24,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:03:24,493 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750057992, 'iat': 1750055892}
2025-06-16 00:03:24,493 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:03:24,493 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:03:24,497 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:03:32,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:03:32,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:03:32,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:03:32,742 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:03:32,742 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:03:32,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:03:32,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:08:59,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:08:59,496 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:08:59,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:08:59,497 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:08:59,497 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:08:59,497 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:08:59,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:08:59,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:08:59,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:08:59,498 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:08:59,505 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:08:59,505 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:08:59,505 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:11:08,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:11:08,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:11:08,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:11:08,333 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:11:08,333 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:11:08,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:11:08,333 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:11:08,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:11:08,333 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:11:08,333 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:11:08,344 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:11:08,344 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:11:08,344 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:12:48,660 - INFO - app.core.security - Closing Redis connection...
2025-06-16 00:12:48,662 - INFO - app.core.security - Redis connection closed.
2025-06-16 00:14:25,663 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 00:14:25,663 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 00:14:25,738 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 00:14:25,738 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 00:14:25,738 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 00:14:25,738 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 7, 49, 25, 738023), 'iat': datetime.datetime(2025, 6, 16, 7, 14, 25, 738028)}
2025-06-16 00:14:25,739 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA2MDE2NSwiaWF0IjoxNzUwMDU4MDY1fQ.dSe-ezOi_X-TljeTM0isAQp8xOozCfmw-jsV1PtiXkc

2025-06-16 00:14:29,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:14:29,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:14:29,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:14:33,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:14:33,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:14:33,946 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 00:14:33,978 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 00:15:04,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:15:04,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:15:04,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:15:04,599 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:15:04,599 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:15:04,599 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:15:04,610 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:15:20,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:15:20,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:15:20,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:15:20,559 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:15:20,559 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:15:20,566 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:15:20,566 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:15:52,482 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:15:52,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:15:52,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:15:52,482 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:15:52,482 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:15:52,482 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:15:52,489 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:17:07,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:17:07,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:17:07,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:17:07,716 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750058580, 'iat': 1750056780}
2025-06-16 00:17:07,716 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:17:07,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:17:07,722 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:17:26,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:17:26,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:17:26,144 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 00:17:26,145 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 00:17:37,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:17:37,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:17:37,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:17:37,589 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:17:37,589 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:17:37,589 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:17:37,593 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:21:02,422 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 00:21:02,423 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 00:21:02,423 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 00:21:02,423 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 7, 51, 2, 422783), 'iat': datetime.datetime(2025, 6, 16, 7, 21, 2, 422788)}
2025-06-16 00:21:02,423 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNjAyNjIsImlhdCI6MTc1MDA1ODQ2Mn0.l7p5G8S_gvRgRz-CqLE-I2x6CyaTSYe-TRz0xawgjho

2025-06-16 00:21:02,423 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NjMyNjIsImlhdCI6MTc1MDA1ODQ2Mn0.iGeIMxr7Xus7NDvCpteDcWJXMYAOuPQd5pqStD5QIzo, Expiry (seconds): 604800
2025-06-16 00:21:02,426 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 00:21:15,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:21:15,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:21:15,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:21:15,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:21:15,138 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:21:15,141 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:21:15,142 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:22:43,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:22:43,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:22:43,314 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 00:22:43,316 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 00:22:54,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:22:54,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:22:54,356 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:22:54,356 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:22:54,356 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:22:54,356 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:22:54,360 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:23:13,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:23:13,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:23:13,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:23:13,052 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:23:13,052 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:23:13,053 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:23:13,058 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:24:07,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:24:07,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:24:07,903 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:07,903 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:07,903 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:24:07,907 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:24:07,907 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:24:26,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:24:26,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:24:26,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:26,583 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:26,583 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:24:26,588 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:24:26,588 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:24:55,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:24:55,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:24:55,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:55,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:24:55,148 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:24:55,153 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:24:55,154 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:25:18,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:25:18,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:25:18,529 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 00:25:18,531 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 00:25:31,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:25:31,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:25:31,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:25:31,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:25:31,900 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:25:31,906 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:25:31,906 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:25:36,524 - INFO - app.core.security - Closing Redis connection...
2025-06-16 00:25:36,525 - INFO - app.core.security - Redis connection closed.
2025-06-16 00:31:28,984 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 00:31:28,984 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 00:31:29,060 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 00:31:29,060 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 00:31:29,060 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 00:31:29,060 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 8, 6, 29, 60544), 'iat': datetime.datetime(2025, 6, 16, 7, 31, 29, 60547)}
2025-06-16 00:31:29,061 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA2MTE4OSwiaWF0IjoxNzUwMDU5MDg5fQ.U1IdEdSTWJLQ6vwfTMXKOSq0jg_z8ho0z0SELNf-K3g

2025-06-16 00:31:49,265 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:31:49,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:31:49,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:31:49,266 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060262, 'iat': 1750058462}
2025-06-16 00:31:49,266 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:31:49,272 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:31:49,272 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:32:38,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:32:38,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:32:38,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:32:38,343 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:32:38,343 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:32:38,343 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:32:38,352 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:33:03,381 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 00:33:03,381 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 00:33:03,381 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 00:33:03,381 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 8, 3, 3, 381285), 'iat': datetime.datetime(2025, 6, 16, 7, 33, 3, 381292)}
2025-06-16 00:33:03,382 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNjA5ODMsImlhdCI6MTc1MDA1OTE4M30.mhlYFZDKlKkn-W_0q2kZA_h9NwLyxTI54QuMwnix3b8

2025-06-16 00:33:03,382 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NjM5ODMsImlhdCI6MTc1MDA1OTE4M30.DmWrda5PQG96uUVhEx5e5f1D7OuyWLqvpNDnrO1KSTY, Expiry (seconds): 604800
2025-06-16 00:33:03,387 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 00:33:04,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:04,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:04,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,619 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,619 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:33:04,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:04,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:04,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,619 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,619 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:04,626 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:04,627 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:04,627 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:04,641 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:04,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:04,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,643 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,643 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:33:04,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:04,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:04,644 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,644 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,644 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:04,656 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:04,656 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:04,656 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:04,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:04,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:04,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,661 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:04,661 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:04,670 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:04,670 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:05,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:05,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:05,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:05,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:05,192 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:05,199 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:05,199 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:05,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:05,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:05,210 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:06,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:06,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:06,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:06,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:06,049 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:06,065 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:06,065 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:17,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:17,154 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:17,154 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:17,154 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:17,155 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 00:33:17,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:33:17,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:33:17,155 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:17,155 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750060983, 'iat': 1750059183}
2025-06-16 00:33:17,155 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 00:33:17,166 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 00:33:17,166 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:33:17,167 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 00:34:26,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 00:34:26,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 00:34:26,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:34:26,496 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750060165, 'iat': 1750058065}
2025-06-16 00:34:26,496 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 00:34:26,496 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 00:34:26,502 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 00:37:35,980 - INFO - app.core.security - Closing Redis connection...
2025-06-16 00:37:35,981 - INFO - app.core.security - Redis connection closed.
2025-06-16 01:12:03,036 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 01:12:03,036 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 01:12:03,096 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 01:12:03,096 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 01:12:03,096 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 01:12:03,096 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 8, 47, 3, 96501), 'iat': datetime.datetime(2025, 6, 16, 8, 12, 3, 96505)}
2025-06-16 01:12:03,097 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA2MzYyMywiaWF0IjoxNzUwMDYxNTIzfQ.unmxPwyn5tgWSc5W_2sIXKGmqiszbUDC8hH9-bdOPas

2025-06-16 01:12:04,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:12:04,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:12:04,882 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 01:12:10,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:12:10,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:12:10,856 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 01:12:16,854 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:12:16,854 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:12:16,855 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 01:12:20,200 - INFO - app.core.security - Closing Redis connection...
2025-06-16 01:12:20,201 - INFO - app.core.security - Redis connection closed.
2025-06-16 01:12:22,503 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 01:12:22,503 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 01:12:22,531 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 01:12:22,531 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 01:12:22,531 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 01:12:22,531 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 8, 47, 22, 531013), 'iat': datetime.datetime(2025, 6, 16, 8, 12, 22, 531017)}
2025-06-16 01:12:22,531 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA2MzY0MiwiaWF0IjoxNzUwMDYxNTQyfQ.LE9lotl5pvlkiSepuVwEi8gegyqu4MW93_xqqenPbdw

2025-06-16 01:12:24,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:12:24,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:12:24,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 01:12:29,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:12:29,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:12:29,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 01:15:30,876 - ERROR - app.core.security - Unexpected error in decode_token: TypeError - 'NoneType' object is not subscriptable
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable
2025-06-16 01:15:30,877 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials due to unexpected error
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 95, in decode_token
    logger.debug(f"Attempting to decode token: {token[:30]}...")
                                                ~~~~~^^^^^
TypeError: 'NoneType' object is not subscriptable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 105, in decode_token
    raise JWTError("Could not validate credentials due to unexpected error")
jose.exceptions.JWTError: Could not validate credentials due to unexpected error
2025-06-16 01:16:07,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:16:07,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:16:07,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750063642, 'iat': 1750061542}
2025-06-16 01:16:07,552 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750063642, 'iat': 1750061542}
2025-06-16 01:16:07,553 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 01:16:07,553 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 01:16:07,607 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 01:16:32,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 01:16:32,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 01:16:32,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750063642, 'iat': 1750061542}
2025-06-16 01:16:32,966 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750063642, 'iat': 1750061542}
2025-06-16 01:16:32,966 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 01:16:32,966 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 01:16:32,974 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 01:18:54,734 - INFO - app.core.security - Closing Redis connection...
2025-06-16 01:18:54,735 - INFO - app.core.security - Redis connection closed.
2025-06-16 02:31:41,651 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 02:31:41,651 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 02:31:41,757 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 02:31:41,757 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 02:31:41,757 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 02:31:41,757 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 10, 6, 41, 757451), 'iat': datetime.datetime(2025, 6, 16, 9, 31, 41, 757454)}
2025-06-16 02:31:41,771 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA2ODQwMSwiaWF0IjoxNzUwMDY2MzAxfQ.KV27zAo-BVu_OqpHaWKbfoOCgk1VrIGECkgayOdpAao

2025-06-16 02:32:23,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,338 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:23,342 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 02:32:23,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,372 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:23,374 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 02:32:23,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,386 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:23,387 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 02:32:23,405 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,405 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,405 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:23,407 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 02:32:23,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,421 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:23,423 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 02:32:23,442 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:23,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:23,443 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 02:32:36,636 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 02:32:36,636 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 02:32:36,636 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 02:32:36,636 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 10, 2, 36, 636032), 'iat': datetime.datetime(2025, 6, 16, 9, 32, 36, 636041)}
2025-06-16 02:32:36,636 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNjgxNTYsImlhdCI6MTc1MDA2NjM1Nn0.boLCMu_jV0Avd3ix5YIbz6ET9dXcJa0nKRnzI9vlWzA

2025-06-16 02:32:36,637 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzExNTYsImlhdCI6MTc1MDA2NjM1Nn0.LBX-edLLyHFs6OnBoPEB2mR7SARPx_XdNyW6yYpyORc, Expiry (seconds): 604800
2025-06-16 02:32:36,641 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 02:32:37,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:37,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:37,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,714 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,714 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 02:32:37,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:37,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:37,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,715 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:37,724 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:37,725 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:37,725 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:37,758 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:37,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:37,759 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,759 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,759 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 02:32:37,759 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:37,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:37,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,762 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,762 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:37,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:37,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:37,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:37,773 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:37,785 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:37,785 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:37,785 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:37,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:37,812 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:38,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:38,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:38,010 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:38,011 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:38,011 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:38,028 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:38,028 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:38,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:38,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:38,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:38,451 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:38,451 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:38,458 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:38,459 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:38,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:38,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:38,558 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:39,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:39,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:39,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:39,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:39,473 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:39,487 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:39,487 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:32:53,533 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:32:53,533 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:32:53,533 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:53,533 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:32:53,534 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:32:53,550 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:32:53,550 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:33:38,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:33:38,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:33:38,856 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:33:38,856 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:33:38,856 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:33:38,870 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:33:38,872 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:08,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:08,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:08,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:34:08,690 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:34:08,691 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 02:34:08,691 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 02:34:08,696 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 02:34:38,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:38,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:38,851 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:38,851 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:38,852 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:38,863 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:38,863 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,332 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,332 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,332 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 02:34:48,332 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,332 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,333 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,333 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:48,339 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:48,339 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,339 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,346 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,347 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,347 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 02:34:48,347 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,347 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,347 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,347 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,347 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:48,351 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:48,351 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,352 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,357 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,357 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:48,361 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:48,362 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,580 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,580 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:48,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,587 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:48,587 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:48,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:48,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:48,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:48,911 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:48,915 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:48,915 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:50,123 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:50,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:50,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:50,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:50,123 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:50,130 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:50,130 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:34:59,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:34:59,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:34:59,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:59,015 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:34:59,015 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:34:59,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:34:59,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:35:46,879 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:35:46,879 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:35:46,880 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:35:46,880 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:35:46,880 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 02:35:46,880 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 02:35:46,883 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 02:35:50,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:35:50,126 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:35:50,126 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:35:50,126 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:35:50,126 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:35:50,132 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:35:50,132 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:35:55,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:35:55,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:35:55,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:35:55,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:35:55,987 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:35:55,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:35:55,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:36:13,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:36:13,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:36:13,873 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:13,873 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:13,873 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:36:13,885 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:36:13,885 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:36:38,036 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:36:38,036 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:36:38,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:36:38,037 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750068401, 'iat': 1750066301}
2025-06-16 02:36:38,037 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 02:36:38,037 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 02:36:38,042 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 02:36:50,124 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:36:50,125 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:36:50,125 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:50,125 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:50,125 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:36:50,132 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:36:50,132 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:36:59,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:36:59,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:36:59,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:59,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:36:59,885 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:36:59,889 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:36:59,889 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:37:50,274 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:37:50,274 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:37:50,275 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:37:50,275 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:37:50,275 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:37:50,282 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:37:50,282 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:38:51,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:38:51,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:38:51,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:38:51,607 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:38:51,607 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:38:51,610 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:38:51,610 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:40:12,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:40:12,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:40:12,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:40:12,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:40:12,985 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:40:12,988 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:40:12,988 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:40:50,124 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 02:40:50,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 02:40:50,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:40:50,125 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750068156, 'iat': 1750066356}
2025-06-16 02:40:50,125 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 02:40:50,135 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 02:40:50,136 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 02:41:37,289 - INFO - app.core.security - Closing Redis connection...
2025-06-16 02:41:37,289 - INFO - app.core.security - Redis connection closed.
2025-06-16 03:05:29,252 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 03:05:29,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 03:05:29,360 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:05:29,360 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:05:29,360 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:05:29,360 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 10, 40, 29, 360023), 'iat': datetime.datetime(2025, 6, 16, 10, 5, 29, 360027)}
2025-06-16 03:05:29,362 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3MDQyOSwiaWF0IjoxNzUwMDY4MzI5fQ.CgHcMYmV8ApL_gj0fA8dV0J9zpSxAN59ugkGjE67zpw

2025-06-16 03:05:34,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:34,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:34,212 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:05:34,250 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:05:55,197 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:05:55,197 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:05:55,197 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:05:55,198 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 10, 35, 55, 197216), 'iat': datetime.datetime(2025, 6, 16, 10, 5, 55, 197232)}
2025-06-16 03:05:55,198 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzAxNTUsImlhdCI6MTc1MDA2ODM1NX0.hWVPT9qwgX__RoWoJSchCUTrlc1Jh7pPi2RvVIk3aEs

2025-06-16 03:05:55,199 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzMxNTUsImlhdCI6MTc1MDA2ODM1NX0.UgsyC6JGbcy2qvehhowEngOs-aa5kQ-nAnu9ouzZ5B4, Expiry (seconds): 604800
2025-06-16 03:05:55,214 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:05:56,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:56,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:56,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,835 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,835 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:05:56,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:56,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:56,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,837 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:05:56,862 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:05:56,863 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:56,863 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:56,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:56,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:56,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,898 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:05:56,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:56,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:56,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,902 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,902 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:05:56,920 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:05:56,920 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:56,920 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:56,925 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:56,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:56,926 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,926 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:56,927 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:05:56,965 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:05:56,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:58,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:58,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:58,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:58,320 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:58,322 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:05:58,350 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:05:58,351 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:05:58,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:58,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:58,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:59,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:05:59,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:05:59,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:59,764 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:05:59,764 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:06:00,587 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:06:00,588 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:06:01,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:06:01,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:06:01,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:06:01,281 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:06:01,283 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:06:01,317 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:06:01,317 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:06:09,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:06:09,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:06:09,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:06:09,805 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:06:09,805 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:06:09,829 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:06:09,831 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:06:55,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:06:55,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:06:55,149 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:06:55,153 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:07:00,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:07:00,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:07:00,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:07:00,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:07:00,007 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:07:00,052 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:07:00,053 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:07:26,336 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:07:26,336 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:07:26,337 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:07:26,337 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:07:26,338 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 03:07:26,338 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 03:07:26,352 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 03:08:26,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:08:26,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:08:26,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:08:26,700 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:08:26,701 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:08:26,714 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:08:26,716 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:08:43,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:08:43,055 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:08:43,056 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:08:43,059 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:09:11,317 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:09:11,317 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:09:11,318 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:09:11,318 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 10, 39, 11, 317047), 'iat': datetime.datetime(2025, 6, 16, 10, 9, 11, 317062)}
2025-06-16 03:09:11,319 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzAzNTEsImlhdCI6MTc1MDA2ODU1MX0.jQ0bF1On0OWq0rGRSlhA_GLl2Bn9jkF-GlqBQBLggcg

2025-06-16 03:09:11,319 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzMzNTEsImlhdCI6MTc1MDA2ODU1MX0.BIIC4BwOreElZI8spvK3ttUDU40IqhOEhM5Fa4f1H6c, Expiry (seconds): 604800
2025-06-16 03:09:11,323 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:09:22,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:09:22,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:09:22,052 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:09:22,052 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:09:22,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:09:22,066 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:09:22,072 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:16,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:16,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:16,090 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:11:16,090 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:11:16,090 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 03:11:16,091 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 03:11:16,102 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 03:11:25,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:25,163 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:25,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:25,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:25,165 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:25,179 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:25,180 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,563 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,564 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,564 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,564 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:11:27,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,566 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,566 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,567 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:27,581 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:27,581 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,582 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,607 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,608 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:11:27,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:27,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:27,635 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,639 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,661 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,661 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:27,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:27,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:27,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,682 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:27,683 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:27,703 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:27,704 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:27,734 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:27,738 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:29,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:29,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:30,002 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:30,002 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:30,002 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:30,016 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:30,017 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:11:30,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:30,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:30,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:32,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:11:32,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:11:32,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:32,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:11:32,523 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:11:32,553 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:11:32,557 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:12:27,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:12:27,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:12:27,878 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:12:27,878 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:12:27,879 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:12:27,897 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:12:27,898 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:13:30,007 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:13:30,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:13:30,008 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:13:30,009 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:13:30,009 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:13:30,032 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:13:30,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:13:32,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:13:32,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:13:32,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:13:32,512 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:13:32,512 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:13:32,540 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:13:32,541 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:14:04,103 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:14:04,104 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:14:04,104 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:14:04,105 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070351, 'iat': 1750068551}
2025-06-16 03:14:04,105 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:14:04,119 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:14:04,119 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:14:37,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:14:37,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:14:37,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:14:37,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750070155, 'iat': 1750068355}
2025-06-16 03:14:37,946 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:14:37,963 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:14:37,963 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:15:17,146 - INFO - app.core.security - Closing Redis connection...
2025-06-16 03:15:17,147 - INFO - app.core.security - Redis connection closed.
2025-06-16 03:24:00,535 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 03:24:00,536 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 03:24:00,600 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:24:00,600 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:24:00,600 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:24:00,600 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 10, 59, 0, 600521), 'iat': datetime.datetime(2025, 6, 16, 10, 24, 0, 600524)}
2025-06-16 03:24:00,601 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3MTU0MCwiaWF0IjoxNzUwMDY5NDQwfQ.RMIlFvsrtLd8e1fiL1Z0Ki1WU-8xHtXT77cIotNYTek

2025-06-16 03:24:03,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:24:03,568 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:24:03,568 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:24:03,569 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 10, 54, 3, 568512), 'iat': datetime.datetime(2025, 6, 16, 10, 24, 3, 568520)}
2025-06-16 03:24:03,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzEyNDMsImlhdCI6MTc1MDA2OTQ0M30.f3WgORhdxshNiRKIFUEW4WM54PaWekQTnpKvnrar5tc

2025-06-16 03:24:03,569 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzQyNDMsImlhdCI6MTc1MDA2OTQ0M30.O_wDZwqFSEIDT0q7RZjrUZZRvkAuIKWrxp8R7A-VMmE, Expiry (seconds): 604800
2025-06-16 03:24:03,572 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:24:04,664 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:04,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:04,665 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,666 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,666 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:24:04,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:04,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:04,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,667 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,667 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:04,676 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:04,676 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:04,676 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:04,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:04,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:04,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,693 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,693 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:24:04,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:04,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:04,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,694 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:04,704 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:04,704 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:04,704 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:04,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:04,707 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:04,707 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,708 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:04,708 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:04,719 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:04,720 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:05,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:05,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:05,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:05,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:05,214 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:05,223 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:05,223 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:05,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:05,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:05,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:06,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:06,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:06,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:06,147 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:06,147 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:06,162 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:06,162 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:24:07,074 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:24:07,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:24:07,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:07,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:24:07,074 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:24:07,133 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:24:07,133 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:03,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:03,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:03,857 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:25:03,859 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:25:03,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:03,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:03,958 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:25:03,959 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:25:03,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:03,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:03,964 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:25:03,965 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:25:04,070 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:04,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:04,070 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:25:04,072 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:25:04,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:04,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:04,091 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:25:04,093 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:25:19,886 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:25:19,886 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:25:19,886 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:25:19,886 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 10, 55, 19, 886658), 'iat': datetime.datetime(2025, 6, 16, 10, 25, 19, 886661)}
2025-06-16 03:25:19,887 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzEzMTksImlhdCI6MTc1MDA2OTUxOX0.UNye5mR2B47ohf1hNjxC6LN18YywkDfKShxoD-4Tq5s

2025-06-16 03:25:19,887 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzQzMTksImlhdCI6MTc1MDA2OTUxOX0.9km0yGLeVFkaz9on19DgUOIwYA-BB_a3uldGicArRc0, Expiry (seconds): 604800
2025-06-16 03:25:19,889 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:25:20,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:20,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:20,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,959 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,959 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:25:20,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:20,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:20,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,961 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,961 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:20,966 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:20,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:20,966 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:20,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:20,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:20,973 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,973 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,973 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:25:20,973 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:20,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:20,974 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,974 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,974 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:20,978 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:20,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:20,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:20,980 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:20,986 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:20,986 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:20,986 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:20,989 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:20,989 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:21,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:21,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:21,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,189 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,189 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:21,192 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:21,192 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:21,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:21,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:21,195 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:21,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:21,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,303 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:21,344 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:21,345 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:25:21,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:25:21,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:25:21,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,662 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:25:21,662 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:25:21,666 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:25:21,666 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:26:21,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:26:21,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:26:21,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:26:21,841 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:26:21,841 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:26:21,848 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:26:21,848 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:21,856 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:21,856 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:21,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:27:21,857 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071319, 'iat': 1750069519}
2025-06-16 03:27:21,857 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:21,863 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:21,864 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,553 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,553 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,553 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,553 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:46,556 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:46,556 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,556 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,561 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,561 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,561 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,561 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:27:46,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,562 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,562 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:46,565 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:46,565 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,566 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,570 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,571 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:46,574 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:46,574 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,898 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:46,898 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:46,903 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:46,903 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:46,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:46,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:46,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:47,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:47,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:47,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:47,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:47,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:47,297 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:47,297 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:27:48,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:27:48,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:27:48,455 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:48,456 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:27:48,456 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:27:48,461 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:27:48,461 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,706 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,706 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:28:37,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,706 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,706 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:37,710 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:37,711 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,711 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,718 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,719 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,719 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:28:37,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,719 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,719 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:37,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,727 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:37,732 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:37,732 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,732 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,736 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:37,736 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,758 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,759 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,760 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,760 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:37,770 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:37,770 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:37,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:37,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:37,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:37,995 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:38,000 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:38,000 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:38,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:38,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:38,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:38,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:38,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:38,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:38,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:38,279 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:38,285 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:38,285 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:47,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:28:47,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:28:47,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:47,629 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071243, 'iat': 1750069443}
2025-06-16 03:28:47,629 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:28:47,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:28:47,636 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:28:47,636 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzEyNDMsImlhdCI6MTc1MDA2OTQ0M30.f3WgORhdxshNiRKIFUEW4WM54PaWekQTnpKvnrar5tc
2025-06-16 03:28:47,639 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzEyNDMsImlhdCI6MTc1MDA2OTQ0M30.f3WgORhdxshNiRKIFUEW4WM54PaWekQTnpKvnrar5tc
2025-06-16 03:31:58,787 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:31:58,787 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:31:58,787 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:31:58,787 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 11, 1, 58, 787316), 'iat': datetime.datetime(2025, 6, 16, 10, 31, 58, 787327)}
2025-06-16 03:31:58,788 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzE3MTgsImlhdCI6MTc1MDA2OTkxOH0.8nJHDkO2fUmmUMnoJLmVDCWd5BpqrIRX7m5wIxGAN90

2025-06-16 03:31:58,788 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzQ3MTgsImlhdCI6MTc1MDA2OTkxOH0.vUoDyUSg8vxlcp6D8q1iR6_RQ0eglYbigyHb-O5d6YI, Expiry (seconds): 604800
2025-06-16 03:31:58,790 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:31:59,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:31:59,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:31:59,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,864 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,864 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:31:59,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:31:59,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:31:59,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,865 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:31:59,872 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:31:59,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:31:59,873 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:31:59,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:31:59,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:31:59,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,882 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,882 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:31:59,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:31:59,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:31:59,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:31:59,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:31:59,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:31:59,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:31:59,892 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:31:59,900 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:31:59,901 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:31:59,901 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:31:59,906 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:31:59,906 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:32:00,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:00,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:00,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:00,141 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:00,141 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:32:00,155 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:32:00,155 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:32:00,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:00,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:00,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:00,375 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:00,376 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:32:00,381 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:32:00,381 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:32:00,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:00,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:00,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:02,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:02,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:02,230 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:02,230 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:02,230 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:32:02,240 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:32:02,240 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:32:19,497 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:19,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:19,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:19,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:19,498 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:32:19,506 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:32:19,506 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:32:49,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:32:49,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:32:49,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:49,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:32:49,981 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:32:49,992 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:32:49,992 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:33:01,511 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:33:01,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:33:01,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:33:01,512 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:33:01,512 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:33:01,517 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:33:01,517 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:33:58,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:33:58,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:33:58,076 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:33:58,076 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750070429, 'iat': 1750068329}
2025-06-16 03:33:58,076 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 03:33:58,076 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 03:33:58,082 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 03:34:16,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:34:16,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:34:16,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:34:16,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:34:16,139 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:34:16,148 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:34:16,148 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:34:39,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:34:39,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:34:39,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:34:39,821 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:34:39,821 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:34:39,826 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:34:39,827 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:35:47,727 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:35:47,727 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:35:47,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:35:47,728 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:35:47,728 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:35:47,734 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:35:47,734 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:36:12,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:36:12,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:36:12,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:36:12,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:36:12,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:36:12,665 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:36:12,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:36:17,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:36:17,363 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:36:17,363 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:36:17,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:36:17,363 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:36:17,371 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:36:17,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:37:00,751 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:37:00,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:37:00,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:37:00,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:37:00,752 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:37:00,760 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:37:00,760 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:37:39,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:37:39,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:37:39,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:37:39,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:37:39,057 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:37:39,062 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:37:39,062 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:38:04,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:38:04,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:38:04,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:38:04,431 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:38:04,431 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:38:04,435 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:38:04,435 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:38:07,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:38:07,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:38:07,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:38:07,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:38:07,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:38:07,459 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:38:07,459 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:48,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:48,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:48,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:48,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:48,733 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:48,741 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:48,741 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,201 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,201 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:39:49,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,215 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,222 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,223 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,223 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,246 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,247 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,247 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:39:49,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,247 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,255 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,255 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,255 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,258 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,264 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,264 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,346 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,346 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,353 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,353 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,496 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,496 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,499 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,499 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:39:49,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:39:49,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:39:49,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:39:49,848 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:39:49,853 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:39:49,853 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:40:49,345 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:40:49,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:40:49,346 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:40:49,346 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:40:49,346 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:40:49,353 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:40:49,354 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:41:49,355 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:41:49,355 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:41:49,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:41:49,355 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:41:49,355 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:41:49,359 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:41:49,359 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:42:49,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:42:49,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:42:49,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:42:49,353 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:42:49,353 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:42:49,357 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:42:49,358 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:43:49,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:43:49,798 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:43:49,798 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:43:49,798 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:43:49,798 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:43:49,802 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:43:49,802 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:45:03,359 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:45:03,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:45:03,359 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:45:03,360 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:45:03,360 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:45:03,363 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:45:03,364 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:05,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:05,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:05,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:05,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:05,017 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:05,021 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:05,021 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,518 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,518 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:46:44,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,519 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,519 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:44,527 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:44,527 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,527 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,535 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,535 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:46:44,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:44,541 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:44,541 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,541 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,547 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,547 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:44,552 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:44,552 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:44,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,743 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:44,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:44,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:44,748 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:44,751 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:44,751 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:45,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:45,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:45,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:45,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:45,045 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:45,050 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:45,050 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:46:46,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:46:46,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:46:46,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:46,156 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:46:46,156 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:46:46,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:46:46,161 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:02,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:02,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:02,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:02,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:02,123 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:02,128 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:02,129 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:03,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:03,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:03,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:03,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:03,092 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:03,096 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:03,096 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:04,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:04,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:04,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:04,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:04,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:04,820 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:04,820 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:05,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:05,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:05,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:05,390 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:05,390 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:05,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:05,394 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:05,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:05,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:05,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:05,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:05,617 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:05,621 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:05,621 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:09,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:09,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:09,283 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:09,283 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:09,283 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:09,293 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:09,294 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:16,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:16,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:16,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,570 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,570 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:47:16,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:16,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:16,570 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,570 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,570 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:16,575 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:16,575 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:16,575 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:16,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:16,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:16,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,582 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,582 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:47:16,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:16,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:16,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:16,582 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:16,587 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:16,587 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:16,588 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:46,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:46,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:46,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:46,171 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:46,171 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:46,176 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:46,176 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:47:48,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:47:48,267 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:47:48,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:48,268 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:47:48,268 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:47:48,272 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:47:48,272 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,632 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,632 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:48:22,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,632 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,632 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:22,640 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:22,641 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,642 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,668 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,669 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,669 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 03:48:22,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,669 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,669 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,669 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:22,674 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:22,674 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,674 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,689 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,689 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:22,694 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:22,694 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:22,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:22,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:22,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:22,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:22,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:22,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:23,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:23,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:23,234 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:23,234 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:23,234 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:23,240 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:23,241 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:48:23,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:23,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:23,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:24,035 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:48:24,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:48:24,036 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:24,036 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:48:24,037 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:48:24,048 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:48:24,049 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:49:22,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:49:22,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:49:22,851 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:49:22,851 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:49:22,851 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:49:22,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:49:22,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:49:46,960 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:49:46,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:49:46,961 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:49:46,963 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:49:53,106 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:49:53,106 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:49:53,106 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:49:53,106 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 11, 19, 53, 106391), 'iat': datetime.datetime(2025, 6, 16, 10, 49, 53, 106395)}
2025-06-16 03:49:53,106 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzI3OTMsImlhdCI6MTc1MDA3MDk5M30.12FmSl0Pddpghja2DZCZ-kGqaj4z8zR4iDvIzXhr2_8

2025-06-16 03:49:53,106 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzU3OTMsImlhdCI6MTc1MDA3MDk5M30._-6WqrPnbfCY3x-IjE308zzVYMZNCs2TpWatT0ADiOk, Expiry (seconds): 604800
2025-06-16 03:49:53,109 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 03:50:05,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:50:05,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:50:05,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750072793, 'iat': 1750070993}
2025-06-16 03:50:05,224 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750072793, 'iat': 1750070993}
2025-06-16 03:50:05,224 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:50:05,228 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:50:05,229 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:50:23,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:50:23,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:50:23,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:50:23,101 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:50:23,101 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:50:23,104 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:50:23,104 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:50:42,458 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:50:42,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:50:42,459 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 03:50:42,459 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:51:05,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:51:05,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:51:05,196 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-16 03:51:05,200 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:51:23,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:51:23,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:51:23,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:51:23,020 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:51:23,020 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:51:23,024 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:51:23,024 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:51:39,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:51:39,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:51:39,824 - WARNING - app.core.security - JWTError in decode_token: JWTError - Signature verification failed.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.
2025-06-16 03:51:39,825 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 264, in _verify_signature
    raise JWSSignatureError()
jose.exceptions.JWSSignatureError

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 159, in decode
    payload = jws.verify(token, key, algorithms, verify=verify_signature)
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 77, in verify
    _verify_signature(signing_input, header, signature, key, algorithms)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jws.py", line 266, in _verify_signature
    raise JWSError("Signature verification failed.")
jose.exceptions.JWSError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 161, in decode
    raise JWTError(e)
jose.exceptions.JWTError: Signature verification failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 03:51:49,001 - INFO - app.core.security - Closing Redis connection...
2025-06-16 03:51:49,004 - INFO - app.core.security - Redis connection closed.
2025-06-16 03:51:54,804 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 03:51:54,804 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 03:51:54,841 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 03:51:54,841 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 03:51:54,841 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 03:51:54,841 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 11, 26, 54, 841664), 'iat': datetime.datetime(2025, 6, 16, 10, 51, 54, 841667)}
2025-06-16 03:51:54,842 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3MzIxNCwiaWF0IjoxNzUwMDcxMTE0fQ.NlAf2rrmZDrCdMIcaCNLjMxzVWWhkvN8D04lnXwF2YM

2025-06-16 03:52:07,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:52:07,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:52:07,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750073214, 'iat': 1750071114}
2025-06-16 03:52:07,698 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750073214, 'iat': 1750071114}
2025-06-16 03:52:07,698 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 03:52:07,698 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 03:52:07,710 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 03:53:58,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:53:58,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:53:58,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:53:58,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:53:58,463 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:53:58,470 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:53:58,471 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:56:47,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:56:47,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:56:47,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:57:27,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:57:27,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:57:27,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:57:27,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:57:27,026 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:57:27,037 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:57:27,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:58:40,000 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:58:40,001 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:58:40,001 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:58:40,001 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:58:40,001 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:58:40,007 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:58:40,007 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:58:43,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:58:43,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:58:43,393 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:58:43,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:58:43,394 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:58:43,402 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:58:43,402 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:58:45,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:58:45,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:58:45,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:59:34,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:59:34,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:59:34,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:59:34,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:59:34,863 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:59:34,874 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:59:34,874 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 03:59:43,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 03:59:43,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 03:59:43,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:59:43,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 03:59:43,887 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 03:59:43,892 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 03:59:43,892 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:00:34,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:00:34,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:00:34,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 04:00:34,987 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 04:00:34,987 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:00:34,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:00:34,995 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:00:44,367 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:00:44,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:00:44,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 04:00:44,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750071718, 'iat': 1750069918}
2025-06-16 04:00:44,368 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:00:44,373 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:00:44,373 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:02:26,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:02:26,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:02:26,304 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:02:26,309 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:03:36,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:03:36,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:03:36,062 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:03:36,064 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:03:57,852 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:03:57,853 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:13:00,360 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:13:00,360 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:13:00,434 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:13:00,434 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:13:00,434 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:13:00,434 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 11, 48, 0, 434257), 'iat': datetime.datetime(2025, 6, 16, 11, 13, 0, 434264)}
2025-06-16 04:13:00,435 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NDQ4MCwiaWF0IjoxNzUwMDcyMzgwfQ.JS7cXI5p2veXguWDol181mVzsqkIr1Ty_CHLZFqCs6A

2025-06-16 04:13:03,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:03,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:03,843 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:13:08,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:08,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:08,056 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:13:08,063 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:13:08,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:08,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:08,865 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:13:09,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:09,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:09,601 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:13:09,602 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 273, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:13:21,729 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:13:21,731 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:13:21,732 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:13:21,733 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 11, 43, 21, 729853), 'iat': datetime.datetime(2025, 6, 16, 11, 13, 21, 729877)}
2025-06-16 04:13:21,733 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzQyMDEsImlhdCI6MTc1MDA3MjQwMX0.SZCoELqx0Xjqutp3pEtrDcKztj2xTCO1d-4DLKGvpuw

2025-06-16 04:13:21,734 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzcyMDEsImlhdCI6MTc1MDA3MjQwMX0.KNkFrMfG6yC0RHei1Wjuar0Sz87pGtpBrCtnIJcIh5o, Expiry (seconds): 604800
2025-06-16 04:13:21,745 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 04:13:22,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:22,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:22,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,892 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,892 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:13:22,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:22,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:22,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,893 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:22,920 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:22,920 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:22,923 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:22,957 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:22,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:22,958 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,958 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,958 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:13:22,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:22,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:22,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,961 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:22,961 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:22,987 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:22,987 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:22,989 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:23,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:23,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:23,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:23,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:23,019 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:23,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:23,039 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:23,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:23,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:23,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:23,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:23,320 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:23,358 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:23,359 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:24,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:24,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:24,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:24,117 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:24,117 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:24,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:24,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:24,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:24,168 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:24,169 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:25,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:13:25,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:13:25,284 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:25,284 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:13:25,284 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:13:25,292 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:13:25,292 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:13:38,042 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:13:38,043 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:18:55,978 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:18:55,979 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:18:56,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:18:56,022 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:18:56,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:18:56,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 11, 53, 56, 22118), 'iat': datetime.datetime(2025, 6, 16, 11, 18, 56, 22122)}
2025-06-16 04:18:56,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NDgzNiwiaWF0IjoxNzUwMDcyNzM2fQ.tP20crTu9fW0rQd3eohVG6uy6XE-8khr4RNiB_NOYTI

2025-06-16 04:19:01,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,094 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,116 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,116 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,357 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,358 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,358 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,358 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,369 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,370 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,493 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,493 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,494 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,494 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,498 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,499 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,499 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,515 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,515 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:19:01,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,516 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,523 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,524 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,524 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,656 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,656 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,663 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,664 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:01,953 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,953 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,954 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,954 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,954 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:01,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:01,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:01,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:01,966 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:01,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:02,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:02,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:02,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:02,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:02,437 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:02,448 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:02,448 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:19:23,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:19:23,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:19:23,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:23,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:19:23,569 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:19:23,630 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:19:23,630 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:20:01,854 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:20:01,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:20:01,855 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:20:01,856 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:20:01,856 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:20:01,868 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:20:01,869 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:20:38,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:20:38,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:20:38,261 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:20:38,265 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:21:01,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:21:01,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:21:01,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:21:01,847 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:21:01,847 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:21:01,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:21:01,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:21:04,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:21:04,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:21:04,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750074836, 'iat': 1750072736}
2025-06-16 04:21:04,200 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750074836, 'iat': 1750072736}
2025-06-16 04:21:04,200 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 04:21:04,200 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 04:21:04,206 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 04:21:19,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:21:19,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:21:19,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:21:19,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:21:19,935 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:21:19,958 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:21:19,958 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:22:11,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:22:11,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:22:11,922 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:22:11,922 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:22:11,922 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:22:11,927 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:22:11,928 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:22:21,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:22:21,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:22:21,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:22:21,193 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:22:21,193 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:22:21,218 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:22:21,220 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:23:01,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:23:01,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:23:01,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:23:01,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:23:01,444 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:23:01,451 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:23:01,452 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:23:51,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:23:51,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:23:51,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:23:51,150 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:23:51,150 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:23:51,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:23:51,161 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:24:17,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:24:17,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:24:17,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:24:17,466 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:24:17,466 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:24:17,475 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:24:17,476 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:24:42,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:24:42,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:24:42,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:24:42,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:24:42,382 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:24:42,392 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:24:42,392 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:25:59,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:25:59,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:25:59,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:25:59,063 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:25:59,063 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:25:59,071 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:25:59,071 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:26:21,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:26:21,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:26:21,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:26:21,094 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:26:21,094 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:26:21,102 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:26:21,102 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:27:04,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:04,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:04,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:27:04,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750074201, 'iat': 1750072401}
2025-06-16 04:27:04,864 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:27:04,870 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:27:04,871 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:27:14,199 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:27:14,199 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:27:14,200 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:27:14,200 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 16, 11, 57, 14, 198977), 'iat': datetime.datetime(2025, 6, 16, 11, 27, 14, 199020)}
2025-06-16 04:27:14,200 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzUwMzQsImlhdCI6MTc1MDA3MzIzNH0.PkOcMgZkCd6mf5CtktiwD_HW3O8ZHc1OEqujSen2Wt4

2025-06-16 04:27:14,200 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTA2NzgwMzQsImlhdCI6MTc1MDA3MzIzNH0.zStYp636v0kcxRKGRdJfSocTBvZVePQra7HKikS1-bM, Expiry (seconds): 604800
2025-06-16 04:27:14,207 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-16 04:27:15,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,325 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,325 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:27:15,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,326 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,326 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:15,345 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:15,346 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,346 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,366 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,366 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:27:15,366 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,367 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,367 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,368 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:15,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,380 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:15,385 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:15,386 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,386 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,390 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:15,390 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,808 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:15,814 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:15,814 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:15,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,828 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:15,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:15,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:15,938 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:15,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:15,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:16,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:16,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:16,846 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:16,846 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:16,846 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:16,854 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:16,854 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:24,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:24,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:24,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:24,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:24,050 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:24,058 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:24,059 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:37,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:37,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:37,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:37,667 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:37,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:37,674 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:37,675 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:27:54,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:27:54,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:27:54,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:54,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:27:54,203 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:27:54,206 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:27:54,207 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:28:07,544 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:28:07,546 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:28:39,637 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:28:39,637 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:28:39,669 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:28:39,669 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:28:39,669 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:28:39,669 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 3, 39, 669860), 'iat': datetime.datetime(2025, 6, 16, 11, 28, 39, 669863)}
2025-06-16 04:28:39,670 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NTQxOSwiaWF0IjoxNzUwMDczMzE5fQ.8mxwI50mS2ajb8E0TrsAYG3eb-s2nm1CVizIB-NmzT8

2025-06-16 04:28:44,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:28:44,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:28:44,951 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:28:54,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:28:54,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:28:54,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:28:54,171 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1750075034, 'iat': 1750073234}
2025-06-16 04:28:54,171 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-16 04:28:54,217 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-16 04:28:54,218 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-16 04:28:54,218 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzUwMzQsImlhdCI6MTc1MDA3MzIzNH0.PkOcMgZkCd6mf5CtktiwD_HW3O8ZHc1OEqujSen2Wt4
2025-06-16 04:28:54,228 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTAwNzUwMzQsImlhdCI6MTc1MDA3MzIzNH0.PkOcMgZkCd6mf5CtktiwD_HW3O8ZHc1OEqujSen2Wt4
2025-06-16 04:29:03,344 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:29:03,345 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:29:03,345 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:29:03,345 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 11, 59, 3, 344701), 'iat': datetime.datetime(2025, 6, 16, 11, 29, 3, 344712)}
2025-06-16 04:29:03,345 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzUxNDMsImlhdCI6MTc1MDA3MzM0M30.j5DsKNLp8mNu1-kxE4XfyxN-5WIMGc4lRv1HSe4CQg4

2025-06-16 04:29:03,346 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2NzgxNDMsImlhdCI6MTc1MDA3MzM0M30.tNMGqcK-GZWOaA_KlbCy0YN2ssqYgxfeNJLASt27--Y, Expiry (seconds): 604800
2025-06-16 04:29:03,350 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 04:29:04,496 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,497 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,497 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,497 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:29:04,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,498 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:04,505 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:04,505 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:04,506 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:04,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,515 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,516 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,516 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:29:04,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,517 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:04,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,527 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,527 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:04,536 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:04,537 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:04,538 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:04,545 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:04,545 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:04,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:04,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:04,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,663 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:04,663 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:04,692 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:04,693 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:05,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:05,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:05,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:05,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:05,074 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:05,081 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:05,083 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:05,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:05,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:05,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:06,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:06,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:06,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:06,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:06,006 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:06,016 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:06,016 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:22,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:22,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:22,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:22,493 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:22,494 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:29:22,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:29:22,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:29:22,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:22,495 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:29:22,495 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:29:22,514 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:29:22,514 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:29:22,514 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:30:04,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:30:04,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:30:04,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:30:04,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:30:04,660 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:30:04,672 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:30:04,673 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:30:04,830 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:30:04,830 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:30:04,831 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:30:04,832 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:30:04,832 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:30:04,853 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:30:04,854 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:31:04,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:31:04,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:31:04,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:31:04,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:31:04,656 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:31:04,667 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:31:04,667 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:32:04,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:32:04,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:32:04,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:32:04,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:32:04,649 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:32:04,662 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:32:04,662 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:33:04,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:33:04,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:33:04,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:33:04,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:33:04,648 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:33:04,653 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:33:04,653 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:34:10,532 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:34:10,534 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:39:38,645 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:39:38,645 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:39:38,695 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:39:38,695 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:39:38,695 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:39:38,695 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 14, 38, 695165), 'iat': datetime.datetime(2025, 6, 16, 11, 39, 38, 695169)}
2025-06-16 04:39:38,695 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NjA3OCwiaWF0IjoxNzUwMDczOTc4fQ.U7dkuq7z8j9Lm498QCVWL2nvc1S3jYx4qPAvm8G83_g

2025-06-16 04:40:22,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:40:22,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:40:22,177 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,178 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,178 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:40:22,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:40:22,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:40:22,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,178 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,178 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:40:22,189 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:40:22,190 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:40:22,191 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:40:22,830 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:40:22,830 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:40:22,830 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,831 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075143, 'iat': 1750073343}
2025-06-16 04:40:22,831 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:40:22,845 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:40:22,845 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:56,719 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:42:56,719 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:42:56,719 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:42:56,720 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 12, 12, 56, 719417), 'iat': datetime.datetime(2025, 6, 16, 11, 42, 56, 719425)}
2025-06-16 04:42:56,720 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzU5NzYsImlhdCI6MTc1MDA3NDE3Nn0.sl7JXwTDLuxoJh7OS2ZMl0smbXYISCgINo7_Qdlrcb0

2025-06-16 04:42:56,721 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2Nzg5NzYsImlhdCI6MTc1MDA3NDE3Nn0.JCQlOUEkUPAT6MalXuJ7x30eVvKI9KVezYwCwFY0v0Q, Expiry (seconds): 604800
2025-06-16 04:42:56,725 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 04:42:57,997 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:57,997 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:57,997 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:57,998 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:57,998 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:42:57,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:57,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:57,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,000 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,000 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:42:58,009 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:42:58,010 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,010 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:58,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:58,022 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,023 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,023 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:42:58,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:58,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:58,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,023 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:42:58,041 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:42:58,042 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,042 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:58,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:58,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,045 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:42:58,060 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:42:58,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:58,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:58,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,452 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:58,452 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:42:58,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:42:58,457 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:42:58,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:58,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:58,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:59,426 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:42:59,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:42:59,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:59,427 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:42:59,427 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:42:59,439 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:42:59,439 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:43:00,367 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:43:00,367 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:43:00,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:43:00,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:43:00,368 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:43:00,373 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:43:00,373 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:43:31,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:43:31,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:43:31,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:43:31,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:43:31,949 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:43:31,958 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:43:31,959 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:44:00,875 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:44:00,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:44:00,876 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:44:00,876 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:44:00,877 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:44:00,885 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:44:00,885 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:44:32,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:44:32,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:44:32,216 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 04:44:32,219 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 04:44:58,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:44:58,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:44:58,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750076078, 'iat': 1750073978}
2025-06-16 04:44:58,287 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750076078, 'iat': 1750073978}
2025-06-16 04:44:58,287 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 04:44:58,287 - INFO - app.core.security - Service account targeting user ID: 4, Type: live
2025-06-16 04:44:58,291 - INFO - app.core.security - Service account 'barclays_service_provider' successfully identified target user ID: 4, Type: live
2025-06-16 04:45:04,907 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:45:04,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:45:04,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:45:04,907 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:45:04,907 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:45:04,910 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:45:04,910 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:45:40,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:45:40,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:45:40,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:45:40,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:45:40,424 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:45:40,433 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:45:40,433 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:46:00,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:46:00,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:46:00,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:46:00,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:46:00,377 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:46:00,380 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:46:00,380 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:47:00,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:47:00,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:47:00,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:47:00,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:47:00,596 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:47:00,599 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:47:00,599 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:47:25,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:47:25,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:47:25,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:47:25,236 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:47:25,236 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:47:25,240 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:47:25,240 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:48:11,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:48:11,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:48:11,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:11,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:11,554 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:48:11,564 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:48:11,565 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:48:17,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:48:17,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:48:17,264 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:17,264 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:17,264 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:48:17,270 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:48:17,271 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:48:44,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:48:44,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:48:44,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:44,130 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:48:44,130 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:48:44,148 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:48:44,148 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:13,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:13,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:13,961 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,961 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,961 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:49:13,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:13,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:13,962 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,962 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:13,969 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:13,969 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:13,969 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:13,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:13,991 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:13,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,992 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,992 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:49:13,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:13,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:13,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:13,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:14,002 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:14,002 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:14,003 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:14,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:14,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:14,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,014 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,014 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:14,020 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:14,020 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:14,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:14,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:14,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,148 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:14,163 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:14,163 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:14,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:14,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:14,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,521 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:14,521 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:14,530 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:14,530 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:14,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:14,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:14,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:15,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:15,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:15,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:15,302 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:15,302 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:15,309 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:15,310 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:21,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:49:21,850 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:49:21,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:21,851 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750075976, 'iat': 1750074176}
2025-06-16 04:49:21,851 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:49:21,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:49:21,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:49:58,065 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:49:58,067 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:52:11,387 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:52:11,388 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:52:11,552 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:52:11,553 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:52:11,553 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:52:11,553 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 27, 11, 552935), 'iat': datetime.datetime(2025, 6, 16, 11, 52, 11, 552942)}
2025-06-16 04:52:11,553 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NjgzMSwiaWF0IjoxNzUwMDc0NzMxfQ.GhQHyjy46eEqm39KDQFntQjmVvhKW1VceYKvPQkPHqg

2025-06-16 04:52:14,075 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:52:14,075 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:52:14,075 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:52:14,075 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 12, 22, 14, 75342), 'iat': datetime.datetime(2025, 6, 16, 11, 52, 14, 75346)}
2025-06-16 04:52:14,075 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzY1MzQsImlhdCI6MTc1MDA3NDczNH0.Z_q4ADcQrT9W4OGpCOkV09fRZHQ7W-T6dTJuGT9qHio

2025-06-16 04:52:14,075 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2Nzk1MzQsImlhdCI6MTc1MDA3NDczNH0.73pos8o2BP_xgAD6mL0wchgJxqgt0IsgKmFdCAlhehc, Expiry (seconds): 604800
2025-06-16 04:52:14,079 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 04:52:15,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,214 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,214 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:52:15,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,215 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:15,243 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:15,243 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,244 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,260 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,260 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,261 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:52:15,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,261 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,262 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:15,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,276 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:15,287 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:15,287 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,287 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,291 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:15,291 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,466 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,467 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:15,482 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:15,482 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:15,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:15,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:15,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,998 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:15,999 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:16,008 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:16,008 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:16,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:16,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:16,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:17,089 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:17,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:17,089 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:17,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:17,089 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:17,107 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:17,107 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:52:30,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:52:30,996 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:52:30,996 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:30,997 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:52:30,997 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:52:31,023 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:52:31,024 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:53:13,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:53:13,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:53:13,440 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:53:13,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:53:13,441 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:53:13,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:53:13,458 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:53:15,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:53:15,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:53:15,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:53:15,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:53:15,422 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:53:15,429 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:53:15,429 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:53:32,736 - INFO - app.core.security - Closing Redis connection...
2025-06-16 04:53:32,738 - INFO - app.core.security - Redis connection closed.
2025-06-16 04:57:15,223 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 04:57:15,224 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 04:57:15,247 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:57:15,247 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:57:15,247 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:57:15,247 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 32, 15, 247659), 'iat': datetime.datetime(2025, 6, 16, 11, 57, 15, 247664)}
2025-06-16 04:57:15,248 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3NzEzNSwiaWF0IjoxNzUwMDc1MDM1fQ.p7YX0iafQ_HtvqnPQYehkN-jUbcHwLYSLluQ3k_B4Xo

2025-06-16 04:57:30,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:30,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:30,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:57:30,998 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:57:30,998 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:31,002 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:31,003 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:32,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:32,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:32,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076534, 'iat': 1750074734}
2025-06-16 04:57:44,925 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 04:57:44,925 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 04:57:44,926 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 04:57:44,926 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 16, 12, 27, 44, 925402), 'iat': datetime.datetime(2025, 6, 16, 11, 57, 44, 925414)}
2025-06-16 04:57:44,926 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTAwNzY4NjQsImlhdCI6MTc1MDA3NTA2NH0.2UR3OtLT2lwne6K-zBHxE6glSc6nOPA7bm8Vt5c7OEc

2025-06-16 04:57:44,927 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTA2Nzk4NjQsImlhdCI6MTc1MDA3NTA2NH0.Jwge9awZiV8_GxTUY_MLp7R9Fm8QaAOAn4XUoY5SUHA, Expiry (seconds): 604800
2025-06-16 04:57:44,932 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-16 04:57:46,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,084 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,084 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:57:46,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,085 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:46,099 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:46,101 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,102 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,121 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,121 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,122 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-16 04:57:46,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,124 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,124 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:46,141 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:46,143 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,144 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,151 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,151 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:46,165 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:46,166 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,606 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:46,607 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:46,614 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:46,615 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:46,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:46,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:46,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:47,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:47,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:47,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:47,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:47,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:47,805 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:47,805 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:48,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:48,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:48,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:48,622 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:48,622 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:48,629 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:48,629 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:57:59,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:57:59,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:57:59,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:59,355 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:57:59,356 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:57:59,375 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:57:59,375 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:58:01,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:58:01,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:58:01,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077135, 'iat': 1750075035}
2025-06-16 04:58:01,820 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077135, 'iat': 1750075035}
2025-06-16 04:58:01,820 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 04:58:01,820 - WARNING - app.core.security - Service account request missing or invalid target user_id/user_type. user_id: None, target_user_type: None
2025-06-16 04:58:48,671 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:58:48,671 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:58:48,672 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:58:48,672 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:58:48,672 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:58:48,682 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:58:48,682 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 04:59:50,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 04:59:50,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 04:59:50,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:59:50,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 04:59:50,600 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 04:59:50,605 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 04:59:50,605 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:00:14,695 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:00:14,695 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:09:24,310 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:09:24,310 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:09:24,402 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:09:24,402 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:09:24,402 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:09:24,402 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 44, 24, 402838), 'iat': datetime.datetime(2025, 6, 16, 12, 9, 24, 402842)}
2025-06-16 05:09:24,413 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3Nzg2NCwiaWF0IjoxNzUwMDc1NzY0fQ.tjkm3uegezhAlnjarIrTWFp9CY6tYvyWatRroewO_pg

2025-06-16 05:09:38,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:09:38,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:09:38,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:09:38,334 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:09:38,334 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:09:38,336 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:09:38,337 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:09:38,337 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:09:38,352 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:09:38,353 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:09:41,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:09:41,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:09:41,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:09:41,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:09:41,291 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:09:41,298 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:09:41,298 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:10:02,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:10:02,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:10:02,626 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-16 05:10:02,629 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 97, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 358, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 102, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-16 05:10:27,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:10:27,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:10:27,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077864, 'iat': 1750075764}
2025-06-16 05:10:27,189 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077864, 'iat': 1750075764}
2025-06-16 05:10:27,189 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 05:10:27,189 - WARNING - app.core.security - Service account request missing or invalid target user_id/user_type. user_id: None, target_user_type: None
2025-06-16 05:10:29,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:10:29,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:10:29,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077864, 'iat': 1750075764}
2025-06-16 05:10:29,050 - INFO - app.core.security - Token payload: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': 1750077864, 'iat': 1750075764}
2025-06-16 05:10:29,050 - INFO - app.core.security - Service account token detected for service: barclays_service_provider
2025-06-16 05:10:29,051 - WARNING - app.core.security - Service account request missing or invalid target user_id/user_type. user_id: None, target_user_type: None
2025-06-16 05:10:34,840 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:10:34,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:10:34,841 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:10:34,841 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:10:34,842 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:10:34,848 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:10:34,848 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:10:42,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:10:42,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:10:42,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:10:42,015 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:10:42,015 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:10:42,020 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:10:42,020 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:10:46,353 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:10:46,353 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:13:10,273 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:13:10,274 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:13:10,312 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:13:10,312 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:13:10,312 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:13:10,312 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 48, 10, 312218), 'iat': datetime.datetime(2025, 6, 16, 12, 13, 10, 312227)}
2025-06-16 05:13:10,312 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3ODA5MCwiaWF0IjoxNzUwMDc1OTkwfQ.2xEq74-nu4E0XMCWKipe_V-BN-diSBgLxLqdG2j24BM

2025-06-16 05:13:15,981 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:13:15,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:13:15,982 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:13:15,982 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:13:15,982 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:13:15,993 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:13:15,993 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:13:39,987 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-16 05:13:39,987 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... ALGORITHM: HS256
2025-06-16 05:13:39,988 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:13:39,988 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1750076864, 'iat': 1750075064}
2025-06-16 05:13:39,988 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-16 05:13:39,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-16 05:13:39,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-16 05:14:04,779 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:14:04,780 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:14:20,336 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:14:20,336 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:14:20,382 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:14:20,382 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:14:20,382 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:14:20,382 - DEBUG - app.core.security - Payload to encode: {'sub': 'service', 'service_name': 'barclays_service_provider', 'exp': datetime.datetime(2025, 6, 16, 12, 49, 20, 382007), 'iat': datetime.datetime(2025, 6, 16, 12, 14, 20, 382009)}
2025-06-16 05:14:20,382 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJzZXJ2aWNlIiwic2VydmljZV9uYW1lIjoiYmFyY2xheXNfc2VydmljZV9wcm92aWRlciIsImV4cCI6MTc1MDA3ODE2MCwiaWF0IjoxNzUwMDc2MDYwfQ.08pZIBg5k1P6tySw6slivCYFNE66cdsRzk6U015VZJY

2025-06-16 05:16:02,705 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:16:02,706 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:16:49,526 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:16:49,526 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:16:49,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:16:49,561 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:16:49,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:16:49,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 12, 51, 49, 561032), 'iat': datetime.datetime(2025, 6, 16, 12, 16, 49, 561035)}
2025-06-16 05:16:49,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzgzMDksImlhdCI6MTc1MDA3NjIwOX0.9VEahR93aWJnwIXV-di2gjYei-k1f05ecxbLv-jbIac

2025-06-16 05:17:10,083 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:17:10,084 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:20:22,567 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:20:22,567 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:20:22,593 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:20:22,593 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:20:22,593 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:20:22,593 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 12, 55, 22, 593286), 'iat': datetime.datetime(2025, 6, 16, 12, 20, 22, 593288)}
2025-06-16 05:20:22,593 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzg1MjIsImlhdCI6MTc1MDA3NjQyMn0.DjyRv_GrX7e_AgSEOdTHsmpFZBn4C816QK6q3s0QPfs

2025-06-16 05:21:11,973 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:21:11,974 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:23:58,915 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:23:58,915 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:23:58,940 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:23:58,940 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:23:58,940 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:23:58,940 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 12, 58, 58, 940269), 'iat': datetime.datetime(2025, 6, 16, 12, 23, 58, 940272)}
2025-06-16 05:23:58,940 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzg3MzgsImlhdCI6MTc1MDA3NjYzOH0.1ILXtPpt2HzE0FDN2x27fo4femWg4g8boW_SeX6XVgk

2025-06-16 05:25:51,328 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:25:51,329 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:34:49,664 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:34:49,664 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:34:49,702 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:34:49,702 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:34:49,703 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:34:49,703 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 13, 9, 49, 702927), 'iat': datetime.datetime(2025, 6, 16, 12, 34, 49, 702930)}
2025-06-16 05:34:49,703 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzkzODksImlhdCI6MTc1MDA3NzI4OX0.MiGU8ea1JM9FwGn6wAEOcdMPPOjEc7q8dQ3yp2PhrmI

2025-06-16 05:37:51,352 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:37:51,353 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:38:25,164 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:38:25,164 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:38:25,208 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:38:25,208 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:38:25,208 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:38:25,208 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 13, 13, 25, 208413), 'iat': datetime.datetime(2025, 6, 16, 12, 38, 25, 208418)}
2025-06-16 05:38:25,209 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzk2MDUsImlhdCI6MTc1MDA3NzUwNX0.UNj3OmH2_2RUUqMt2TVMHtK9vFwa5egyMVw0ciZlGTg

2025-06-16 05:40:07,314 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:40:07,315 - INFO - app.core.security - Redis connection closed.
2025-06-16 05:40:58,054 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-16 05:40:58,054 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
2025-06-16 05:40:58,101 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-16 05:40:58,101 - DEBUG - app.core.security - SECRET_KEY used for encoding: 'C8mDq9pX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY_wC2vB4uN6tE8rD0fC2aV4bN6mK8jL9iP_qW1eX3rZ_nT5yF7vU-sW1eQ0aJ2gI_lK4hO6iP8jQ9kR7lS5mV3nZ1xY'
2025-06-16 05:40:58,101 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-16 05:40:58,101 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 16, 13, 15, 58, 101390), 'iat': datetime.datetime(2025, 6, 16, 12, 40, 58, 101395)}
2025-06-16 05:40:58,102 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJiYXJjbGF5c19zZXJ2aWNlX3Byb3ZpZGVyIiwiaXNfc2VydmljZV9hY2NvdW50Ijp0cnVlLCJleHAiOjE3NTAwNzk3NTgsImlhdCI6MTc1MDA3NzY1OH0.oInyiZGBVee5MJh42FIrUdtzKc5ABL7riNfVe557L8I

2025-06-16 05:43:07,339 - INFO - app.core.security - Closing Redis connection...
2025-06-16 05:43:07,339 - INFO - app.core.security - Redis connection closed.
